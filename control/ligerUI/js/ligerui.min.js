(function($){Function.prototype.ligerExtend=function(parent,overrides){if(typeof parent!="function"){return this}this.base=parent.prototype;this.base.constructor=parent;var f=function(){};f.prototype=parent.prototype;this.prototype=new f();this.prototype.constructor=this;if(overrides){$.extend(this.prototype,overrides)}};Function.prototype.ligerDefer=function(o,defer,args){var fn=this;return setTimeout(function(){fn.apply(o,args||[])},defer)};window.liger=$.ligerui={version:"V1.1.9",managerCount:0,managers:{},managerIdPrev:"ligerui",error:{managerIsExist:"管理器id已经存在"},getId:function(prev){prev=prev||this.managerIdPrev;var id=prev+(1000+this.managerCount);this.managerCount++;return id},add:function(manager){if(arguments.length==2){var m=arguments[1];m.id=m.id||m.options.id||arguments[0].id;this.addManager(m);return}if(!manager.id){manager.id=this.getId(manager.__idPrev())}if(this.managers[manager.id]){throw new Error(this.error.managerIsExist)}this.managers[manager.id]=manager},remove:function(arg){if(typeof arg=="string"||typeof arg=="number"){delete $.ligerui.managers[arg]}else{if(typeof arg=="object"&&arg instanceof $.ligerui.core.Component){delete $.ligerui.managers[arg.id]}}},get:function(arg,idAttrName){idAttrName=idAttrName||"ligeruiid";if(typeof arg=="string"||typeof arg=="number"){return $.ligerui.managers[arg]}else{if(typeof arg=="object"&&arg.length){if(!arg[0][idAttrName]&&!$(arg[0]).attr(idAttrName)){return null}return $.ligerui.managers[arg[0][idAttrName]||$(arg[0]).attr(idAttrName)]}}return null},find:function(type){var arr=[];for(var id in this.managers){var manager=this.managers[id];if(type instanceof Function){if(manager instanceof type){arr.push(manager)}}else{if(type instanceof Array){if($.inArray(manager.__getType(),type)!=-1){arr.push(manager)}}else{if(manager.__getType()==type){arr.push(manager)}}}}return arr},run:function(plugin,args,ext){if(!plugin){return}ext=$.extend({defaultsNamespace:"ligerDefaults",methodsNamespace:"ligerMethods",controlNamespace:"controls",idAttrName:"ligeruiid",isStatic:false,hasElement:true,propertyToElemnt:null},ext||{});plugin=plugin.replace(/^ligerGet/,"");plugin=plugin.replace(/^liger/,"");if(this==null||this==window||ext.isStatic){if(!$.ligerui.plugins[plugin]){$.ligerui.plugins[plugin]={fn:$["liger"+plugin],isStatic:true}}return new $.ligerui[ext.controlNamespace][plugin]($.extend({},$[ext.defaultsNamespace][plugin]||{},$[ext.defaultsNamespace][plugin+"String"]||{},args.length>0?args[0]:{}))}if(!$.ligerui.plugins[plugin]){$.ligerui.plugins[plugin]={fn:$.fn["liger"+plugin],isStatic:false}}if(/Manager$/.test(plugin)){return $.ligerui.get(this,ext.idAttrName)}this.each(function(){if(this[ext.idAttrName]||$(this).attr(ext.idAttrName)){var manager=$.ligerui.get(this[ext.idAttrName]||$(this).attr(ext.idAttrName));if(manager&&args.length>0){manager.set(args[0])}return}if(args.length>=1&&typeof args[0]=="string"){return}var options=args.length>0?args[0]:null;var p=$.extend({},$[ext.defaultsNamespace][plugin]||{},$[ext.defaultsNamespace][plugin+"String"]||{},options||{});if(ext.propertyToElemnt){p[ext.propertyToElemnt]=this}if(ext.hasElement){new $.ligerui[ext.controlNamespace][plugin](this,p)}else{new $.ligerui[ext.controlNamespace][plugin](p)}});if(this.length==0){return null}if(args.length==0){return $.ligerui.get(this,ext.idAttrName)}if(typeof args[0]=="object"){return $.ligerui.get(this,ext.idAttrName)}if(typeof args[0]=="string"){var manager=$.ligerui.get(this,ext.idAttrName);if(manager==null){return}if(args[0]=="option"){if(args.length==2){return manager.get(args[1])}else{if(args.length>=3){return manager.set(args[1],args[2])}}}else{var method=args[0];if(!manager[method]){return}var parms=Array.apply(null,args);parms.shift();return manager[method].apply(manager,parms)}}return null},defaults:{},methods:{},core:{},controls:{},plugins:{}};$.ligerDefaults={};$.ligerMethos={};$.ligerui.defaults=$.ligerDefaults;$.ligerui.methods=$.ligerMethos;$.fn.liger=function(plugin){if(plugin){return $.ligerui.run.call(this,plugin,arguments)}else{return $.ligerui.get(this)}};$.ligerui.core.Component=function(options){this.events=this.events||{};this.options=options||{};this.children={}};$.extend($.ligerui.core.Component.prototype,{__getType:function(){return"$.ligerui.core.Component"},__idPrev:function(){return"ligerui"},set:function(arg,value){if(!arg){return}if(typeof arg=="object"){var tmp;if(this.options!=arg){$.extend(this.options,arg);tmp=arg}else{tmp=$.extend({},arg)}if(value==undefined||value==true){for(var p in tmp){if(p.indexOf("on")==0){this.set(p,tmp[p])}}}if(value==undefined||value==false){for(var p in tmp){if(p.indexOf("on")!=0){this.set(p,tmp[p])}}}return}var name=arg;if(name.indexOf("on")==0){if(typeof value=="function"){this.bind(name.substr(2),value)}return}this.trigger("propertychange",arg,value);if(!this.options){this.options={}}this.options[name]=value;var pn="_set"+name.substr(0,1).toUpperCase()+name.substr(1);if(this[pn]){this[pn].call(this,value)}this.trigger("propertychanged",arg,value)},get:function(name){var pn="_get"+name.substr(0,1).toUpperCase()+name.substr(1);if(this[pn]){return this[pn].call(this,name)}return this.options[name]},hasBind:function(arg){var name=arg.toLowerCase();var event=this.events[name];if(event&&event.length){return true}return false},trigger:function(arg,data){var name=arg.toLowerCase();var event=this.events[name];if(!event){return}data=data||[];if((data instanceof Array)==false){data=[data]}for(var i=0;i<event.length;i++){var ev=event[i];if(ev.handler.apply(ev.context,data)==false){return false}}},bind:function(arg,handler,context){if(typeof arg=="object"){for(var p in arg){this.bind(p,arg[p])}return}if(typeof handler!="function"){return false}var name=arg.toLowerCase();var event=this.events[name]||[];context=context||this;event.push({handler:handler,context:context});this.events[name]=event},unbind:function(arg,handler){if(!arg){this.events={};return}var name=arg.toLowerCase();var event=this.events[name];if(!event||!event.length){return}if(!handler){delete this.events[name]}else{for(var i=0,l=event.length;i<l;i++){if(event[i].handler==handler){event.splice(i,1);break}}}},destroy:function(){$.ligerui.remove(this)}});$.ligerui.core.UIComponent=function(element,options){$.ligerui.core.UIComponent.base.constructor.call(this,options);var extendMethods=this._extendMethods();if(extendMethods){$.extend(this,extendMethods)}this.element=element;this._init();this._preRender();this.trigger("render");this._render();this.trigger("rendered");this._rendered()};$.ligerui.core.UIComponent.ligerExtend($.ligerui.core.Component,{__getType:function(){return"$.ligerui.core.UIComponent"},_extendMethods:function(){},_init:function(){this.type=this.__getType();if(!this.element){this.id=this.options.id||$.ligerui.getId(this.__idPrev())}else{this.id=this.options.id||this.element.id||$.ligerui.getId(this.__idPrev())}$.ligerui.add(this);if(!this.element){return}var attributes=this.attr();if(attributes&&attributes instanceof Array){for(var i=0;i<attributes.length;i++){var name=attributes[i];this.options[name]=$(this.element).attr(name)}}var p=this.options;if($(this.element).attr("ligerui")){try{var attroptions=$(this.element).attr("ligerui");if(attroptions.indexOf("{")!=0){attroptions="{"+attroptions+"}"}eval("attroptions = "+attroptions+";");if(attroptions){$.extend(p,attroptions)}}catch(e){}}},_preRender:function(){},_render:function(){},_rendered:function(){if(this.element){$(this.element).attr("ligeruiid",this.id)}},attr:function(){return[]},destroy:function(){if(this.element){$(this.element).remove()}this.options=null;$.ligerui.remove(this)}});$.ligerui.controls.Input=function(element,options){$.ligerui.controls.Input.base.constructor.call(this,element,options)};$.ligerui.controls.Input.ligerExtend($.ligerui.core.UIComponent,{__getType:function(){return"$.ligerui.controls.Input"},attr:function(){return["nullText"]},setValue:function(value){return this.set("value",value)},getValue:function(){return this.get("value")},setEnabled:function(){return this.set("disabled",false)},setDisabled:function(){return this.set("disabled",true)},updateStyle:function(){}});$.ligerui.win={top:false,mask:function(win){function setHeight(){if(!$.ligerui.win.windowMask){return}var h=$(window).height()+$(window).scrollTop();$.ligerui.win.windowMask.height(h)}if(!this.windowMask){this.windowMask=$("<div class='l-window-mask' style='display: block;'></div>").appendTo("body");$(window).bind("resize.ligeruiwin",setHeight);$(window).bind("scroll",setHeight)}this.windowMask.show();setHeight();this.masking=true},unmask:function(win){var jwins=$("body > .l-dialog:visible,body > .l-window:visible");for(var i=0,l=jwins.length;i<l;i++){var winid=jwins.eq(i).attr("ligeruiid");if(win&&win.id==winid){continue}var winmanager=$.ligerui.get(winid);if(!winmanager){continue}var modal=winmanager.get("modal");if(modal){return}}if(this.windowMask){this.windowMask.hide()}this.masking=false},createTaskbar:function(){if(!this.taskbar){this.taskbar=$('<div class="l-taskbar"><div class="l-taskbar-tasks"></div><div class="l-clear"></div></div>').appendTo("body");if(this.top){this.taskbar.addClass("l-taskbar-top")}this.taskbar.tasks=$(".l-taskbar-tasks:first",this.taskbar);this.tasks={}}this.taskbar.show();this.taskbar.animate({bottom:0});return this.taskbar},removeTaskbar:function(){var self=this;self.taskbar.animate({bottom:-32},function(){self.taskbar.remove();self.taskbar=null})},activeTask:function(win){for(var winid in this.tasks){var t=this.tasks[winid];if(winid==win.id){t.addClass("l-taskbar-task-active")}else{t.removeClass("l-taskbar-task-active")}}},getTask:function(win){var self=this;if(!self.taskbar){return}if(self.tasks[win.id]){return self.tasks[win.id]}return null},addTask:function(win){var self=this;if(!self.taskbar){self.createTaskbar()}if(self.tasks[win.id]){return self.tasks[win.id]}var title=win.get("title");var task=self.tasks[win.id]=$('<div class="l-taskbar-task"><div class="l-taskbar-task-icon"></div><div class="l-taskbar-task-content">'+title+"</div></div>");self.taskbar.tasks.append(task);self.activeTask(win);task.bind("click",function(){self.activeTask(win);if(win.actived){win.min()}else{win.active()}}).hover(function(){$(this).addClass("l-taskbar-task-over")},function(){$(this).removeClass("l-taskbar-task-over")});return task},hasTask:function(){for(var p in this.tasks){if(this.tasks[p]){return true}}return false},removeTask:function(win){var self=this;if(!self.taskbar){return}if(self.tasks[win.id]){self.tasks[win.id].unbind();self.tasks[win.id].remove();delete self.tasks[win.id]}if(!self.hasTask()){self.removeTaskbar()}delete $.ligerui.managers[win.id]},setFront:function(win){var wins=$.ligerui.find($.ligerui.core.Win);for(var i in wins){var w=wins[i];if(w==win){$(w.element).css("z-index","9200");this.activeTask(w)}else{$(w.element).css("z-index","9100")}}}};$.ligerui.core.Win=function(element,options){$.ligerui.core.Win.base.constructor.call(this,element,options)};$.ligerui.core.Win.ligerExtend($.ligerui.core.UIComponent,{__getType:function(){return"$.ligerui.controls.Win"},mask:function(){if(this.options.modal){$.ligerui.win.mask(this)}},unmask:function(){if(this.options.modal){$.ligerui.win.unmask(this)}},min:function(){},max:function(){},active:function(){}});$.ligerui.draggable={dragging:false};$.ligerui.resizable={reszing:false};$.ligerui.toJSON=typeof JSON==="object"&&JSON.stringify?JSON.stringify:function(o){var f=function(n){return n<10?"0"+n:n},escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,quote=function(value){escapable.lastIndex=0;return escapable.test(value)?'"'+value.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+value+'"'};if(o===null){return"null"}var type=typeof o;if(type==="undefined"){return undefined}if(type==="string"){return quote(o)}if(type==="number"||type==="boolean"){return""+o}if(type==="object"){if(typeof o.toJSON==="function"){return $.ligerui.toJSON(o.toJSON())}if(o.constructor===Date){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null}var pairs=[];if(o.constructor===Array){for(var i=0,l=o.length;i<l;i++){pairs.push($.ligerui.toJSON(o[i])||"null")}return"["+pairs.join(",")+"]"}var name,val;for(var k in o){type=typeof k;if(type==="number"){name='"'+k+'"'}else{if(type==="string"){name=quote(k)}else{continue}}type=typeof o[k];if(type==="function"||type==="undefined"){continue}val=$.ligerui.toJSON(o[k]);pairs.push(name+":"+val)}return"{"+pairs.join(",")+"}"}}})(jQuery);(function(A){A.fn.ligerAccordion=function(B){return A.ligerui.run.call(this,"ligerAccordion",arguments)};A.fn.ligerGetAccordionManager=function(){return A.ligerui.get(this)};A.ligerDefaults.Accordion={height:null,speed:"normal",changeHeightOnResize:false,heightDiff:0};A.ligerMethos.Accordion={};A.ligerui.controls.Accordion=function(C,B){A.ligerui.controls.Accordion.base.constructor.call(this,C,B)};A.ligerui.controls.Accordion.ligerExtend(A.ligerui.core.UIComponent,{__getType:function(){return"Accordion"},__idPrev:function(){return"Accordion"},_extendMethods:function(){return A.ligerMethos.Accordion},_render:function(){var B=this,C=this.options;B.accordion=A(B.element);if(!B.accordion.hasClass("l-accordion-panel")){B.accordion.addClass("l-accordion-panel")}var D=0;if(A("> div[lselected=true]",B.accordion).length>0){D=A("> div",B.accordion).index(A("> div[lselected=true]",B.accordion))}A("> div",B.accordion).each(function(E,F){var G=A('<div class="l-accordion-header"><div class="l-accordion-toggle"></div><div class="l-accordion-header-inner"></div></div>');if(E==D){A(".l-accordion-toggle",G).addClass("l-accordion-toggle-open")}if(A(F).attr("title")){A(".l-accordion-header-inner",G).html(A(F).attr("title"));A(F).attr("title","")}A(F).before(G);if(!A(F).hasClass("l-accordion-content")){A(F).addClass("l-accordion-content")}});A(".l-accordion-toggle",B.accordion).each(function(){if(!A(this).hasClass("l-accordion-toggle-open")&&!A(this).hasClass("l-accordion-toggle-close")){A(this).addClass("l-accordion-toggle-close")}if(A(this).hasClass("l-accordion-toggle-close")){A(this).parent().next(".l-accordion-content:visible").hide()}});A(".l-accordion-header",B.accordion).hover(function(){A(this).addClass("l-accordion-header-over")},function(){A(this).removeClass("l-accordion-header-over")});A(".l-accordion-toggle",B.accordion).hover(function(){if(A(this).hasClass("l-accordion-toggle-open")){A(this).addClass("l-accordion-toggle-open-over")}else{if(A(this).hasClass("l-accordion-toggle-close")){A(this).addClass("l-accordion-toggle-close-over")}}},function(){if(A(this).hasClass("l-accordion-toggle-open")){A(this).removeClass("l-accordion-toggle-open-over")}else{if(A(this).hasClass("l-accordion-toggle-close")){A(this).removeClass("l-accordion-toggle-close-over")}}});A(">.l-accordion-header",B.accordion).click(function(){var E=A(".l-accordion-toggle:first",this);if(E.hasClass("l-accordion-toggle-close")){E.removeClass("l-accordion-toggle-close").removeClass("l-accordion-toggle-close-over l-accordion-toggle-open-over");E.addClass("l-accordion-toggle-open");A(this).next(".l-accordion-content").show(C.speed).siblings(".l-accordion-content:visible").hide(C.speed);A(this).siblings(".l-accordion-header").find(".l-accordion-toggle").removeClass("l-accordion-toggle-open").addClass("l-accordion-toggle-close")}else{E.removeClass("l-accordion-toggle-open").removeClass("l-accordion-toggle-close-over l-accordion-toggle-open-over").addClass("l-accordion-toggle-close");A(this).next(".l-accordion-content").hide(C.speed)}});B.headerHoldHeight=0;A("> .l-accordion-header",B.accordion).each(function(){B.headerHoldHeight+=A(this).height()});if(C.height&&typeof(C.height)=="string"&&C.height.indexOf("%")>0){B.onResize();if(C.changeHeightOnResize){A(window).resize(function(){B.onResize()})}}else{if(C.height){B.height=C.heightDiff+C.height;B.accordion.height(B.height);B.setHeight(C.height)}else{B.header=B.accordion.height()}}B.set(C)},onResize:function(){var B=this,C=this.options;if(!C.height||typeof(C.height)!="string"||C.height.indexOf("%")==-1){return false}if(B.accordion.parent()[0].tagName.toLowerCase()=="body"){var D=A(window).height();D-=parseInt(B.layout.parent().css("paddingTop"));D-=parseInt(B.layout.parent().css("paddingBottom"));B.height=C.heightDiff+D*parseFloat(B.height)*0.01}else{B.height=C.heightDiff+(B.accordion.parent().height()*parseFloat(C.height)*0.01)}B.accordion.height(B.height);B.setContentHeight(B.height-B.headerHoldHeight)},setHeight:function(C){var B=this,D=this.options;B.accordion.height(C);C-=B.headerHoldHeight;A("> .l-accordion-content",B.accordion).height(C)}})})(jQuery);(function(A){A.fn.ligerButton=function(B){return A.ligerui.run.call(this,"ligerButton",arguments)};A.fn.ligerGetButtonManager=function(){return A.ligerui.run.call(this,"ligerGetButtonManager",arguments)};A.ligerDefaults.Button={width:100,text:"Button",disabled:false};A.ligerMethos.Button={};A.ligerui.controls.Button=function(C,B){A.ligerui.controls.Button.base.constructor.call(this,C,B)};A.ligerui.controls.Button.ligerExtend(A.ligerui.controls.Input,{__getType:function(){return"Button"},__idPrev:function(){return"Button"},_extendMethods:function(){return A.ligerMethos.Button},_render:function(){var B=this,C=this.options;B.button=A(B.element);B.button.addClass("l-btn");B.button.append('<div class="l-btn-l"></div><div class="l-btn-r"></div><span></span>');C.click&&B.button.click(function(){if(!C.disabled){C.click()}});B.set(C)},_setEnabled:function(B){if(B){this.button.removeClass("l-btn-disabled")}},_setDisabled:function(B){if(B){this.button.addClass("l-btn-disabled");this.options.disabled=true}},_setWidth:function(B){this.button.width(B)},_setText:function(B){A("span",this.button).html(B)},setValue:function(B){this.set("text",B)},getValue:function(){return this.options.text},setEnabled:function(){this.set("disabled",false)},setDisabled:function(){this.set("disabled",true)}})})(jQuery);(function(A){A.fn.ligerCheckBox=function(B){return A.ligerui.run.call(this,"ligerCheckBox",arguments)};A.fn.ligerGetCheckBoxManager=function(){return A.ligerui.run.call(this,"ligerGetCheckBoxManager",arguments)};A.ligerDefaults.CheckBox={disabled:false};A.ligerMethos.CheckBox={};A.ligerui.controls.CheckBox=function(C,B){A.ligerui.controls.CheckBox.base.constructor.call(this,C,B)};A.ligerui.controls.CheckBox.ligerExtend(A.ligerui.controls.Input,{__getType:function(){return"CheckBox"},__idPrev:function(){return"CheckBox"},_extendMethods:function(){return A.ligerMethos.CheckBox},_render:function(){var B=this,C=this.options;B.input=A(B.element);B.link=A('<a class="l-checkbox"></a>');B.wrapper=B.input.addClass("l-hidden").wrap('<div class="l-checkbox-wrapper"></div>').parent();B.wrapper.prepend(B.link);B.link.click(function(){if(B.input.attr("disabled")){return false}if(C.disabled){return false}if(B.trigger("beforeClick",[B.element])==false){return false}if(A(this).hasClass("l-checkbox-checked")){B._setValue(false)}else{B._setValue(true)}B.input.trigger("change")});B.wrapper.hover(function(){if(!C.disabled){A(this).addClass("l-over")}},function(){A(this).removeClass("l-over")});this.set(C);this.updateStyle()},_setCss:function(B){this.wrapper.css(B)},_setValue:function(D){var B=this,C=this.options;if(!D){B.input[0].checked=false;B.link.removeClass("l-checkbox-checked")}else{B.input[0].checked=true;B.link.addClass("l-checkbox-checked")}},_setDisabled:function(B){if(B){this.input.attr("disabled",true);this.wrapper.addClass("l-disabled")}else{this.input.attr("disabled",false);this.wrapper.removeClass("l-disabled")}},_getValue:function(){return this.element.checked},updateStyle:function(){if(this.input.attr("disabled")){this.wrapper.addClass("l-disabled");this.options.disabled=true}if(this.input[0].checked){this.link.addClass("l-checkbox-checked")}else{this.link.removeClass("l-checkbox-checked")}}})})(jQuery);(function(A){A.fn.ligerComboBox=function(B){return A.ligerui.run.call(this,"ligerComboBox",arguments)};A.fn.ligerGetComboBoxManager=function(){return A.ligerui.run.call(this,"ligerGetComboBoxManager",arguments)};A.ligerDefaults.ComboBox={resize:true,isMultiSelect:false,isShowCheckBox:false,columns:false,selectBoxWidth:false,selectBoxHeight:false,onBeforeSelect:false,onSelected:null,initValue:null,initText:null,valueField:"id",textField:"text",valueFieldID:null,slide:true,split:";",data:null,tree:null,treeLeafOnly:true,grid:null,onStartResize:null,onEndResize:null,hideOnLoseFocus:true,url:null,onSuccess:null,onError:null,onBeforeOpen:null,render:null,absolute:true};A.ligerMethos.ComboBox=A.ligerMethos.ComboBox||{};A.ligerui.controls.ComboBox=function(C,B){A.ligerui.controls.ComboBox.base.constructor.call(this,C,B)};A.ligerui.controls.ComboBox.ligerExtend(A.ligerui.controls.Input,{__getType:function(){return"ComboBox"},_extendMethods:function(){return A.ligerMethos.ComboBox},_init:function(){A.ligerui.controls.ComboBox.base._init.call(this);var B=this.options;if(B.columns){B.isShowCheckBox=true}if(B.isMultiSelect){B.isShowCheckBox=true}},_render:function(){var B=this,D=this.options;B.data=D.data;B.inputText=null;B.select=null;B.textFieldID="";B.valueFieldID="";B.valueField=null;if(this.element.tagName.toLowerCase()=="input"){this.element.readOnly=true;B.inputText=A(this.element);B.textFieldID=this.element.id}else{if(this.element.tagName.toLowerCase()=="select"){A(this.element).hide();B.select=A(this.element);D.isMultiSelect=false;D.isShowCheckBox=false;B.textFieldID=this.element.id+"_txt";B.inputText=A('<input type="text" readonly="true"/>');B.inputText.attr("id",B.textFieldID).insertAfter(A(this.element))}else{return}}if(B.inputText[0].name==undefined){B.inputText[0].name=B.textFieldID}B.valueField=null;if(D.valueFieldID){B.valueField=A("#"+D.valueFieldID+":input");if(B.valueField.length==0){B.valueField=A('<input type="hidden"/>')}B.valueField[0].id=B.valueField[0].name=D.valueFieldID}else{B.valueField=A('<input type="hidden"/>');B.valueField[0].id=B.valueField[0].name=B.textFieldID+"_val"}if(B.valueField[0].name==undefined){B.valueField[0].name=B.valueField[0].id}B.link=A('<div class="l-trigger"><div class="l-trigger-icon"></div></div>');B.selectBox=A('<div class="l-box-select"><div class="l-box-select-inner"><table cellpadding="0" cellspacing="0" border="0" class="l-box-select-table"></table></div></div>');B.selectBox.table=A("table:first",B.selectBox);B.wrapper=B.inputText.wrap('<div class="l-text l-text-combobox"></div>').parent();B.wrapper.append('<div class="l-text-l"></div><div class="l-text-r"></div>');B.wrapper.append(B.link);B.textwrapper=B.wrapper.wrap('<div class="l-text-wrapper"></div>').parent();if(D.absolute){B.selectBox.appendTo("body").addClass("l-box-select-absolute")}else{B.textwrapper.append(B.selectBox)}B.textwrapper.append(B.valueField);B.inputText.addClass("l-text-field");if(D.isShowCheckBox&&!B.select){A("table",B.selectBox).addClass("l-table-checkbox")}else{D.isShowCheckBox=false;A("table",B.selectBox).addClass("l-table-nocheckbox")}B.link.hover(function(){if(D.disabled){return}this.className="l-trigger-hover"},function(){if(D.disabled){return}this.className="l-trigger"}).mousedown(function(){if(D.disabled){return}this.className="l-trigger-pressed"}).mouseup(function(){if(D.disabled){return}this.className="l-trigger-hover"}).click(function(){if(D.disabled){return}if(B.trigger("beforeOpen")==false){return false}B._toggleSelectBox(B.selectBox.is(":visible"))});B.inputText.click(function(){if(D.disabled){return}if(B.trigger("beforeOpen")==false){return false}B._toggleSelectBox(B.selectBox.is(":visible"))}).blur(function(){if(D.disabled){return}B.wrapper.removeClass("l-text-focus")}).focus(function(){if(D.disabled){return}B.wrapper.addClass("l-text-focus")});B.wrapper.hover(function(){if(D.disabled){return}B.wrapper.addClass("l-text-over")},function(){if(D.disabled){return}B.wrapper.removeClass("l-text-over")});B.resizing=false;B.selectBox.hover(null,function(E){if(D.hideOnLoseFocus&&B.selectBox.is(":visible")&&!B.boxToggling&&!B.resizing){B._toggleSelectBox(true)}});var C=A("tr",B.selectBox.table).length;if(!D.selectBoxHeight&&C<8){D.selectBoxHeight=C*30}if(D.selectBoxHeight){B.selectBox.height(D.selectBoxHeight)}B.bulidContent();B.set(D);if(D.selectBoxWidth){B.selectBox.width(D.selectBoxWidth)}else{B.selectBox.css("width",B.wrapper.css("width"))}},destroy:function(){if(this.wrapper){this.wrapper.remove()}if(this.selectBox){this.selectBox.remove()}this.options=null;A.ligerui.remove(this)},_setDisabled:function(B){if(B){this.wrapper.addClass("l-text-disabled")}else{this.wrapper.removeClass("l-text-disabled")}},_setLable:function(B){var C=this,D=this.options;if(B){if(C.labelwrapper){C.labelwrapper.find(".l-text-label:first").html(B+":&nbsp")}else{C.labelwrapper=C.textwrapper.wrap('<div class="l-labeltext"></div>').parent();C.labelwrapper.prepend('<div class="l-text-label" style="float:left;display:inline;">'+B+":&nbsp</div>");C.textwrapper.css("float","left")}if(!D.labelWidth){D.labelWidth=A(".l-text-label",C.labelwrapper).outerWidth()}else{A(".l-text-label",C.labelwrapper).outerWidth(D.labelWidth)}A(".l-text-label",C.labelwrapper).width(D.labelWidth);A(".l-text-label",C.labelwrapper).height(C.wrapper.height());C.labelwrapper.append('<br style="clear:both;" />');if(D.labelAlign){A(".l-text-label",C.labelwrapper).css("text-align",D.labelAlign)}C.textwrapper.css({display:"inline"});C.labelwrapper.width(C.wrapper.outerWidth()+D.labelWidth+2)}},_setWidth:function(C){var B=this;if(C>20){B.wrapper.css({width:C});B.inputText.css({width:C-20});B.textwrapper.css({width:C})}},_setHeight:function(C){var B=this;if(C>10){B.wrapper.height(C);B.inputText.height(C-2);B.link.height(C-4);B.textwrapper.css({width:C})}},_setResize:function(C){if(C&&A.fn.ligerResizable){var B=this;B.selectBox.ligerResizable({handles:"se,s,e",onStartResize:function(){B.resizing=true;B.trigger("startResize")},onEndResize:function(){B.resizing=false;if(B.trigger("endResize")==false){return false}}});B.selectBox.append("<div class='l-btn-nw-drop'></div>")}},findTextByValue:function(F){var B=this,C=this.options;if(F==undefined){return""}var E="";var D=function(H){var I=F.toString().split(C.split);for(var G=0;G<I.length;G++){if(I[G]==H){return true}}return false};A(B.data).each(function(G,I){var J=I[C.valueField];var H=I[C.textField];if(D(J)){E+=H+C.split}});if(E.length>0){E=E.substr(0,E.length-1)}return E},findValueByText:function(E){var B=this,C=this.options;if(!E&&E==""){return""}var D=function(H){var I=E.toString().split(C.split);for(var G=0;G<I.length;G++){if(I[G]==H){return true}}return false};var F="";A(B.data).each(function(G,I){var J=I[C.valueField];var H=I[C.textField];if(D(H)){F+=J+C.split}});if(F.length>0){F=F.substr(0,F.length-1)}return F},removeItem:function(){},insertItem:function(){},addItem:function(){},_setValue:function(F){var B=this,D=this.options;var E=B.findTextByValue(F);if(D.tree){B.selectValueByTree(F)}else{if(!D.isMultiSelect){B._changeValue(F,E);A("tr[value="+F+"] td",B.selectBox).addClass("l-selected");A("tr[value!="+F+"] td",B.selectBox).removeClass("l-selected")}else{B._changeValue(F,E);var G=F.toString().split(D.split);A("table.l-table-checkbox :checkbox",B.selectBox).each(function(){this.checked=false});for(var C=0;C<G.length;C++){A("table.l-table-checkbox tr[value="+G[C]+"] :checkbox",B.selectBox).each(function(){this.checked=true})}}}},selectValue:function(B){this._setValue(B)},bulidContent:function(){var B=this,C=this.options;this.clearContent();if(B.select){B.setSelect()}else{if(B.data){B.setData(B.data)}else{if(C.tree){B.setTree(C.tree)}else{if(C.grid){B.setGrid(C.grid)}else{if(C.url){A.ajax({type:"post",url:C.url,cache:false,dataType:"json",success:function(D){B.data=D;B.setData(B.data);B.trigger("success",[B.data])},error:function(E,D){B.trigger("error",[E,D])}})}}}}}},clearContent:function(){var B=this,C=this.options;A("table",B.selectBox).html("")},setSelect:function(){var B=this,C=this.options;this.clearContent();A("option",B.select).each(function(D){var G=A(this).val();var E=A(this).html();var F=A("<tr><td index='"+D+"' value='"+G+"'>"+E+"</td>");A("table.l-table-nocheckbox",B.selectBox).append(F);A("td",F).hover(function(){A(this).addClass("l-over")},function(){A(this).removeClass("l-over")})});A("td:eq("+B.select[0].selectedIndex+")",B.selectBox).each(function(){if(A(this).hasClass("l-selected")){B.selectBox.hide();return}A(".l-selected",B.selectBox).removeClass("l-selected");A(this).addClass("l-selected");if(B.select[0].selectedIndex!=A(this).attr("index")&&B.select[0].onchange){B.select[0].selectedIndex=A(this).attr("index");B.select[0].onchange()}var F=parseInt(A(this).attr("index"));B.select[0].selectedIndex=F;B.select.trigger("change");B.selectBox.hide();var E=A(this).attr("value");var D=A(this).html();if(C.render){B.inputText.val(C.render(E,D))}else{B.inputText.val(D)}});B._addClickEven()},setData:function(C){var J=this,B=this.options;this.clearContent();if(!C||!C.length){return}if(J.data!=C){J.data=C}if(B.columns){J.selectBox.table.headrow=A("<tr class='l-table-headerow'><td width='18px'></td></tr>");J.selectBox.table.append(J.selectBox.table.headrow);J.selectBox.table.addClass("l-box-select-grid");for(var D=0;D<B.columns.length;D++){var E=A("<td columnindex='"+D+"' columnname='"+B.columns[D].name+"'>"+B.columns[D].header+"</td>");if(B.columns[D].width){E.width(B.columns[D].width)}J.selectBox.table.headrow.append(E)}}for(var H=0;H<C.length;H++){var G=C[H][B.valueField];var F=C[H][B.textField];if(!B.columns){A("table.l-table-checkbox",J.selectBox).append("<tr value='"+G+"'><td style='width:18px;'  index='"+H+"' value='"+G+"' text='"+F+"' ><input type='checkbox' /></td><td index='"+H+"' value='"+G+"' align='left'>"+F+"</td>");A("table.l-table-nocheckbox",J.selectBox).append("<tr value='"+G+"'><td index='"+H+"' value='"+G+"' align='left'>"+F+"</td>")}else{var I=A("<tr value='"+G+"'><td style='width:18px;'  index='"+H+"' value='"+G+"' text='"+F+"' ><input type='checkbox' /></td></tr>");A("td",J.selectBox.table.headrow).each(function(){var K=A(this).attr("columnname");if(K){var L=A("<td>"+C[H][K]+"</td>");I.append(L)}});J.selectBox.table.append(I)}}if(B.isShowCheckBox&&A.fn.ligerCheckBox){A("table input:checkbox",J.selectBox).ligerCheckBox()}A(".l-table-checkbox input:checkbox",J.selectBox).change(function(){if(this.checked&&J.hasBind("beforeSelect")){var K=null;if(A(this).parent().get(0).tagName.toLowerCase()=="div"){K=A(this).parent().parent()}else{K=A(this).parent()}if(K!=null&&J.trigger("beforeSelect",[K.attr("value"),K.attr("text")])==false){J.selectBox.slideToggle("fast");return false}}if(!B.isMultiSelect){if(this.checked){A("input:checked",J.selectBox).not(this).each(function(){this.checked=false;A(".l-checkbox-checked",A(this).parent()).removeClass("l-checkbox-checked")});J.selectBox.slideToggle("fast")}}J._checkboxUpdateValue()});A("table.l-table-nocheckbox td",J.selectBox).hover(function(){A(this).addClass("l-over")},function(){A(this).removeClass("l-over")});J._addClickEven();J._dataInit()},setTree:function(C){var B=this,D=this.options;this.clearContent();B.selectBox.table.remove();if(C.checkbox!=false){C.onCheck=function(){var F=B.treeManager.getChecked();var G=[];var E=[];A(F).each(function(H,I){if(D.treeLeafOnly&&I.data.children){return}G.push(I.data[D.valueField]);E.push(I.data[D.textField])});B._changeValue(G.join(D.split),E.join(D.split))}}else{C.onSelect=function(E){if(D.treeLeafOnly&&E.data.children){return}var G=E.data[D.valueField];var F=E.data[D.textField];B._changeValue(G,F)};C.onCancelSelect=function(E){B._changeValue("","")}}C.onAfterAppend=function(G,E){if(!B.treeManager){return}var F=null;if(D.initValue){F=D.initValue}else{if(B.valueField.val()!=""){F=B.valueField.val()}}B.selectValueByTree(F)};B.tree=A("<ul></ul>");A("div:first",B.selectBox).append(B.tree);B.tree.ligerTree(C);B.treeManager=B.tree.ligerGetTreeManager()},selectValueByTree:function(F){var B=this,C=this.options;if(F!=null){var E="";var D=F.toString().split(C.split);A(D).each(function(G,H){B.treeManager.selectNode(H.toString());E+=B.treeManager.getTextByID(H);if(G<D.length-1){E+=C.split}});B._changeValue(F,E)}},setGrid:function(E){var B=this,C=this.options;this.clearContent();B.selectBox.table.remove();B.grid=A("div:first",B.selectBox);E.columnWidth=E.columnWidth||120;E.width="100%";E.height="100%";E.heightDiff=-2;E.InWindow=false;B.gridManager=B.grid.ligerGrid(E);C.hideOnLoseFocus=true;if(E.checkbox!=false){var D=function(){var H=B.gridManager.getCheckedRows();var G=[];var F=[];A(H).each(function(I,J){G.push(J[C.valueField]);F.push(J[C.textField])});B._changeValue(G.join(C.split),F.join(C.split))};B.gridManager.bind("CheckAllRow",D);B.gridManager.bind("CheckRow",D)}else{B.gridManager.bind("SelectRow",function(J,G,I){var F=J[C.valueField];var H=J[C.textField];B._changeValue(F,H)});B.gridManager.bind("UnSelectRow",function(H,F,G){B._changeValue("","")})}B.bind("show",function(){if(B.gridManager){B.gridManager._updateFrozenWidth()}});B.bind("endResize",function(){if(B.gridManager){B.gridManager._updateFrozenWidth();B.gridManager.setHeight(B.selectBox.height()-2)}})},_getValue:function(){return A(this.valueField).val()},getValue:function(){return this._getValue()},updateStyle:function(){var B=this,C=this.options;B._dataInit()},_dataInit:function(){var B=this,C=this.options;var E=null;if(C.initValue!=null&&C.initText!=null){B._changeValue(C.initValue,C.initText)}if(C.initValue!=null){E=C.initValue;if(C.tree){if(E){B.selectValueByTree(E)}}else{var D=B.findTextByValue(E);B._changeValue(E,D)}}else{if(C.initText!=null){E=B.findValueByText(C.initText);B._changeValue(E,C.initText)}else{if(B.valueField.val()!=""){E=B.valueField.val();if(C.tree){if(E){B.selectValueByTree(E)}}else{var D=B.findTextByValue(E);B._changeValue(E,D)}}}}if(!C.isShowCheckBox&&E!=null){A("table tr",B.selectBox).find("td:first").each(function(){if(E==A(this).attr("value")){A(this).addClass("l-selected")}})}if(C.isShowCheckBox&&E!=null){A(":checkbox",B.selectBox).each(function(){var F=null;var H=A(this);if(H.parent().get(0).tagName.toLowerCase()=="div"){F=H.parent().parent()}else{F=H.parent()}if(F==null){return}var G=E.toString().split(C.split);A(G).each(function(I,J){if(J==F.attr("value")){A(".l-checkbox",F).addClass("l-checkbox-checked");H[0].checked=true}})})}},_changeValue:function(E,D){var B=this,C=this.options;B.valueField.val(E);if(C.render){B.inputText.val(C.render(E,D))}else{B.inputText.val(D)}B.selectedValue=E;B.selectedText=D;B.inputText.trigger("change").focus();B.trigger("selected",[E,D])},_checkboxUpdateValue:function(){var B=this,C=this.options;var D="";var E="";A("input:checked",B.selectBox).each(function(){var F=null;if(A(this).parent().get(0).tagName.toLowerCase()=="div"){F=A(this).parent().parent()}else{F=A(this).parent()}if(!F){return}D+=F.attr("value")+C.split;E+=F.attr("text")+C.split});if(D.length>0){D=D.substr(0,D.length-1)}if(E.length>0){E=E.substr(0,E.length-1)}B._changeValue(D,E)},_addClickEven:function(){var B=this,C=this.options;A(".l-table-nocheckbox td",B.selectBox).click(function(){var F=A(this).attr("value");var D=parseInt(A(this).attr("index"));var E=A(this).html();if(B.hasBind("beforeSelect")&&B.trigger("beforeSelect",[F,E])==false){if(C.slide){B.selectBox.slideToggle("fast")}else{B.selectBox.hide()}return false}if(A(this).hasClass("l-selected")){if(C.slide){B.selectBox.slideToggle("fast")}else{B.selectBox.hide()}return}A(".l-selected",B.selectBox).removeClass("l-selected");A(this).addClass("l-selected");if(B.select){if(B.select[0].selectedIndex!=D){B.select[0].selectedIndex=D;B.select.trigger("change")}}if(C.slide){B.boxToggling=true;B.selectBox.hide("fast",function(){B.boxToggling=false})}else{B.selectBox.hide()}B._changeValue(F,E)})},updateSelectBoxPosition:function(){var B=this,C=this.options;if(C.absolute){B.selectBox.css({left:B.wrapper.offset().left,top:B.wrapper.offset().top+1+B.wrapper.outerHeight()})}else{var D=B.wrapper.offset().top-A(window).scrollTop();var E=B.selectBox.height()+textHeight+4;if(D+E>A(window).height()&&D>E){B.selectBox.css("marginTop",-1*(B.selectBox.height()+textHeight+5))}}},_toggleSelectBox:function(D){var B=this,E=this.options;var F=B.wrapper.height();B.boxToggling=true;if(D){if(E.slide){B.selectBox.slideToggle("fast",function(){B.boxToggling=false})}else{B.selectBox.hide();B.boxToggling=false}}else{B.updateSelectBoxPosition();if(E.slide){B.selectBox.slideToggle("fast",function(){B.boxToggling=false;if(!E.isShowCheckBox&&A("td.l-selected",B.selectBox).length>0){var G=(A("td.l-selected",B.selectBox).offset().top-B.selectBox.offset().top);A(".l-box-select-inner",B.selectBox).animate({scrollTop:G})}})}else{B.selectBox.show();B.boxToggling=false;if(!B.tree&&!B.grid&&!E.isShowCheckBox&&A("td.l-selected",B.selectBox).length>0){var C=(A("td.l-selected",B.selectBox).offset().top-B.selectBox.offset().top);A(".l-box-select-inner",B.selectBox).animate({scrollTop:C})}}}B.isShowed=B.selectBox.is(":visible");B.trigger("toggle",[D]);B.trigger(D?"hide":"show")}});A.ligerui.controls.ComboBox.prototype.setValue=A.ligerui.controls.ComboBox.prototype.selectValue;A.ligerui.controls.ComboBox.prototype.setInputValue=A.ligerui.controls.ComboBox.prototype._changeValue})(jQuery);(function(A){A.fn.ligerDateEditor=function(){return A.ligerui.run.call(this,"ligerDateEditor",arguments)};A.fn.ligerGetDateEditorManager=function(){return A.ligerui.run.call(this,"ligerGetDateEditorManager",arguments)};A.ligerDefaults.DateEditor={format:"yyyy-MM-dd hh:mm",showTime:false,onChangeDate:false,absolute:true};A.ligerDefaults.DateEditorString={dayMessage:["日","一","二","三","四","五","六"],monthMessage:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],todayMessage:"今天",closeMessage:"关闭"};A.ligerMethos.DateEditor={};A.ligerui.controls.DateEditor=function(C,B){A.ligerui.controls.DateEditor.base.constructor.call(this,C,B)};A.ligerui.controls.DateEditor.ligerExtend(A.ligerui.controls.Input,{__getType:function(){return"DateEditor"},__idPrev:function(){return"DateEditor"},_extendMethods:function(){return A.ligerMethos.DateEditor},_render:function(){var B=this,C=this.options;if(!C.showTime&&C.format.indexOf(" hh:mm")>-1){C.format=C.format.replace(" hh:mm","")}if(this.element.tagName.toLowerCase()!="input"||this.element.type!="text"){return}B.inputText=A(this.element);if(!B.inputText.hasClass("l-text-field")){B.inputText.addClass("l-text-field")}B.link=A('<div class="l-trigger"><div class="l-trigger-icon"></div></div>');B.text=B.inputText.wrap('<div class="l-text l-text-date"></div>').parent();B.text.append('<div class="l-text-l"></div><div class="l-text-r"></div>');B.text.append(B.link);B.textwrapper=B.text.wrap('<div class="l-text-wrapper"></div>').parent();var E="";E+="<div class='l-box-dateeditor' style='display:none'>";E+="    <div class='l-box-dateeditor-header'>";E+="        <div class='l-box-dateeditor-header-btn l-box-dateeditor-header-prevyear'><span></span></div>";E+="        <div class='l-box-dateeditor-header-btn l-box-dateeditor-header-prevmonth'><span></span></div>";E+="        <div class='l-box-dateeditor-header-text'><a class='l-box-dateeditor-header-month'></a> , <a  class='l-box-dateeditor-header-year'></a></div>";E+="        <div class='l-box-dateeditor-header-btn l-box-dateeditor-header-nextmonth'><span></span></div>";E+="        <div class='l-box-dateeditor-header-btn l-box-dateeditor-header-nextyear'><span></span></div>";E+="    </div>";E+="    <div class='l-box-dateeditor-body'>";E+="        <table cellpadding='0' cellspacing='0' border='0' class='l-box-dateeditor-calendar'>";E+="            <thead>";E+="                <tr><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td></tr>";E+="            </thead>";E+="            <tbody>";E+="                <tr class='l-first'><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td></tr><tr><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td></tr><tr><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td></tr><tr><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td></tr><tr><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td></tr><tr><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td></tr>";E+="            </tbody>";E+="        </table>";E+="        <ul class='l-box-dateeditor-monthselector'><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul>";E+="        <ul class='l-box-dateeditor-yearselector'><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul>";E+="        <ul class='l-box-dateeditor-hourselector'><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul>";E+="        <ul class='l-box-dateeditor-minuteselector'><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul>";E+="    </div>";E+="    <div class='l-box-dateeditor-toolbar'>";E+="        <div class='l-box-dateeditor-time'></div>";E+="        <div class='l-button l-button-today'></div>";E+="        <div class='l-button l-button-close'></div>";E+="        <div class='l-clear'></div>";E+="    </div>";E+="</div>";B.dateeditor=A(E);if(C.absolute){B.dateeditor.appendTo("body").addClass("l-box-dateeditor-absolute")}else{B.textwrapper.append(B.dateeditor)}B.header=A(".l-box-dateeditor-header",B.dateeditor);B.body=A(".l-box-dateeditor-body",B.dateeditor);B.toolbar=A(".l-box-dateeditor-toolbar",B.dateeditor);B.body.thead=A("thead",B.body);B.body.tbody=A("tbody",B.body);B.body.monthselector=A(".l-box-dateeditor-monthselector",B.body);B.body.yearselector=A(".l-box-dateeditor-yearselector",B.body);B.body.hourselector=A(".l-box-dateeditor-hourselector",B.body);B.body.minuteselector=A(".l-box-dateeditor-minuteselector",B.body);B.toolbar.time=A(".l-box-dateeditor-time",B.toolbar);B.toolbar.time.hour=A("<a></a>");B.toolbar.time.minute=A("<a></a>");B.buttons={btnPrevYear:A(".l-box-dateeditor-header-prevyear",B.header),btnNextYear:A(".l-box-dateeditor-header-nextyear",B.header),btnPrevMonth:A(".l-box-dateeditor-header-prevmonth",B.header),btnNextMonth:A(".l-box-dateeditor-header-nextmonth",B.header),btnYear:A(".l-box-dateeditor-header-year",B.header),btnMonth:A(".l-box-dateeditor-header-month",B.header),btnToday:A(".l-button-today",B.toolbar),btnClose:A(".l-button-close",B.toolbar)};var D=new Date();B.now={year:D.getFullYear(),month:D.getMonth()+1,day:D.getDay(),date:D.getDate(),hour:D.getHours(),minute:D.getMinutes()};B.currentDate={year:D.getFullYear(),month:D.getMonth()+1,day:D.getDay(),date:D.getDate(),hour:D.getHours(),minute:D.getMinutes()};B.selectedDate=null;B.usedDate=null;A("td",B.body.thead).each(function(F,G){A(G).html(C.dayMessage[F])});A("li",B.body.monthselector).each(function(F,G){A(G).html(C.monthMessage[F])});B.buttons.btnToday.html(C.todayMessage);B.buttons.btnClose.html(C.closeMessage);if(C.showTime){B.toolbar.time.show();B.toolbar.time.append(B.toolbar.time.hour).append(":").append(B.toolbar.time.minute);A("li",B.body.hourselector).each(function(F,G){var H=F;if(F<10){H="0"+F.toString()}A(this).html(H)});A("li",B.body.minuteselector).each(function(F,G){var H=F;if(F<10){H="0"+F.toString()}A(this).html(H)})}B.bulidContent();if(B.inputText.val()!=""){B.onTextChange()}B.dateeditor.hover(null,function(F){if(B.dateeditor.is(":visible")&&!B.editorToggling){B.toggleDateEditor(true)}});B.link.hover(function(){if(C.disabled){return}this.className="l-trigger-hover"},function(){if(C.disabled){return}this.className="l-trigger"}).mousedown(function(){if(C.disabled){return}this.className="l-trigger-pressed"}).mouseup(function(){if(C.disabled){return}this.className="l-trigger-hover"}).click(function(){if(C.disabled){return}B.bulidContent();B.toggleDateEditor(B.dateeditor.is(":visible"))});if(C.disabled){B.inputText.attr("readonly","readonly");B.text.addClass("l-text-disabled")}if(C.initValue){B.inputText.val(C.initValue)}B.buttons.btnClose.click(function(){B.toggleDateEditor(true)});A("td",B.body.tbody).hover(function(){if(A(this).hasClass("l-box-dateeditor-today")){return}A(this).addClass("l-box-dateeditor-over")},function(){A(this).removeClass("l-box-dateeditor-over")}).click(function(){A(".l-box-dateeditor-selected",B.body.tbody).removeClass("l-box-dateeditor-selected");if(!A(this).hasClass("l-box-dateeditor-today")){A(this).addClass("l-box-dateeditor-selected")}B.currentDate.date=parseInt(A(this).html());B.currentDate.day=new Date(B.currentDate.year,B.currentDate.month-1,1).getDay();if(A(this).hasClass("l-box-dateeditor-out")){if(A("tr",B.body.tbody).index(A(this).parent())==0){if(--B.currentDate.month==0){B.currentDate.month=12;B.currentDate.year--}}else{if(++B.currentDate.month==13){B.currentDate.month=1;B.currentDate.year++}}}B.selectedDate={year:B.currentDate.year,month:B.currentDate.month,date:B.currentDate.date};B.showDate();B.editorToggling=true;B.dateeditor.slideToggle("fast",function(){B.editorToggling=false})});A(".l-box-dateeditor-header-btn",B.header).hover(function(){A(this).addClass("l-box-dateeditor-header-btn-over")},function(){A(this).removeClass("l-box-dateeditor-header-btn-over")});B.buttons.btnYear.click(function(){if(!B.body.yearselector.is(":visible")){A("li",B.body.yearselector).each(function(F,G){var H=B.currentDate.year+(F-4);if(H==B.currentDate.year){A(this).addClass("l-selected")}else{A(this).removeClass("l-selected")}A(this).html(H)})}B.body.yearselector.slideToggle()});B.body.yearselector.hover(function(){},function(){A(this).slideUp()});A("li",B.body.yearselector).click(function(){B.currentDate.year=parseInt(A(this).html());B.body.yearselector.slideToggle();B.bulidContent()});B.buttons.btnMonth.click(function(){A("li",B.body.monthselector).each(function(F,G){if(B.currentDate.month==F+1){A(this).addClass("l-selected")}else{A(this).removeClass("l-selected")}});B.body.monthselector.slideToggle()});B.body.monthselector.hover(function(){},function(){A(this).slideUp("fast")});A("li",B.body.monthselector).click(function(){var F=A("li",B.body.monthselector).index(this);B.currentDate.month=F+1;B.body.monthselector.slideToggle();B.bulidContent()});B.toolbar.time.hour.click(function(){A("li",B.body.hourselector).each(function(F,G){if(B.currentDate.hour==F){A(this).addClass("l-selected")}else{A(this).removeClass("l-selected")}});B.body.hourselector.slideToggle()});B.body.hourselector.hover(function(){},function(){A(this).slideUp("fast")});A("li",B.body.hourselector).click(function(){var F=A("li",B.body.hourselector).index(this);B.currentDate.hour=F;B.body.hourselector.slideToggle();B.bulidContent()});B.toolbar.time.minute.click(function(){A("li",B.body.minuteselector).each(function(F,G){if(B.currentDate.minute==F){A(this).addClass("l-selected")}else{A(this).removeClass("l-selected")}});B.body.minuteselector.slideToggle("fast",function(){var G=A("li",this).index(A("li.l-selected",this));if(G>29){var F=(A("li.l-selected",this).offset().top-A(this).offset().top);A(this).animate({scrollTop:F})}})});B.body.minuteselector.hover(function(){},function(){A(this).slideUp("fast")});A("li",B.body.minuteselector).click(function(){var F=A("li",B.body.minuteselector).index(this);B.currentDate.minute=F;B.body.minuteselector.slideToggle("fast");B.bulidContent()});B.buttons.btnPrevMonth.click(function(){if(--B.currentDate.month==0){B.currentDate.month=12;B.currentDate.year--}B.bulidContent()});B.buttons.btnNextMonth.click(function(){if(++B.currentDate.month==13){B.currentDate.month=1;B.currentDate.year++}B.bulidContent()});B.buttons.btnPrevYear.click(function(){B.currentDate.year--;B.bulidContent()});B.buttons.btnNextYear.click(function(){B.currentDate.year++;B.bulidContent()});B.buttons.btnToday.click(function(){B.currentDate={year:B.now.year,month:B.now.month,day:B.now.day,date:B.now.date};B.selectedDate={year:B.now.year,month:B.now.month,day:B.now.day,date:B.now.date};B.showDate();B.dateeditor.slideToggle("fast")});B.inputText.change(function(){B.onTextChange()}).blur(function(){B.text.removeClass("l-text-focus")}).focus(function(){B.text.addClass("l-text-focus")});B.text.hover(function(){B.text.addClass("l-text-over")},function(){B.text.removeClass("l-text-over")});if(C.label){B.labelwrapper=B.textwrapper.wrap('<div class="l-labeltext"></div>').parent();B.labelwrapper.prepend('<div class="l-text-label" style="float:left;display:inline;">'+C.label+":&nbsp</div>");B.textwrapper.css("float","left");if(!C.labelWidth){C.labelWidth=A(".l-text-label",B.labelwrapper).outerWidth()}else{A(".l-text-label",B.labelwrapper).outerWidth(C.labelWidth)}A(".l-text-label",B.labelwrapper).width(C.labelWidth);A(".l-text-label",B.labelwrapper).height(B.text.height());B.labelwrapper.append('<br style="clear:both;" />');if(C.labelAlign){A(".l-text-label",B.labelwrapper).css("text-align",C.labelAlign)}B.textwrapper.css({display:"inline"});B.labelwrapper.width(B.text.outerWidth()+C.labelWidth+2)}B.set(C)},destroy:function(){if(this.textwrapper){this.textwrapper.remove()}if(this.dateeditor){this.dateeditor.remove()}this.options=null;A.ligerui.remove(this)},bulidContent:function(){var B=this,D=this.options;var C=new Date(B.currentDate.year,B.currentDate.month-1,1).getDay();var F=B.currentDate.month;var G=B.currentDate.year;if(++F==13){F=1;G++}var E=new Date(G,F-1,0).getDate();var H=new Date(B.currentDate.year,B.currentDate.month-1,0).getDate();B.buttons.btnMonth.html(D.monthMessage[B.currentDate.month-1]);B.buttons.btnYear.html(B.currentDate.year);B.toolbar.time.hour.html(B.currentDate.hour);B.toolbar.time.minute.html(B.currentDate.minute);if(B.toolbar.time.hour.html().length==1){B.toolbar.time.hour.html("0"+B.toolbar.time.hour.html())}if(B.toolbar.time.minute.html().length==1){B.toolbar.time.minute.html("0"+B.toolbar.time.minute.html())}A("td",this.body.tbody).each(function(){this.className=""});A("tr",this.body.tbody).each(function(I,J){A("td",J).each(function(M,K){var N=I*7+(M-C);var L=N+1;if(B.selectedDate&&B.currentDate.year==B.selectedDate.year&&B.currentDate.month==B.selectedDate.month&&N+1==B.selectedDate.date){if(M==0||M==6){A(K).addClass("l-box-dateeditor-holiday")}A(K).addClass("l-box-dateeditor-selected");A(K).siblings().removeClass("l-box-dateeditor-selected")}else{if(B.currentDate.year==B.now.year&&B.currentDate.month==B.now.month&&N+1==B.now.date){if(M==0||M==6){A(K).addClass("l-box-dateeditor-holiday")}A(K).addClass("l-box-dateeditor-today")}else{if(N<0){L=H+L;A(K).addClass("l-box-dateeditor-out").removeClass("l-box-dateeditor-selected")}else{if(N>E-1){L=L-E;A(K).addClass("l-box-dateeditor-out").removeClass("l-box-dateeditor-selected")}else{if(M==0||M==6){A(K).addClass("l-box-dateeditor-holiday").removeClass("l-box-dateeditor-selected")}else{K.className=""}}}}}A(K).html(L)})})},updateSelectBoxPosition:function(){var B=this,C=this.options;if(C.absolute){B.dateeditor.css({left:B.text.offset().left,top:B.text.offset().top+1+B.text.outerHeight()})}else{if(B.text.offset().top+4>B.dateeditor.height()&&B.text.offset().top+B.dateeditor.height()+textHeight+4-A(window).scrollTop()>A(window).height()){B.dateeditor.css("marginTop",-1*(B.dateeditor.height()+textHeight+5));B.showOnTop=true}else{B.showOnTop=false}}},toggleDateEditor:function(C){var B=this,D=this.options;var E=B.text.height();B.editorToggling=true;if(C){B.dateeditor.hide("fast",function(){B.editorToggling=false})}else{B.updateSelectBoxPosition();B.dateeditor.slideDown("fast",function(){B.editorToggling=false})}},showDate:function(){var B=this,C=this.options;if(!this.selectedDate){return}var D=B.selectedDate.year+"/"+B.selectedDate.month+"/"+B.selectedDate.date;this.currentDate.hour=parseInt(B.toolbar.time.hour.html(),10);this.currentDate.minute=parseInt(B.toolbar.time.minute.html(),10);if(C.showTime){D+=" "+this.currentDate.hour+":"+this.currentDate.minute}this.inputText.val(D);this.inputText.trigger("change").focus()},isDateTime:function(E){var B=this,D=this.options;var C=E.match(/^(\d{1,4})(-|\/)(\d{1,2})\2(\d{1,2})$/);if(C==null){return false}var F=new Date(C[1],C[3]-1,C[4]);if(F=="NaN"){return false}return(F.getFullYear()==C[1]&&(F.getMonth()+1)==C[3]&&F.getDate()==C[4])},isLongDateTime:function(E){var B=this,D=this.options;var G=/^(\d{1,4})(-|\/)(\d{1,2})\2(\d{1,2}) (\d{1,2}):(\d{1,2})$/;var C=E.match(G);if(C==null){return false}var F=new Date(C[1],C[3]-1,C[4],C[5],C[6]);if(F=="NaN"){return false}return(F.getFullYear()==C[1]&&(F.getMonth()+1)==C[3]&&F.getDate()==C[4]&&F.getHours()==C[5]&&F.getMinutes()==C[6])},getFormatDate:function(F){var B=this,D=this.options;if(F=="NaN"){return null}var C=D.format;var E={"M+":F.getMonth()+1,"d+":F.getDate(),"h+":F.getHours(),"m+":F.getMinutes(),"s+":F.getSeconds(),"q+":Math.floor((F.getMonth()+3)/3),"S":F.getMilliseconds()};if(/(y+)/.test(C)){C=C.replace(RegExp.$1,(F.getFullYear()+"").substr(4-RegExp.$1.length))}for(var G in E){if(new RegExp("("+G+")").test(C)){C=C.replace(RegExp.$1,RegExp.$1.length==1?E[G]:("00"+E[G]).substr((""+E[G]).length))}}return C},onTextChange:function(){var B=this,C=this.options;var E=B.inputText.val();if(E==""){B.selectedDate=null;return true}if(!C.showTime&&!B.isDateTime(E)){if(!B.usedDate){B.inputText.val("")}else{B.inputText.val(B.getFormatDate(B.usedDate))}}else{if(C.showTime&&!B.isLongDateTime(E)){if(!B.usedDate){B.inputText.val("")}else{B.inputText.val(B.getFormatDate(B.usedDate))}}else{E=E.replace(/-/g,"/");var D=B.getFormatDate(new Date(E));if(D==null){if(!B.usedDate){B.inputText.val("")}else{B.inputText.val(B.getFormatDate(B.usedDate))}}B.usedDate=new Date(E);B.selectedDate={year:B.usedDate.getFullYear(),month:B.usedDate.getMonth()+1,day:B.usedDate.getDay(),date:B.usedDate.getDate(),hour:B.usedDate.getHours(),minute:B.usedDate.getMinutes()};B.currentDate={year:B.usedDate.getFullYear(),month:B.usedDate.getMonth()+1,day:B.usedDate.getDay(),date:B.usedDate.getDate(),hour:B.usedDate.getHours(),minute:B.usedDate.getMinutes()};B.inputText.val(D);B.trigger("changeDate",[D]);if(A(B.dateeditor).is(":visible")){B.bulidContent()}}}},_setHeight:function(C){var B=this;if(C>4){B.text.css({height:C});B.inputText.css({height:C});B.textwrapper.css({height:C})}},_setWidth:function(C){var B=this;if(C>20){B.text.css({width:C});B.inputText.css({width:C-20});B.textwrapper.css({width:C})}},_setValue:function(C){var B=this;if(!C){B.inputText.val("")}if(typeof C=="string"){B.inputText.val(C)}else{if(typeof C=="object"){if(C instanceof Date){B.inputText.val(B.getFormatDate(C));B.onTextChange()}}}},_getValue:function(){return this.usedDate},setEnabled:function(){var B=this,C=this.options;this.inputText.removeAttr("readonly");this.text.removeClass("l-text-disabled");C.disabled=false},setDisabled:function(){var B=this,C=this.options;this.inputText.attr("readonly","readonly");this.text.addClass("l-text-disabled");C.disabled=true}})})(jQuery);(function(C){var A=C.ligerui;C(".l-dialog-btn").live("mouseover",function(){C(this).addClass("l-dialog-btn-over")}).live("mouseout",function(){C(this).removeClass("l-dialog-btn-over")});C(".l-dialog-tc .l-dialog-close").live("mouseover",function(){C(this).addClass("l-dialog-close-over")}).live("mouseout",function(){C(this).removeClass("l-dialog-close-over")});C.ligerDialog=function(){return A.run.call(null,"ligerDialog",arguments,{isStatic:true})};C.ligerui.DialogImagePath="../../lib/ligerUI/skins/Aqua/images/win/";function B(E){for(var D in E){C("<img />").attr("src",A.DialogImagePath+E[D])}}C.ligerDefaults.Dialog={cls:null,id:null,buttons:null,isDrag:true,width:280,height:null,content:"",target:null,url:null,load:false,onLoaded:null,type:"none",left:null,top:null,modal:true,name:null,isResize:false,allowClose:true,opener:null,timeParmName:null,closeWhenEnter:null,isHidden:true,show:true,title:"提示",showMax:false,showToggle:false,showMin:false,slide:C.browser.msie?false:true,fixedType:null,showType:null,callBackFun:null};C.ligerDefaults.DialogString={titleMessage:"提示",ok:"确定",yes:"是",no:"否",cancel:"取消",waittingMessage:"正在等待中,请稍候..."};C.ligerMethos.Dialog=C.ligerMethos.Dialog||{};A.controls.Dialog=function(D){A.controls.Dialog.base.constructor.call(this,null,D)};A.controls.Dialog.ligerExtend(A.core.Win,{__getType:function(){return"Dialog"},__idPrev:function(){return"Dialog"},_extendMethods:function(){return C.ligerMethos.Dialog},_render:function(){var D=this,F=this.options;D.set(F,true);var J=C('<div class="l-dialog"><table class="l-dialog-table" cellpadding="0" cellspacing="0" border="0"><tbody><tr><td class="l-dialog-tl"></td><td class="l-dialog-tc"><div class="l-dialog-tc-inner"><div class="l-dialog-icon"></div><div class="l-dialog-title"></div><div class="l-dialog-winbtns"><div class="l-dialog-winbtn l-dialog-close"></div></div></div></td><td class="l-dialog-tr"></td></tr><tr><td class="l-dialog-cl"></td><td class="l-dialog-cc"><div class="l-dialog-body"><div class="l-dialog-image"></div> <div class="l-dialog-content"></div><div class="l-dialog-buttons"><div class="l-dialog-buttons-inner"></div></td><td class="l-dialog-cr"></td></tr><tr><td class="l-dialog-bl"></td><td class="l-dialog-bc"></td><td class="l-dialog-br"></td></tr></tbody></table></div>');C("body").append(J);D.dialog=J;D.element=J[0];D.dialog.body=C(".l-dialog-body:first",D.dialog);D.dialog.header=C(".l-dialog-tc-inner:first",D.dialog);D.dialog.winbtns=C(".l-dialog-winbtns:first",D.dialog.header);D.dialog.buttons=C(".l-dialog-buttons:first",D.dialog);D.dialog.content=C(".l-dialog-content:first",D.dialog);D.set(F,false);if(F.allowClose==false){C(".l-dialog-close",D.dialog).remove()}if(F.target||F.url||F.type=="none"){F.type=null;D.dialog.addClass("l-dialog-win")}if(F.cls){D.dialog.addClass(F.cls)}if(F.id){D.dialog.attr("id",F.id)}D.mask();if(F.isDrag){D._applyDrag()}if(F.isResize){D._applyResize()}if(F.type){D._setImage()}else{C(".l-dialog-image",D.dialog).remove();D.dialog.content.addClass("l-dialog-content-noimage")}if(!F.show){D.unmask();D.dialog.hide()}if(F.target){D.dialog.content.prepend(F.target);C(F.target).show()}else{if(F.url){if(F.timeParmName){F.url+=F.url.indexOf("?")==-1?"?":"&";F.url+=F.timeParmName+"="+new Date().getTime()}if(F.load){D.dialog.body.load(F.url,function(){D._saveStatus();D.trigger("loaded")})}else{D.jiframe=C("<iframe frameborder='0'></iframe>");var H=F.name?F.name:"ligerwindow"+new Date().getTime();D.jiframe.attr("name",H);D.jiframe.attr("id",H);D.dialog.content.prepend(D.jiframe);D.dialog.content.addClass("l-dialog-content-nopadding");setTimeout(function(){D.jiframe.attr("src",F.url);D.frame=window.frames[D.jiframe.attr("name")]},0)}}}if(F.opener){D.dialog.opener=F.opener}if(F.buttons){C(F.buttons).each(function(K,L){var M=C('<div class="l-dialog-btn"><div class="l-dialog-btn-l"></div><div class="l-dialog-btn-r"></div><div class="l-dialog-btn-inner"></div></div>');C(".l-dialog-btn-inner",M).html(L.text);C(".l-dialog-buttons-inner",D.dialog.buttons).prepend(M);L.width&&M.width(L.width);L.onclick&&M.click(function(){L.onclick(L,D,K)})})}else{D.dialog.buttons.remove()}C(".l-dialog-buttons-inner",D.dialog.buttons).append("<div class='l-clear'></div>");C(".l-dialog-title",D.dialog).bind("selectstart",function(){return false});D.dialog.click(function(){A.win.setFront(D)});C(".l-dialog-tc .l-dialog-close",D.dialog).click(function(){if(typeof(F.callBackFun)=="function"){F.callBackFun()}if(F.isHidden){D.hide()}else{D.close()}});if(!F.fixedType){var E=0;var G=0;var I=F.width||D.dialog.width();if(F.slide==true){F.slide="fast"}if(F.left!=null){E=F.left}else{F.left=E=0.5*(C(window).width()-I)}if(F.top!=null){G=F.top}else{F.top=G=0.5*(C(window).height()-D.dialog.height())+C(window).scrollTop()-10}if(E<0){F.left=E=0}if(G<0){F.top=G=0}D.dialog.css({left:E,top:G})}D.show();C("body").bind("keydown.dialog",function(L){var K=L.which;if(K==13){D.enter()}else{if(K==27){D.esc()}}});D._updateBtnsWidth();D._saveStatus();D._onReisze()},_borderX:12,_borderY:32,doMax:function(F){var D=this,G=this.options;var J=C(window).width(),E=C(window).height(),H=0,I=0;if(A.win.taskbar){E-=A.win.taskbar.outerHeight();if(A.win.top){I+=A.win.taskbar.outerHeight()}}if(F){D.dialog.body.animate({width:J-D._borderX},G.slide);D.dialog.animate({left:H,top:I},G.slide);D.dialog.content.animate({height:E-D._borderY-D.dialog.buttons.outerHeight()},G.slide,function(){D._onReisze()})}else{D.set({width:J,height:E,left:H,top:I});D._onReisze()}},max:function(){var D=this,E=this.options;if(D.winmax){D.winmax.addClass("l-dialog-recover");D.doMax(E.slide);if(D.wintoggle){if(D.wintoggle.hasClass("l-dialog-extend")){D.wintoggle.addClass("l-dialog-toggle-disabled l-dialog-extend-disabled")}else{D.wintoggle.addClass("l-dialog-toggle-disabled l-dialog-collapse-disabled")}}if(D.resizable){D.resizable.set({disabled:true})}if(D.draggable){D.draggable.set({disabled:true})}D.maximum=true;C(window).bind("resize.dialogmax",function(){D.doMax(false)})}},recover:function(){var D=this,E=this.options;if(D.winmax){D.winmax.removeClass("l-dialog-recover");if(E.slide){D.dialog.body.animate({width:D._width-D._borderX},E.slide);D.dialog.animate({left:D._left,top:D._top},E.slide);D.dialog.content.animate({height:D._height-D._borderY-D.dialog.buttons.outerHeight()},E.slide,function(){D._onReisze()})}else{D.set({width:D._width,height:D._height,left:D._left,top:D._top});D._onReisze()}if(D.wintoggle){D.wintoggle.removeClass("l-dialog-toggle-disabled l-dialog-extend-disabled l-dialog-collapse-disabled")}C(window).unbind("resize.dialogmax")}if(this.resizable){this.resizable.set({disabled:false})}if(D.draggable){D.draggable.set({disabled:false})}D.maximum=false},min:function(){var D=this,E=this.options;var F=A.win.getTask(this);if(E.slide){D.dialog.body.animate({width:1},E.slide);F.y=F.offset().top+F.height();F.x=F.offset().left+F.width()/2;D.dialog.animate({left:F.x,top:F.y},E.slide,function(){D.dialog.hide()})}else{D.dialog.hide()}D.unmask();D.minimize=true;D.actived=false},active:function(){var D=this,G=this.options;if(D.minimize){var I=D._width,E=D._height,F=D._left,H=D._top;if(D.maximum){I=C(window).width();E=C(window).height();F=H=0;if(A.win.taskbar){E-=A.win.taskbar.outerHeight();if(A.win.top){H+=A.win.taskbar.outerHeight()}}}if(G.slide){D.dialog.body.animate({width:I-D._borderX},G.slide);D.dialog.animate({left:F,top:H},G.slide)}else{D.set({width:I,height:E,left:F,top:H})}}D.actived=true;D.minimize=false;A.win.setFront(D);D.show()},toggle:function(){var D=this,E=this.options;if(!D.wintoggle){return}if(D.wintoggle.hasClass("l-dialog-extend")){D.extend()}else{D.collapse()}},collapse:function(){var D=this,E=this.options;if(!D.wintoggle){return}if(E.slide){D.dialog.content.animate({height:1},E.slide)}else{D.dialog.content.height(1)}if(this.resizable){this.resizable.set({disabled:true})}},extend:function(){var D=this,E=this.options;if(!D.wintoggle){return}var F=D._height-D._borderY-D.dialog.buttons.outerHeight();if(E.slide){D.dialog.content.animate({height:F},E.slide)}else{D.dialog.content.height(F)}if(this.resizable){this.resizable.set({disabled:false})}},_updateBtnsWidth:function(){var D=this;var E=C(">div",D.dialog.winbtns).length;D.dialog.winbtns.width(22*E)},_setLeft:function(D){if(!this.dialog){return}if(D!=null){this.dialog.css({left:D})}},_setTop:function(D){if(!this.dialog){return}if(D!=null){this.dialog.css({top:D})}},_setWidth:function(D){if(!this.dialog){return}if(D>=this._borderX){this.dialog.body.width(D-this._borderX)}},_setHeight:function(G){var D=this,F=this.options;if(!this.dialog){return}if(G>=this._borderY){var E=G-this._borderY-D.dialog.buttons.outerHeight();D.dialog.content.height(E)}},_setShowMax:function(F){var D=this,E=this.options;if(F){if(!D.winmax){D.winmax=C('<div class="l-dialog-winbtn l-dialog-max"></div>').appendTo(D.dialog.winbtns).hover(function(){if(C(this).hasClass("l-dialog-recover")){C(this).addClass("l-dialog-recover-over")}else{C(this).addClass("l-dialog-max-over")}},function(){C(this).removeClass("l-dialog-max-over l-dialog-recover-over")}).click(function(){if(C(this).hasClass("l-dialog-recover")){D.recover()}else{D.max()}})}}else{if(D.winmax){D.winmax.remove();D.winmax=null}}D._updateBtnsWidth()},_setShowMin:function(F){var D=this,E=this.options;if(F){if(!D.winmin){D.winmin=C('<div class="l-dialog-winbtn l-dialog-min"></div>').appendTo(D.dialog.winbtns).hover(function(){C(this).addClass("l-dialog-min-over")},function(){C(this).removeClass("l-dialog-min-over")}).click(function(){D.min()});A.win.addTask(D)}}else{if(D.winmin){D.winmin.remove();D.winmin=null}}D._updateBtnsWidth()},_setShowToggle:function(F){var D=this,E=this.options;if(F){if(!D.wintoggle){D.wintoggle=C('<div class="l-dialog-winbtn l-dialog-collapse"></div>').appendTo(D.dialog.winbtns).hover(function(){if(C(this).hasClass("l-dialog-toggle-disabled")){return}if(C(this).hasClass("l-dialog-extend")){C(this).addClass("l-dialog-extend-over")}else{C(this).addClass("l-dialog-collapse-over")}},function(){C(this).removeClass("l-dialog-extend-over l-dialog-collapse-over")}).click(function(){if(C(this).hasClass("l-dialog-toggle-disabled")){return}if(D.wintoggle.hasClass("l-dialog-extend")){if(D.trigger("extend")==false){return}D.wintoggle.removeClass("l-dialog-extend");D.extend();D.trigger("extended")}else{if(D.trigger("collapse")==false){return}D.wintoggle.addClass("l-dialog-extend");D.collapse();D.trigger("collapseed")}})}}else{if(D.wintoggle){D.wintoggle.remove();D.wintoggle=null}}},enter:function(){var D=this,E=this.options;var F;if(E.closeWhenEnter!=undefined){F=E.closeWhenEnter}else{if(E.type=="warn"||E.type=="error"||E.type=="success"||E.type=="question"){F=true}}if(F){D.close()}},esc:function(){},_removeDialog:function(){var D=this,E=this.options;if(E.showType&&E.fixedType){D.dialog.animate({bottom:-1*E.height},function(){D.dialog.remove()})}else{D.dialog.remove()}},close:function(){var D=this,E=this.options;A.win.removeTask(this);D.unmask();D._removeDialog();C("body").unbind("keydown.dialog")},_getVisible:function(){return this.dialog.is(":visible")},_setUrl:function(E){var D=this,F=this.options;F.url=E;if(F.load){D.dialog.body.html("").load(F.url,function(){D.trigger("loaded")})}else{if(D.jiframe){D.jiframe.attr("src",F.url)}}},_setContent:function(D){this.dialog.content.html(D)},_setTitle:function(F){var D=this;var E=this.options;if(F){C(".l-dialog-title",D.dialog).html(F)}},_hideDialog:function(){var D=this,E=this.options;if(E.showType&&E.fixedType){D.dialog.animate({bottom:-1*E.height},function(){D.dialog.hide()})}else{D.dialog.hide()}},hidden:function(){var D=this;A.win.removeTask(D);D.dialog.hide();D.unmask()},show:function(){var D=this,E=this.options;D.mask();if(E.fixedType){if(E.showType){D.dialog.css({bottom:-1*E.height}).addClass("l-dialog-fixed");D.dialog.show().animate({bottom:0})}else{D.dialog.show().css({bottom:0})}}else{D.dialog.show()}C.ligerui.win.setFront.ligerDefer(C.ligerui.win,100,[D])},setUrl:function(D){this._setUrl(D)},_saveStatus:function(){var D=this;D._width=D.dialog.body.width();D._height=D.dialog.body.height();var F=0;var E=0;if(!isNaN(parseInt(D.dialog.css("top")))){F=parseInt(D.dialog.css("top"))}if(!isNaN(parseInt(D.dialog.css("left")))){E=parseInt(D.dialog.css("left"))}D._top=F;D._left=E},_applyDrag:function(){var D=this,E=this.options;if(C.fn.ligerDrag){D.draggable=D.dialog.ligerDrag({handler:".l-dialog-title",animate:false,onStartDrag:function(){A.win.setFront(D)},onStopDrag:function(){if(E.target){var F=A.find(C.ligerui.controls.DateEditor);var G=A.find(C.ligerui.controls.ComboBox);C(C.merge(F,G)).each(function(){if(this.updateSelectBoxPosition){this.updateSelectBoxPosition()}})}D._saveStatus()}})}},_onReisze:function(){var D=this,E=this.options;if(E.target){var G=C(E.target).liger();if(!G){G=C(E.target).find(":first").liger()}if(!G){return}var F=D.dialog.content.height();var H=D.dialog.content.width();G.trigger("resize",[{width:H,height:F}])}},_applyResize:function(){var D=this,E=this.options;if(C.fn.ligerResizable){D.resizable=D.dialog.ligerResizable({onStopResize:function(I,F){var H=0;var G=0;if(!isNaN(parseInt(D.dialog.css("top")))){H=parseInt(D.dialog.css("top"))}if(!isNaN(parseInt(D.dialog.css("left")))){G=parseInt(D.dialog.css("left"))}if(I.diffLeft){D.set({left:G+I.diffLeft})}if(I.diffTop){D.set({top:H+I.diffTop})}if(I.newWidth){D.set({width:I.newWidth});D.dialog.body.css({width:I.newWidth-D._borderX})}if(I.newHeight){D.set({height:I.newHeight})}D._onReisze();D._saveStatus();return false},animate:false})}},_setImage:function(){var D=this,E=this.options;if(E.type){if(E.type=="success"||E.type=="donne"||E.type=="ok"){C(".l-dialog-image",D.dialog).addClass("l-dialog-image-donne").show();D.dialog.content.css({paddingLeft:64,paddingBottom:30})}else{if(E.type=="error"){C(".l-dialog-image",D.dialog).addClass("l-dialog-image-error").show();D.dialog.content.css({paddingLeft:64,paddingBottom:30})}else{if(E.type=="warn"){C(".l-dialog-image",D.dialog).addClass("l-dialog-image-warn").show();D.dialog.content.css({paddingLeft:64,paddingBottom:30})}else{if(E.type=="question"){C(".l-dialog-image",D.dialog).addClass("l-dialog-image-question").show();D.dialog.content.css({paddingLeft:64,paddingBottom:40})}}}}}}});A.controls.Dialog.prototype.hide=A.controls.Dialog.prototype.hidden;C.ligerDialog.open=function(D){return C.ligerDialog(D)};C.ligerDialog.close=function(){var E=A.find(A.controls.Dialog.prototype.__getType());for(var D in E){var F=E[D];F.destroy.ligerDefer(F,5)}A.win.unmask()};C.ligerDialog.show=function(F){var D=A.find(A.controls.Dialog.prototype.__getType());if(D.length){for(var E in D){D[E].show();return}}return C.ligerDialog(F)};C.ligerDialog.hide=function(){var E=A.find(A.controls.Dialog.prototype.__getType());for(var D in E){var F=E[D];F.hide()}};C.ligerDialog.tip=function(D){D=C.extend({showType:"slide",width:240,modal:false,height:100},D||{});C.extend(D,{fixedType:"se",type:"none",isDrag:false,isResize:false,showMax:false,showToggle:false,showMin:false});return C.ligerDialog.open(D)};C.ligerDialog.alert=function(H,G,D,F){H=H||"";if(typeof(G)=="function"){F=G;D=null}else{if(typeof(D)=="function"){F=D}}var E=function(J,I,K){I.close();if(F){F(J,I,K)}};p={content:H,buttons:[{text:C.ligerDefaults.DialogString.ok,onclick:E}]};if(typeof(G)=="string"&&G!=""){p.title=G}if(typeof(D)=="string"&&D!=""){p.type=D}C.extend(p,{showMax:false,showToggle:false,showMin:false});return C.ligerDialog(p)};C.ligerDialog.confirm=function(G,F,D){if(typeof(F)=="function"){D=F;type=null}var E=function(I,H){H.close();if(D){D(I.type=="ok")}};p={type:"question",content:G,buttons:[{text:C.ligerDefaults.DialogString.yes,onclick:E,type:"ok"},{text:C.ligerDefaults.DialogString.no,onclick:E,type:"no"}]};if(typeof(F)=="string"&&F!=""){p.title=F}C.extend(p,{showMax:false,showToggle:false,showMin:false});return C.ligerDialog(p)};C.ligerDialog.warning=function(G,F,D){if(typeof(F)=="function"){D=F;type=null}var E=function(I,H){H.close();if(D){D(I.type)}};p={type:"question",content:G,buttons:[{text:C.ligerDefaults.DialogString.yes,onclick:E,type:"yes"},{text:C.ligerDefaults.DialogString.no,onclick:E,type:"no"},{text:C.ligerDefaults.DialogString.cancel,onclick:E,type:"cancel"}]};if(typeof(F)=="string"&&F!=""){p.title=F}C.extend(p,{showMax:false,showToggle:false,showMin:false});return C.ligerDialog(p)};C.ligerDialog.waitting=function(D){D=D||C.ligerDefaults.Dialog.waittingMessage;return C.ligerDialog.open({cls:"l-dialog-waittingdialog",type:"none",content:'<div style="padding:4px">'+D+"</div>",allowClose:false})};C.ligerDialog.closeWaitting=function(){var E=A.find(A.controls.Dialog);for(var D in E){var F=E[D];if(F.dialog.hasClass("l-dialog-waittingdialog")){F.close()}}};C.ligerDialog.success=function(F,E,D){return C.ligerDialog.alert(F,E,"success",D)};C.ligerDialog.error=function(F,E,D){return C.ligerDialog.alert(F,E,"error",D)};C.ligerDialog.warn=function(F,E,D){return C.ligerDialog.alert(F,E,"warn",D)};C.ligerDialog.question=function(E,D){return C.ligerDialog.alert(E,D,"question")};C.ligerDialog.prompt=function(G,H,I,D){var F=C('<input type="text" class="l-dialog-inputtext"/>');if(typeof(I)=="function"){D=I}if(typeof(H)=="function"){D=H}else{if(typeof(H)=="boolean"){I=H}}if(typeof(I)=="boolean"&&I){F=C('<textarea class="l-dialog-textarea"></textarea>')}if(typeof(H)=="string"||typeof(H)=="int"){F.val(H)}var E=function(K,J,L){J.close();if(D){D(K.type=="yes",F.val())}};p={title:G,target:F,width:320,buttons:[{text:C.ligerDefaults.DialogString.ok,onclick:E,type:"yes"},{text:C.ligerDefaults.DialogString.cancel,onclick:E,type:"cancel"}]};return C.ligerDialog(p)}})(jQuery);(function(B){var A=B.ligerui;B.fn.ligerDrag=function(C){return A.run.call(this,"ligerDrag",arguments,{idAttrName:"ligeruidragid",hasElement:false,propertyToElemnt:"target"})};B.fn.ligerGetDragManager=function(){return A.run.call(this,"ligerGetDragManager",arguments,{idAttrName:"ligeruidragid",hasElement:false,propertyToElemnt:"target"})};B.ligerDefaults.Drag={onStartDrag:false,onDrag:false,onStopDrag:false,handler:null,proxy:true,revert:false,animate:true,onRevert:null,onEndRevert:null,receive:null,onDragEnter:null,onDragOver:null,onDragLeave:null,onDrop:null,disabled:false,proxyX:null,proxyY:null};A.controls.Drag=function(C){A.controls.Drag.base.constructor.call(this,null,C)};A.controls.Drag.ligerExtend(A.core.UIComponent,{__getType:function(){return"Drag"},__idPrev:function(){return"Drag"},_render:function(){var C=this,D=this.options;this.set(D);C.cursor="move";C.handler.css("cursor",C.cursor);C.handler.bind("mousedown.drag",function(E){if(D.disabled){return}if(E.button==2){return}C._start.call(C,E)}).bind("mousemove.drag",function(){if(D.disabled){return}C.handler.css("cursor",C.cursor)})},_rendered:function(){this.options.target.ligeruidragid=this.id},_start:function(D){var C=this,E=this.options;if(C.reverting){return}if(E.disabled){return}C.current={target:C.target,left:C.target.offset().left,top:C.target.offset().top,startX:D.pageX||D.screenX,startY:D.pageY||D.clientY};if(C.trigger("startDrag",[C.current,D])==false){return false}C.cursor="move";C._createProxy(E.proxy,D);if(E.proxy&&!C.proxy){return false}(C.proxy||C.handler).css("cursor",C.cursor);B(document).bind("selectstart.drag",function(){return false});B(document).bind("mousemove.drag",function(){C._drag.apply(C,arguments)});A.draggable.dragging=true;B(document).bind("mouseup.drag",function(){A.draggable.dragging=false;C._stop.apply(C,arguments)})},_drag:function(D){var C=this,E=this.options;if(!C.current){return}var G=D.pageX||D.screenX;var F=D.pageY||D.screenY;C.current.diffX=G-C.current.startX;C.current.diffY=F-C.current.startY;(C.proxy||C.handler).css("cursor",C.cursor);if(C.receive){C.receive.each(function(I,J){var K=B(J);var H=K.offset();if(G>H.left&&G<H.left+K.width()&&F>H.top&&F<H.top+K.height()){if(!C.receiveEntered[I]){C.receiveEntered[I]=true;C.trigger("dragEnter",[J,C.proxy||C.target,D])}else{C.trigger("dragOver",[J,C.proxy||C.target,D])}}else{if(C.receiveEntered[I]){C.receiveEntered[I]=false;C.trigger("dragLeave",[J,C.proxy||C.target,D])}}})}if(C.hasBind("drag")){if(C.trigger("drag",[C.current,D])!=false){C._applyDrag()}else{C._removeProxy()}}else{C._applyDrag()}},_stop:function(D){var C=this,E=this.options;B(document).unbind("mousemove.drag");B(document).unbind("mouseup.drag");B(document).unbind("selectstart.drag");if(C.receive){C.receive.each(function(F,G){if(C.receiveEntered[F]){C.trigger("drop",[G,C.proxy||C.target,D])}})}if(C.proxy){if(E.revert){if(C.hasBind("revert")){if(C.trigger("revert",[C.current,D])!=false){C._revert(D)}else{C._removeProxy()}}else{C._revert(D)}}else{C._applyDrag(C.target);C._removeProxy()}}C.cursor="move";C.trigger("stopDrag",[C.current,D]);C.current=null;C.handler.css("cursor",C.cursor)},_revert:function(D){var C=this;C.reverting=true;C.proxy.animate({left:C.current.left,top:C.current.top},function(){C.reverting=false;C._removeProxy();C.trigger("endRevert",[C.current,D]);C.current=null})},_applyDrag:function(G){var C=this,D=this.options;G=G||C.proxy||C.target;var E={},H=false;var F=G==C.target;if(C.current.diffX){if(F||D.proxyX==null){E.left=C.current.left+C.current.diffX}else{E.left=C.current.startX+D.proxyX+C.current.diffX}H=true}if(C.current.diffY){if(F||D.proxyY==null){E.top=C.current.top+C.current.diffY}else{E.top=C.current.startY+D.proxyY+C.current.diffY}H=true}if(G==C.target&&C.proxy&&D.animate){C.reverting=true;G.animate(E,function(){C.reverting=false})}else{G.css(E)}},_setReceive:function(C){this.receiveEntered={};if(!C){return}if(typeof C=="string"){this.receive=B(C)}else{this.receive=C}},_setHandler:function(E){var C=this,D=this.options;if(!E){C.handler=B(D.target)}else{C.handler=(typeof E=="string"?B(E,D.target):E)}},_setTarget:function(C){this.target=B(C)},_setCursor:function(C){this.cursor=C;(this.proxy||this.handler).css("cursor",C)},_createProxy:function(F,D){if(!F){return}var C=this,E=this.options;if(typeof F=="function"){C.proxy=F.call(this.options.target,C,D)}else{if(F=="clone"){C.proxy=C.target.clone().css("position","absolute");C.proxy.appendTo("body")}else{C.proxy=B("<div class='l-draggable'></div>");C.proxy.width(C.target.width()).height(C.target.height());C.proxy.attr("dragid",C.id).appendTo("body")}}C.proxy.css({left:E.proxyX==null?C.current.left:C.current.startX+E.proxyX,top:E.proxyY==null?C.current.top:C.current.startY+E.proxyY}).show()},_removeProxy:function(){var C=this;if(C.proxy){C.proxy.remove();C.proxy=null}}})})(jQuery);(function(A){A.fn.ligerEasyTab=function(){return A.ligerui.run.call(this,"ligerEasyTab",arguments)};A.fn.ligerGetEasyTabManager=function(){return A.ligerui.run.call(this,"ligerGetEasyTabManager",arguments)};A.ligerDefaults.EasyTab={};A.ligerMethos.EasyTab={};A.ligerui.controls.EasyTab=function(C,B){A.ligerui.controls.EasyTab.base.constructor.call(this,C,B)};A.ligerui.controls.EasyTab.ligerExtend(A.ligerui.core.UIComponent,{__getType:function(){return"EasyTab"},__idPrev:function(){return"EasyTab"},_extendMethods:function(){return A.ligerMethos.EasyTab},_render:function(){var B=this,C=this.options;B.tabs=A(this.element);B.tabs.addClass("l-easytab");var D=0;if(A("> div[lselected=true]",B.tabs).length>0){D=A("> div",B.tabs).index(A("> div[lselected=true]",B.tabs))}B.tabs.ul=A('<ul class="l-easytab-header"></ul>');A("> div",B.tabs).each(function(E,F){var G=A("<li><span></span></li>");if(E==D){A("span",G).addClass("l-selected")}if(A(F).attr("title")){A("span",G).html(A(F).attr("title"))}B.tabs.ul.append(G);if(!A(F).hasClass("l-easytab-panelbox")){A(F).addClass("l-easytab-panelbox")}});B.tabs.ul.prependTo(B.tabs);A(".l-easytab-panelbox:eq("+D+")",B.tabs).show().siblings(".l-easytab-panelbox").hide();A("> ul:first span",B.tabs).click(function(){if(A(this).hasClass("l-selected")){return}var E=A("> ul:first span",B.tabs).index(this);A(this).addClass("l-selected").parent().siblings().find("span.l-selected").removeClass("l-selected");A(".l-easytab-panelbox:eq("+E+")",B.tabs).show().siblings(".l-easytab-panelbox").hide()}).not("l-selected").hover(function(){A(this).addClass("l-over")},function(){A(this).removeClass("l-over")});B.set(C)}})})(jQuery);(function(A){A.fn.ligerFilter=function(){return A.ligerui.run.call(this,"ligerFilter",arguments)};A.fn.ligerGetFilterManager=function(){return A.ligerui.run.call(this,"ligerGetFilterManager",arguments)};A.ligerDefaults.Filter={fields:[],operators:{},editors:{}};A.ligerDefaults.FilterString={strings:{"and":"并且","or":"或者","equal":"相等","notequal":"不相等","startwith":"以..开始","endwith":"以..结束","like":"相似","greater":"大于","greaterorequal":"大于或等于","less":"小于","lessorequal":"小于或等于","in":"包括在...","notin":"不包括...","addgroup":"增加分组","addrule":"增加条件","deletegroup":"删除分组"}};A.ligerDefaults.Filter.operators["string"]=A.ligerDefaults.Filter.operators["text"]=["equal","notequal","startwith","endwith","like","greater","greaterorequal","less","lessorequal","in","notin"];A.ligerDefaults.Filter.operators["number"]=A.ligerDefaults.Filter.operators["int"]=A.ligerDefaults.Filter.operators["float"]=A.ligerDefaults.Filter.operators["date"]=["equal","notequal","greater","greaterorequal","less","lessorequal","in","notin"];A.ligerDefaults.Filter.editors["string"]={create:function(B,D){var C=A("<input type='text'/>");B.append(C);C.ligerTextBox(D.editor.options||{});return C},setValue:function(B,C){B.val(C)},getValue:function(B){return B.liger("option","value")},destroy:function(B){B.liger("destroy")}};A.ligerDefaults.Filter.editors["date"]={create:function(B,D){var C=A("<input type='text'/>");B.append(C);C.ligerDateEditor(D.editor.options||{});return C},setValue:function(B,C){B.liger("option","value",C)},getValue:function(B,C){return B.liger("option","value")},destroy:function(B){B.liger("destroy")}};A.ligerDefaults.Filter.editors["number"]={create:function(C,E){var D=A("<input type='text'/>");C.append(D);var B={minValue:E.editor.minValue,maxValue:E.editor.maxValue};D.ligerSpinner(A.extend(B,E.editor.options||{}));return D},setValue:function(B,C){B.val(C)},getValue:function(B,C){var D=C.editor.type=="int";if(D){return parseInt(B.val(),10)}else{return parseFloat(B.val())}},destroy:function(B){B.liger("destroy")}};A.ligerDefaults.Filter.editors["combobox"]={create:function(C,E){var D=A("<input type='text'/>");C.append(D);var B={data:E.data,slide:false,valueField:E.editor.valueField||E.editor.valueColumnName,textField:E.editor.textField||E.editor.displayColumnName};A.extend(B,E.editor.options||{});D.ligerComboBox(B);return D},setValue:function(B,C){B.liger("option","value",C)},getValue:function(B){return B.liger("option","value")},destroy:function(B){B.liger("destroy")}};A.ligerui.controls.Filter=function(C,B){A.ligerui.controls.Filter.base.constructor.call(this,C,B)};A.ligerui.controls.Filter.ligerExtend(A.ligerui.core.UIComponent,{__getType:function(){return"Filter"},__idPrev:function(){return"Filter"},_init:function(){A.ligerui.controls.Filter.base._init.call(this)},_render:function(){var B=this,C=this.options;B.set(C);A("#"+B.id+" .addgroup").live("click",function(){var D=A(this).parent().parent().parent().parent();B.addGroup(D)});A("#"+B.id+" .deletegroup").live("click",function(){var D=A(this).parent().parent().parent().parent();B.deleteGroup(D)});A("#"+B.id+" .addrule").live("click",function(){var D=A(this).parent().parent().parent().parent();B.addRule(D)});A("#"+B.id+" .deleterole").live("click",function(){var D=A(this).parent().parent();B.deleteRule(D)})},_setFields:function(D){var B=this,C=this.options;if(B.group){B.group.remove()}B.group=A(B._bulidGroupTableHtml()).appendTo(B.element)},editors:{},editorCounter:0,addGroup:function(H){var B=this,E=this.options;H=A(H||B.group);var G=A(">tbody:first > tr:last",H);var D=[];D.push('<tr class="l-filter-rowgroup"><td class="l-filter-cellgroup" colSpan="4">');var C=!H.hasClass("l-filter-group-alt");D.push(B._bulidGroupTableHtml(C,true));D.push("</td></tr>");var F=A(D.join(""));G.before(F);return F.find("table:first")},deleteGroup:function(C){var B=this,D=this.options;A("td.l-filter-value",C).each(function(){var E=A(this).parent();A("select.fieldsel",E).unbind();B.removeEditor(E)});A(C).parent().parent().remove()},removeEditor:function(E){var B=this,C=this.options;var F=A(E).attr("editortype");var G=A(E).attr("editorid");var D=B.editors[G];if(D){C.editors[F].destroy(D)}A("td.l-filter-value:first",E).html("")},setData:function(C,F){var B=this,D=this.options;F=F||B.group;var E=A(">tbody:first > tr:last",F);F.find(">tbody:first > tr").not(E).remove();A("select:first",E).val(C.op);if(C.rules){A(C.rules).each(function(){var H=B.addRule(F);H.attr("fieldtype",this.type||"string");A("select.opsel",H).val(this.op);A("select.fieldsel",H).val(this.field).trigger("change");var G=H.attr("editorid");if(G&&B.editors[G]){var I=B.getField(this.field);D.editors[I.editor.type].setValue(B.editors[G],this.value,I)}else{A(":text",H).val(this.value)}})}if(C.groups){A(C.groups).each(function(){var G=B.addGroup(F);B.setData(this,G)})}},addRule:function(E){var B=this,C=this.options;E=E||B.group;var D=A(">tbody:first > tr:last",E);var F=A(B._bulidRuleRowHtml());D.before(F);if(C.fields.length){B.appendEditor(F,C.fields[0])}A("select.fieldsel",F).bind("change",function(){var L=A(this).parent().next().find("select:first");var J=A(this).val();var K=B.getField(J);var I=K.type||"string";var M=F.attr("fieldtype");if(I!=M){L.html(B._bulidOpSelectOptionsHtml(I));F.attr("fieldtype",I)}var G=null;var H=F.attr("editortype");if(B.enabledEditor(K)){G=K.editor.type}if(H){B.removeEditor(F)}if(G){B.appendEditor(F,K)}else{F.removeAttr("editortype").removeAttr("editorid");A("td.l-filter-value:first",F).html('<input type="text" class="valtxt" />')}});return F},deleteRule:function(B){A("select.fieldsel",B).unbind();this.removeEditor(B);A(B).remove()},appendEditor:function(F,G){var B=this,C=this.options;if(B.enabledEditor(G)){var E=A("td.l-filter-value:first",F).html("");var D=C.editors[G.editor.type];B.editors[++B.editorCounter]=D.create(E,G);F.attr("editortype",G.editor.type).attr("editorid",B.editorCounter)}},getData:function(C){var B=this,D=this.options;C=C||B.group;var E={};A("> tbody > tr",C).each(function(K,L){var F=A(L).hasClass("l-filter-rowlast");var O=A(L).hasClass("l-filter-rowgroup");if(O){var G=A("> td:first > table:first",L);if(G.length){if(!E.groups){E.groups=[]}E.groups.push(B.getData(G))}}else{if(F){E.op=A(".groupopsel:first",L).val()}else{var H=A("select.fieldsel:first",L).val();var M=B.getField(H);var N=A(".opsel:first",L).val();var J=B._getRuleValue(L,M);var I=A(L).attr("fieldtype")||"string";if(!E.rules){E.rules=[]}E.rules.push({field:H,op:N,value:J,type:I})}}});return E},_getRuleValue:function(G,H){var B=this,D=this.options;var E=A(G).attr("editorid");var C=A(G).attr("editortype");var F=B.editors[E];if(F){return D.editors[C].getValue(F,H)}return A(".valtxt:first",G).val()},enabledEditor:function(D){var B=this,C=this.options;if(!D.editor||!D.editor.type){return false}return(D.editor.type in C.editors)},getField:function(G){var B=this,D=this.options;for(var C=0,E=D.fields.length;C<E;C++){var F=D.fields[C];if(F.name==G){return F}}return null},_bulidGroupTableHtml:function(B,D){var C=this,E=this.options;var F=[];F.push('<table cellpadding="0" cellspacing="0" border="0" class="l-filter-group');if(B){F.push(" l-filter-group-alt")}F.push('"><tbody>');F.push('<tr class="l-filter-rowlast"><td class="l-filter-rowlastcell" align="right" colSpan="4">');F.push('<select class="groupopsel">');F.push('<option value="and">'+E.strings["and"]+"</option>");F.push('<option value="or">'+E.strings["or"]+"</option>");F.push("</select>");F.push('<input type="button" value="'+E.strings["addgroup"]+'" class="addgroup">');F.push('<input type="button" value="'+E.strings["addrule"]+'" class="addrule">');if(D){F.push('<input type="button" value="'+E.strings["deletegroup"]+'" class="deletegroup">')}F.push("</td></tr>");F.push("</tbody></table>");return F.join("")},_bulidRuleRowHtml:function(H){var I=this,C=this.options;H=H||C.fields;var E=[];var D=H[0].type||"string";E.push('<tr fieldtype="'+D+'"><td class="l-filter-column">');E.push('<select class="fieldsel">');for(var G=0,F=H.length;G<F;G++){var B=H[G];E.push('<option value="'+B.name+'"');if(G==0){E.push(" selected ")}E.push(">");E.push(B.display);E.push("</option>")}E.push("</select>");E.push("</td>");E.push('<td class="l-filter-op">');E.push('<select class="opsel">');E.push(I._bulidOpSelectOptionsHtml(D));E.push("</select>");E.push("</td>");E.push('<td class="l-filter-value">');E.push('<input type="text" class="valtxt" />');E.push("</td>");E.push("<td>");E.push('<div class="l-icon-cross deleterole"></div>');E.push("</td>");E.push("</tr>");return E.join("")},_bulidOpSelectOptionsHtml:function(E){var C=this,B=this.options;var D=B.operators[E];var I=[];for(var G=0,F=D.length;G<F;G++){var H=D[G];I[I.length]='<option value="'+H+'">';I[I.length]=B.strings[H];I[I.length]="</option>"}return I.join("")}})})(jQuery);(function(A){A.fn.ligerForm=function(){return A.ligerui.run.call(this,"ligerForm",arguments)};A.ligerDefaults=A.ligerDefaults||{};A.ligerDefaults.Form={inputWidth:180,labelWidth:90,space:40,rightToken:"：",labelAlign:"left",align:"left",fields:[],appendID:true,prefixID:"",toJSON:A.ligerui.toJSON};A.ligerDefaults.Form.editorBulider=function(F){var B=this,D=this.options;var C={};if(D.inputWidth){C.width=D.inputWidth}if(F.is("select")){F.ligerComboBox(C)}else{if(F.is(":text")||F.is(":password")){var E=F.attr("ltype");switch(E){case"select":case"combobox":F.ligerComboBox(C);break;case"spinner":F.ligerSpinner(C);break;case"date":F.ligerDateEditor(C);break;case"float":case"number":C.number=true;F.ligerTextBox(C);break;case"int":case"digits":C.digits=true;default:F.ligerTextBox(C);break}}else{if(F.is(":radio")){F.ligerRadio(C)}else{if(F.is(":checkbox")){F.ligerCheckBox(C)}else{if(F.is("textarea")){F.addClass("l-textarea")}}}}}};A.ligerui.controls.Form=function(C,B){A.ligerui.controls.Form.base.constructor.call(this,C,B)};A.ligerui.controls.Form.ligerExtend(A.ligerui.core.UIComponent,{__getType:function(){return"Form"},__idPrev:function(){return"Form"},_init:function(){A.ligerui.controls.Form.base._init.call(this)},_render:function(){var B=this,D=this.options;var F=A(this.element);if(D.fields&&D.fields.length){if(!F.hasClass("l-form")){F.addClass("l-form")}var E=[];var C=false;A(D.fields).each(function(I,J){var H=J.name||J.id;if(!H){return}if(J.type=="hidden"){E.push('<input type="hidden" id="'+H+'" name="'+H+'" />');return}var G=J.renderToNewLine||J.newline;if(G==null){G=true}if(J.merge){G=false}if(J.group){G=true}if(G){if(C){E.push("</ul>");C=false}if(J.group){E.push('<div class="l-group');if(J.groupicon){E.push(" l-group-hasicon")}E.push('">');if(J.groupicon){E.push('<img src="'+J.groupicon+'" />')}E.push("<span>"+J.group+"</span></div>")}E.push("<ul>");C=true}E.push(B._buliderLabelContainer(J));E.push(B._buliderControlContainer(J));E.push(B._buliderSpaceContainer(J))});if(C){E.push("</ul>");C=false}F.append(E.join(""))}A("input,select,textarea",F).each(function(){D.editorBulider.call(B,A(this))})},_buliderLabelContainer:function(G){var B=this,C=this.options;var H=G.label||G.display;var D=G.labelWidth||G.labelwidth||C.labelWidth;var F=G.labelAlign||C.labelAlign;if(H){H+=C.rightToken}var E=[];E.push('<li style="');if(D){E.push("width:"+D+"px;")}if(F){E.push("text-align:"+F+";")}E.push('">');if(H){E.push(H)}E.push("</li>");return E.join("")},_buliderControlContainer:function(F){var B=this,C=this.options;var G=F.width||C.inputWidth;var D=F.align||F.textAlign||F.textalign||C.align;var E=[];E.push('<li style="');if(G){E.push("width:"+G+"px;")}if(D){E.push("text-align:"+D+";")}E.push('">');E.push(B._buliderControl(F));E.push("</li>");return E.join("")},_buliderSpaceContainer:function(F){var B=this,C=this.options;var E=F.space||F.spaceWidth||C.space;var D=[];D.push('<li style="');if(E){D.push("width:"+E+"px;")}D.push('">');D.push("</li>");return D.join("")},_buliderControl:function(F){var I=this,C=this.options;var G=F.width||C.inputWidth;var D=F.name||F.id;var B=[];if(F.comboboxName&&F.type=="select"){B.push('<input type="hidden" id="'+C.prefixID+D+'" name="'+D+'" />')}if(F.textarea||F.type=="textarea"){B.push("<textarea ")}else{if(F.type=="checkbox"){B.push('<input type="checkbox" ')}else{if(F.type=="radio"){B.push('<input type="radio" ')}else{if(F.type=="password"){B.push('<input type="password" ')}else{B.push('<input type="text" ')}}}}if(F.cssClass){B.push('class="'+F.cssClass+'" ')}if(F.type){B.push('ltype="'+F.type+'" ')}if(F.attr){for(var E in F.attr){B.push(E+'="'+F.attr[E]+'" ')}}if(F.comboboxName&&F.type=="select"){B.push('name="'+F.comboboxName+'"');if(C.appendID){B.push(' id="'+C.prefixID+F.comboboxName+'" ')}}else{B.push('name="'+D+'"');if(C.appendID){B.push(' id="'+D+'" ')}}var H=A.extend({width:G-2},F.options||{});B.push(" ligerui='"+C.toJSON(H)+"' ");if(F.validate){B.push(" validate='"+C.toJSON(F.validate)+"' ")}B.push(" />");return B.join("")}})})(jQuery);(function($){var l=$.ligerui;$.fn.ligerGrid=function(options){return $.ligerui.run.call(this,"ligerGrid",arguments)};$.fn.ligerGetGridManager=function(){return $.ligerui.run.call(this,"ligerGetGridManager",arguments)};$.ligerDefaults.Grid={title:null,width:"auto",height:"auto",columnWidth:null,resizable:true,url:false,usePager:true,page:1,pageSize:10,pageSizeOptions:[10,20,30,40,50],parms:[],columns:[],minColToggle:1,dataType:"server",dataAction:"server",showTableToggleBtn:false,switchPageSizeApplyComboBox:false,allowAdjustColWidth:true,checkbox:false,allowHideColumn:true,enabledEdit:false,isScroll:true,onDragCol:null,onToggleCol:null,onChangeSort:null,onSuccess:null,onDblClickRow:null,onSelectRow:null,onUnSelectRow:null,onBeforeCheckRow:null,onCheckRow:null,onBeforeCheckAllRow:null,onCheckAllRow:null,onBeforeShowData:null,onAfterShowData:null,onError:null,onSubmit:null,dateFormat:"yyyy-MM-dd",InWindow:true,statusName:"__status",method:"post",async:true,fixedCellHeight:true,heightDiff:0,cssClass:null,root:"Rows",record:"Total",pageParmName:"page",pagesizeParmName:"pagesize",sortnameParmName:"sortname",sortorderParmName:"sortorder",onReload:null,onToFirst:null,onToPrev:null,onToNext:null,onToLast:null,allowUnSelectRow:false,alternatingRow:true,mouseoverRowCssClass:"l-grid-row-over",enabledSort:true,rowAttrRender:null,groupColumnName:null,groupColumnDisplay:"分组",groupRender:null,totalRender:null,delayLoad:false,where:null,selectRowButtonOnly:false,onAfterAddRow:null,onBeforeEdit:null,onBeforeSubmitEdit:null,onAfterEdit:null,onLoading:null,onLoaded:null,onContextmenu:null,whenRClickToSelect:false,contentType:null,checkboxColWidth:27,detailColWidth:29,clickToEdit:true,detailToEdit:false,onEndEdit:null,minColumnWidth:80,tree:null,isChecked:null,frozen:true,frozenDetail:false,frozenCheckbox:true,detailHeight:260,rownumbers:false,frozenRownumbers:true,rownumbersColWidth:26,colDraggable:false,rowDraggable:false,rowDraggingRender:null,autoCheckChildren:true,onRowDragDrop:null,rowHeight:22,headerRowHeight:23,toolbar:null,headerImg:null};$.ligerDefaults.GridString={errorMessage:"发生错误",pageStatMessage:"显示从{from}到{to}，总 {total} 条 。每页显示：{pagesize}",pageTextMessage:"Page",loadingMessage:"加载中...",findTextMessage:"查找",noRecordMessage:"没有符合条件的记录存在",isContinueByDataChanged:"数据已经改变,如果继续将丢失数据,是否继续?",cancelMessage:"取消",saveMessage:"保存",applyMessage:"应用",draggingMessage:"{count}行"};$.ligerMethos.Grid=$.ligerMethos.Grid||{};$.ligerDefaults.Grid.sorters=$.ligerDefaults.Grid.sorters||{};$.ligerDefaults.Grid.formatters=$.ligerDefaults.Grid.formatters||{};$.ligerDefaults.Grid.editors=$.ligerDefaults.Grid.editors||{};$.ligerDefaults.Grid.sorters["date"]=function(val1,val2){return val1<val2?-1:val1>val2?1:0};$.ligerDefaults.Grid.sorters["int"]=function(val1,val2){return parseInt(val1)<parseInt(val2)?-1:parseInt(val1)>parseInt(val2)?1:0};$.ligerDefaults.Grid.sorters["float"]=function(val1,val2){return parseFloat(val1)<parseFloat(val2)?-1:parseFloat(val1)>parseFloat(val2)?1:0};$.ligerDefaults.Grid.sorters["string"]=function(val1,val2){return val1.localeCompare(val2)};$.ligerDefaults.Grid.formatters["date"]=function(value,column){function getFormatDate(date,dateformat){var g=this,p=this.options;if(isNaN(date)){return null}var format=dateformat;var o={"M+":date.getMonth()+1,"d+":date.getDate(),"h+":date.getHours(),"m+":date.getMinutes(),"s+":date.getSeconds(),"q+":Math.floor((date.getMonth()+3)/3),"S":date.getMilliseconds()};if(/(y+)/.test(format)){format=format.replace(RegExp.$1,(date.getFullYear()+"").substr(4-RegExp.$1.length))}for(var k in o){if(new RegExp("("+k+")").test(format)){format=format.replace(RegExp.$1,RegExp.$1.length==1?o[k]:("00"+o[k]).substr((""+o[k]).length))}}return format}if(!value){return""}if(typeof(value)=="string"&&/^\/Date/.test(value)){value=value.replace(/^\//,"new ").replace(/\/$/,"");eval("value = "+value)}if(value instanceof Date){var format=column.format||this.options.dateFormat||"yyyy-MM-dd";return getFormatDate(value,format)}else{return value.toString()}};$.ligerDefaults.Grid.editors["date"]={create:function(container,editParm){var column=editParm.column;var input=$("<input type='text'/>");container.append(input);var options={};var ext=column.editor.p||column.editor.ext;if(ext){var tmp=typeof(ext)=="function"?ext(editParm.record,editParm.rowindex,editParm.value,column):ext;$.extend(options,tmp)}input.ligerDateEditor(options);return input},getValue:function(input,editParm){return input.liger("option","value")},setValue:function(input,value,editParm){input.liger("option","value",value)},resize:function(input,width,height,editParm){input.liger("option","width",width);input.liger("option","height",height)},destroy:function(input,editParm){input.liger("destroy")}};$.ligerDefaults.Grid.editors["select"]=$.ligerDefaults.Grid.editors["combobox"]={create:function(container,editParm){var column=editParm.column;var input=$("<input type='text'/>");container.append(input);var options={data:column.editor.data,slide:false,valueField:column.editor.valueField||column.editor.valueColumnName,textField:column.editor.textField||column.editor.displayColumnName};var ext=column.editor.p||column.editor.ext;if(ext){var tmp=typeof(ext)=="function"?ext(editParm.record,editParm.rowindex,editParm.value,column):ext;$.extend(options,tmp)}input.ligerComboBox(options);return input},getValue:function(input,editParm){return input.liger("option","value")},setValue:function(input,value,editParm){input.liger("option","value",value)},resize:function(input,width,height,editParm){input.liger("option","width",width);input.liger("option","height",height)},destroy:function(input,editParm){input.liger("destroy")}};$.ligerDefaults.Grid.editors["int"]=$.ligerDefaults.Grid.editors["float"]=$.ligerDefaults.Grid.editors["spinner"]={create:function(container,editParm){var column=editParm.column;var input=$("<input type='text'/>");container.append(input);input.css({border:"#6E90BE"});var options={type:column.editor.type=="float"?"float":"int"};if(column.editor.minValue!=undefined){options.minValue=column.editor.minValue}if(column.editor.maxValue!=undefined){options.maxValue=column.editor.maxValue}input.ligerSpinner(options);return input},getValue:function(input,editParm){var column=editParm.column;var isInt=column.editor.type=="int";if(isInt){return parseInt(input.val(),10)}else{return parseFloat(input.val())}},setValue:function(input,value,editParm){input.val(value)},resize:function(input,width,height,editParm){input.liger("option","width",width);input.liger("option","height",height)},destroy:function(input,editParm){input.liger("destroy")}};$.ligerDefaults.Grid.editors["string"]=$.ligerDefaults.Grid.editors["text"]={create:function(container,editParm){var input=$("<input type='text' class='l-text-editing'/>");container.append(input);input.ligerTextBox();return input},getValue:function(input,editParm){return input.val()},setValue:function(input,value,editParm){input.val(value)},resize:function(input,width,height,editParm){input.liger("option","width",width);input.liger("option","height",height)},destroy:function(input,editParm){input.liger("destroy")}};$.ligerDefaults.Grid.editors["chk"]=$.ligerDefaults.Grid.editors["checkbox"]={create:function(container,editParm){var input=$("<input type='checkbox' />");container.append(input);input.ligerCheckBox();return input},getValue:function(input,editParm){return input[0].checked?1:0},setValue:function(input,value,editParm){input.val(value?true:false)},resize:function(input,width,height,editParm){input.liger("option","width",width);input.liger("option","height",height)},destroy:function(input,editParm){input.liger("destroy")}};$.ligerui.controls.Grid=function(element,options){$.ligerui.controls.Grid.base.constructor.call(this,element,options)};$.ligerui.controls.Grid.ligerExtend($.ligerui.core.UIComponent,{__getType:function(){return"$.ligerui.controls.Grid"},__idPrev:function(){return"grid"},_extendMethods:function(){return $.ligerMethos.Grid},_init:function(){$.ligerui.controls.Grid.base._init.call(this);var g=this,p=this.options;p.dataType=p.url?"server":"local";if(p.dataType=="local"){p.data=p.data||[];p.dataAction="local"}if(p.isScroll==false){p.height="auto"}if(!p.frozen){p.frozenCheckbox=false;p.frozenDetail=false;p.frozenRownumbers=false}if(p.detailToEdit){p.enabledEdit=true;p.clickToEdit=false;p.detail={height:"auto",onShowDetail:function(record,container,callback){$(container).addClass("l-grid-detailpanel-edit");g.beginEdit(record,function(rowdata,column){var editContainer=$("<div class='l-editbox'></div>");editContainer.width(120).height(p.rowHeight+1);editContainer.appendTo(container);return editContainer});function removeRow(){$(container).parent().parent().remove();g.collapseDetail(record)}$("<div class='l-clear'></div>").appendTo(container);$("<div class='l-button'>"+p.saveMessage+"</div>").appendTo(container).click(function(){g.endEdit(record);removeRow()});$("<div class='l-button'>"+p.applyMessage+"</div>").appendTo(container).click(function(){g.submitEdit(record)});$("<div class='l-button'>"+p.cancelMessage+"</div>").appendTo(container).click(function(){g.cancelEdit(record);removeRow()})}}}if(p.tree){p.tree.childrenName=p.tree.childrenName||"children";p.tree.isParent=p.tree.isParent||function(rowData){var exist=p.tree.childrenName in rowData;return exist};p.tree.isExtend=p.tree.isExtend||function(rowData){if("isextend" in rowData&&rowData["isextend"]==false){return false}return true}}},_render:function(){var g=this,p=this.options;g.grid=$(g.element);g.grid.addClass("l-panel");var gridhtmlarr=[];gridhtmlarr.push("        <div class='l-panel-header'><span class='l-panel-header-text'></span></div>");gridhtmlarr.push("                    <div class='l-grid-loading'></div>");gridhtmlarr.push("        <div class='l-panel-topbar'></div>");gridhtmlarr.push("        <div class='l-panel-bwarp'>");gridhtmlarr.push("            <div class='l-panel-body'>");gridhtmlarr.push("                <div class='l-grid'>");gridhtmlarr.push("                    <div class='l-grid-dragging-line'></div>");gridhtmlarr.push("                    <div class='l-grid-popup'><table cellpadding='0' cellspacing='0'><tbody></tbody></table></div>");gridhtmlarr.push("                  <div class='l-grid1'>");gridhtmlarr.push("                      <div class='l-grid-header l-grid-header1'>");gridhtmlarr.push("                          <div class='l-grid-header-inner'><table class='l-grid-header-table' cellpadding='0' cellspacing='0'><tbody></tbody></table></div>");gridhtmlarr.push("                      </div>");gridhtmlarr.push("                      <div class='l-grid-body l-grid-body1'>");gridhtmlarr.push("                      </div>");gridhtmlarr.push("                  </div>");gridhtmlarr.push("                  <div class='l-grid2'>");gridhtmlarr.push("                      <div class='l-grid-header l-grid-header2'>");gridhtmlarr.push("                          <div class='l-grid-header-inner'><table class='l-grid-header-table' cellpadding='0' cellspacing='0'><tbody></tbody></table></div>");gridhtmlarr.push("                      </div>");gridhtmlarr.push("                      <div class='l-grid-body l-grid-body2 l-scroll'>");gridhtmlarr.push("                      </div>");gridhtmlarr.push("                  </div>");gridhtmlarr.push("                 </div>");gridhtmlarr.push("              </div>");gridhtmlarr.push("         </div>");gridhtmlarr.push("         <div class='l-panel-bar'>");gridhtmlarr.push("            <div class='l-panel-bbar-inner'>");gridhtmlarr.push("                <div class='l-bar-group  l-bar-message'><span class='l-bar-text'></span></div>");gridhtmlarr.push("            <div class='l-bar-group l-bar-selectpagesize'></div>");gridhtmlarr.push("                <div class='l-bar-separator'></div>");gridhtmlarr.push("                <div class='l-bar-group'>");gridhtmlarr.push("                    <div class='l-bar-button l-bar-btnfirst'><span></span></div>");gridhtmlarr.push("                    <div class='l-bar-button l-bar-btnprev'><span></span></div>");gridhtmlarr.push("                </div>");gridhtmlarr.push("                <div class='l-bar-separator'></div>");gridhtmlarr.push("                <div class='l-bar-group'><span class='pcontrol'> <input type='text' size='4' value='1' style='width:20px' maxlength='10' /> / <span></span></span></div>");gridhtmlarr.push("                <div class='l-bar-separator'></div>");gridhtmlarr.push("                <div class='l-bar-group'>");gridhtmlarr.push("                     <div class='l-bar-button l-bar-btnnext'><span></span></div>");gridhtmlarr.push("                    <div class='l-bar-button l-bar-btnlast'><span></span></div>");gridhtmlarr.push("                </div>");gridhtmlarr.push("                <div class='l-bar-separator'></div>");gridhtmlarr.push("                <div class='l-bar-group'>");gridhtmlarr.push("                     <div class='l-bar-button l-bar-btnload'><span></span></div>");gridhtmlarr.push("                </div>");gridhtmlarr.push("                <div class='l-bar-separator'></div>");gridhtmlarr.push("                <div class='l-clear'></div>");gridhtmlarr.push("            </div>");gridhtmlarr.push("         </div>");g.grid.html(gridhtmlarr.join(""));g.header=$(".l-panel-header:first",g.grid);g.body=$(".l-panel-body:first",g.grid);g.toolbar=$(".l-panel-bar:first",g.grid);g.popup=$(".l-grid-popup:first",g.grid);g.gridloading=$(".l-grid-loading:first",g.grid);g.draggingline=$(".l-grid-dragging-line",g.grid);g.topbar=$(".l-panel-topbar:first",g.grid);g.gridview=$(".l-grid:first",g.grid);g.gridview.attr("id",g.id+"grid");g.gridview1=$(".l-grid1:first",g.gridview);g.gridview2=$(".l-grid2:first",g.gridview);g.gridheader=$(".l-grid-header:first",g.gridview2);g.gridbody=$(".l-grid-body:first",g.gridview2);g.f={};g.f.gridheader=$(".l-grid-header:first",g.gridview1);g.f.gridbody=$(".l-grid-body:first",g.gridview1);g.currentData=null;g.changedCells={};g.editors={};g.editor={editing:false};if(p.height=="auto"){g.bind("SysGridHeightChanged",function(){if(g.enabledFrozen()){g.gridview.height(Math.max(g.gridview1.height(),g.gridview2.height()))}})}var pc=$.extend({},p);this._bulid();this._setColumns(p.columns);delete pc["columns"];delete pc["data"];delete pc["url"];g.set(pc);if(!p.delayLoad){if(p.url){g.set({url:p.url})}else{if(p.data){g.set({data:p.data})}}}},_setFrozen:function(frozen){if(frozen){this.grid.addClass("l-frozen")}else{this.grid.removeClass("l-frozen")}},_setCssClass:function(value){this.grid.addClass(value)},_setLoadingMessage:function(value){this.gridloading.html(value)},_setHeight:function(h){var g=this,p=this.options;g.unbind("SysGridHeightChanged");if(h=="auto"){g.bind("SysGridHeightChanged",function(){if(g.enabledFrozen()){g.gridview.height(Math.max(g.gridview1.height(),g.gridview2.height()))}});return}if(typeof h=="string"&&h.indexOf("%")>0){if(p.inWindow){h=$(window).height()*parseFloat(h)*0.01}else{h=g.grid.parent().height()*parseFloat(h)*0.01}}if(p.title){h-=24}if(p.usePager){h-=32}if(p.totalRender){h-=25}if(p.toolbar){h-=g.topbar.outerHeight()}var gridHeaderHeight=p.headerRowHeight*(g._columnMaxLevel-1)+p.headerRowHeight-1;h-=gridHeaderHeight;if(h>0){g.gridbody.height(h);if(h>18){g.f.gridbody.height(h-18)}g.gridview.height(h+gridHeaderHeight)}},_updateFrozenWidth:function(){var g=this,p=this.options;if(g.enabledFrozen()){g.gridview1.width(g.f.gridtablewidth);var view2width=g.gridview.width()-g.f.gridtablewidth;g.gridview2.css({left:g.f.gridtablewidth});if(view2width>0){g.gridview2.css({width:view2width})}}},_setWidth:function(value){var g=this,p=this.options;if(g.enabledFrozen()){g._onResize()}},_setUrl:function(value){this.options.url=value;if(value){this.options.dataType="server";this.loadData(true)}else{this.options.dataType="local"}},_setData:function(value){this.loadData(this.options.data)},loadData:function(loadDataParm){var g=this,p=this.options;g.loading=true;var clause=null;var loadServer=true;if(typeof(loadDataParm)=="function"){clause=loadDataParm;loadServer=false}else{if(typeof(loadDataParm)=="boolean"){loadServer=loadDataParm}else{if(typeof(loadDataParm)=="object"&&loadDataParm){loadServer=false;p.dataType="local";p.data=loadDataParm}}}if(!p.newPage){p.newPage=1}if(p.dataAction=="server"){if(!p.sortOrder){p.sortOrder="asc"}}var param=[];if(p.parms){if(p.parms.length){$(p.parms).each(function(){param.push({name:this.name,value:this.value})})}else{if(typeof p.parms=="object"){for(var name in p.parms){param.push({name:name,value:p.parms[name]})}}}}if(p.dataAction=="server"){if(p.usePager){param.push({name:p.pageParmName,value:p.newPage});param.push({name:p.pagesizeParmName,value:p.pageSize})}if(p.sortName){param.push({name:p.sortnameParmName,value:p.sortName});param.push({name:p.sortorderParmName,value:p.sortOrder})}}$(".l-bar-btnload span",g.toolbar).addClass("l-disabled");if(p.dataType=="local"){g.filteredData=g.data=p.data;if(clause){g.filteredData[p.root]=g._searchData(g.filteredData[p.root],clause)}if(p.usePager){g.currentData=g._getCurrentPageData(g.filteredData)}else{g.currentData=g.filteredData}g._showData()}else{if(p.dataAction=="local"&&!loadServer){if(g.data&&g.data[p.root]){g.filteredData=g.data;if(clause){g.filteredData[p.root]=g._searchData(g.filteredData[p.root],clause)}g.currentData=g._getCurrentPageData(g.filteredData);g._showData()}}else{g.loadServerData(param,clause)}}g.loading=false},loadServerData:function(param,clause){var g=this,p=this.options;var ajaxOptions={type:p.method,url:p.url,data:param,async:p.async,dataType:"json",beforeSend:function(){if(g.hasBind("loading")){g.trigger("loading")}else{g.toggleLoading(true)}},success:function(data){g.trigger("success",[data,g]);if(!data||!data[p.root]||!data[p.root].length){g.currentData=g.data={};g.currentData[p.root]=g.data[p.root]=[];g.currentData[p.record]=g.data[p.record]=0;g._showData();return}g.data=data;if(p.dataAction=="server"){g.currentData=g.data}else{g.filteredData=g.data;if(clause){g.filteredData[p.root]=g._searchData(g.filteredData[p.root],clause)}if(p.usePager){g.currentData=g._getCurrentPageData(g.filteredData)}else{g.currentData=g.filteredData}}g._showData.ligerDefer(g,10,[g.currentData])},complete:function(){g.trigger("complete",[g]);if(g.hasBind("loaded")){g.trigger("loaded",[g])}else{g.toggleLoading.ligerDefer(g,10,[false])}},error:function(XMLHttpRequest,textStatus,errorThrown){g.currentData=g.data={};g.currentData[p.root]=g.data[p.root]=[];g.currentData[p.record]=g.data[p.record]=0;g.toggleLoading.ligerDefer(g,10,[false]);$(".l-bar-btnload span",g.toolbar).removeClass("l-disabled");g.trigger("error",[XMLHttpRequest,textStatus,errorThrown])}};if(p.contentType){ajaxOptions.contentType=p.contentType}$.ajax(ajaxOptions)},toggleLoading:function(show){this.gridloading[show?"show":"hide"]()},_createEditor:function(editor,container,editParm,width,height){var editorInput=editor.create(container,editParm);if(editor.setValue){editor.setValue(editorInput,editParm.value,editParm)}if(editor.resize){editor.resize(editorInput,width,height,editParm)}return editorInput},beginEdit:function(rowParm,containerBulider){var g=this,p=this.options;if(!p.enabledEdit||p.clickToEdit){return}var rowdata=g.getRow(rowParm);if(rowdata._editing){return}if(g.trigger("beginEdit",{record:rowdata,rowindex:rowdata["__index"]})==false){return}g.editors[rowdata["__id"]]={};rowdata._editing=true;g.reRender({rowdata:rowdata});containerBulider=containerBulider||function(rowdata,column){var cellobj=g.getCellObj(rowdata,column);var container=$(cellobj).html("");g.setCellEditing(rowdata,column,true);return container};for(var i=0,l=g.columns.length;i<l;i++){var column=g.columns[i];if(!column.name||!column.editor||!column.editor.type||!p.editors[column.editor.type]){continue}var editor=p.editors[column.editor.type];var editParm={record:rowdata,value:rowdata[column.name],column:column,rowindex:rowdata["__index"],grid:g};var container=containerBulider(rowdata,column);var width=container.width(),height=container.height();var editorInput=g._createEditor(editor,container,editParm,width,height);g.editors[rowdata["__id"]][column["__id"]]={editor:editor,input:editorInput,editParm:editParm,container:container}}g.trigger("afterBeginEdit",{record:rowdata,rowindex:rowdata["__index"]})},cancelEdit:function(rowParm){var g=this;if(rowParm==undefined){for(var rowid in g.editors){g.cancelEdit(rowid)}}else{var rowdata=g.getRow(rowParm);if(!g.editors[rowdata["__id"]]){return}if(g.trigger("cancelEdit",{record:rowdata,rowindex:rowdata["__index"]})==false){return}for(var columnid in g.editors[rowdata["__id"]]){var o=g.editors[rowdata["__id"]][columnid];if(o.editor.destroy){o.editor.destroy(o.input,o.editParm)}}delete g.editors[rowdata["__id"]];delete rowdata["_editing"];g.reRender({rowdata:rowdata})}},addEditRow:function(rowdata){this.submitEdit();rowdata=this.add(rowdata);this.beginEdit(rowdata)},submitEdit:function(rowParm){var g=this,p=this.options;if(rowParm==undefined){for(var rowid in g.editors){g.submitEdit(rowid)}}else{var rowdata=g.getRow(rowParm);var newdata={};if(!g.editors[rowdata["__id"]]){return}for(var columnid in g.editors[rowdata["__id"]]){var o=g.editors[rowdata["__id"]][columnid];var column=o.editParm.column;if(column.name){newdata[column.name]=o.editor.getValue(o.input,o.editParm)}}if(g.trigger("beforeSubmitEdit",{record:rowdata,rowindex:rowdata["__index"],newdata:newdata})==false){return false}g.updateRow(rowdata,newdata);g.trigger("afterSubmitEdit",{record:rowdata,rowindex:rowdata["__index"],newdata:newdata})}},endEdit:function(rowParm){var g=this,p=this.options;if(g.editor.editing){var o=g.editor;g.trigger("sysEndEdit",[g.editor.editParm]);g.trigger("endEdit",[g.editor.editParm]);if(o.editor.destroy){o.editor.destroy(o.input,o.editParm)}g.editor.container.remove();g.reRender({rowdata:g.editor.editParm.record,column:g.editor.editParm.column});g.trigger("afterEdit",[g.editor.editParm]);g.editor={editing:false}}else{if(rowParm!=undefined){var rowdata=g.getRow(rowParm);if(!g.editors[rowdata["__id"]]){return}if(g.submitEdit(rowParm)==false){return false}for(var columnid in g.editors[rowdata["__id"]]){var o=g.editors[rowdata["__id"]][columnid];if(o.editor.destroy){o.editor.destroy(o.input,o.editParm)}}delete g.editors[rowdata["__id"]];delete rowdata["_editing"];g.trigger("afterEdit",{record:rowdata,rowindex:rowdata["__index"]})}else{for(var rowid in g.editors){g.endEdit(rowid)}}}},setWidth:function(w){return this._setWidth(w)},setHeight:function(h){return this._setHeight(h)},enabledCheckbox:function(){return this.options.checkbox?true:false},enabledFrozen:function(){var g=this,p=this.options;if(!p.frozen){return false}var cols=g.columns||[];if(g.enabledDetail()&&p.frozenDetail||g.enabledCheckbox()&&p.frozenCheckbox||p.frozenRownumbers&&p.rownumbers){return true}for(var i=0,l=cols.length;i<l;i++){if(cols[i].frozen){return true}}this._setFrozen(false);return false},enabledDetailEdit:function(){if(!this.enabledDetail()){return false}return this.options.detailToEdit?true:false},enabledDetail:function(){if(this.options.detail&&this.options.detail.onShowDetail){return true}return false},enabledGroup:function(){return this.options.groupColumnName?true:false},deleteSelectedRow:function(){if(!this.selected){return}for(var i in this.selected){var o=this.selected[i];if(o["__id"] in this.records){this._deleteData.ligerDefer(this,10,[o])}}this.reRender.ligerDefer(this,20)},removeRange:function(rowArr){var g=this,p=this.options;$.each(rowArr,function(){g._removeData(this)});g.reRender()},remove:function(rowParm){var g=this,p=this.options;var rowdata=g.getRow(rowParm);g._removeData(rowParm);g.reRender()},deleteRange:function(rowArr){var g=this,p=this.options;$.each(rowArr,function(){g._deleteData(this)});g.reRender()},deleteRow:function(rowParm){var g=this,p=this.options;var rowdata=g.getRow(rowParm);if(!rowdata){return}g._deleteData(rowdata);g.reRender();g.isDataChanged=true},_deleteData:function(rowParm){var g=this,p=this.options;var rowdata=g.getRow(rowParm);rowdata[p.statusName]="delete";if(p.tree){var children=g.getChildren(rowdata,true);if(children){for(var i=0,l=children.length;i<l;i++){children[i][p.statusName]="delete"}}}g.deletedRows=g.deletedRows||[];g.deletedRows.push(rowdata);g._removeSelected(rowdata)},updateCell:function(arg,value,rowParm){var g=this,p=this.options;var column,cellObj,rowdata;if(typeof(arg)=="string"){for(var i=0,l=g.columns.length;i<l;i++){if(g.columns[i].name==arg){g.updateCell(i,value,rowParm)}}return}if(typeof(arg)=="number"){column=g.columns[arg];rowdata=g.getRow(rowParm);cellObj=g.getCellObj(rowdata,column)}else{if(typeof(arg)=="object"&&arg["__id"]){column=arg;rowdata=g.getRow(rowParm);cellObj=g.getCellObj(rowdata,column)}else{cellObj=arg;var ids=cellObj.id.split("|");var columnid=ids[ids.length-1];column=g._columns[columnid];var row=$(cellObj).parent();rowdata=rowdata||g.getRow(row[0])}}if(value!=null&&column.name){rowdata[column.name]=value;if(rowdata[p.statusName]!="add"){rowdata[p.statusName]="update"}g.isDataChanged=true}g.reRender({rowdata:rowdata,column:column})},addRows:function(rowdataArr,neardata,isBefore,parentRowData){var g=this,p=this.options;$(rowdataArr).each(function(){g.addRow(this,neardata,isBefore,parentRowData)})},_createRowid:function(){return"r"+(1000+this.recordNumber)},_isRowId:function(str){return(str in this.records)},_addNewRecord:function(o,previd,pid){var g=this,p=this.options;g.recordNumber++;o["__id"]=g._createRowid();o["__previd"]=previd;if(previd&&previd!=-1){var prev=g.records[previd];if(prev["__nextid"]&&prev["__nextid"]!=-1){var prevOldNext=g.records[prev["__nextid"]];if(prevOldNext){prevOldNext["__previd"]=o["__id"]}}prev["__nextid"]=o["__id"];o["__index"]=prev["__index"]+1}else{o["__index"]=0}if(p.tree){if(pid&&pid!=-1){var parent=g.records[pid];o["__pid"]=pid;o["__level"]=parent["__level"]+1}else{o["__pid"]=-1;o["__level"]=1}o["__hasChildren"]=o[p.tree.childrenName]?true:false}if(o[p.statusName]!="add"){o[p.statusName]="nochanged"}g.rows[o["__index"]]=o;g.records[o["__id"]]=o;return o},_getRows:function(data){var g=this,p=this.options;var targetData=[];function load(data){if(!data||!data.length){return}for(var i=0,l=data.length;i<l;i++){var o=data[i];targetData.push(o);if(o[p.tree.childrenName]){load(o[p.tree.childrenName])}}}load(data);return targetData},_updateGridData:function(){var g=this,p=this.options;g.recordNumber=0;g.rows=[];g.records={};var previd=-1;function load(data,pid){if(!data||!data.length){return}for(var i=0,l=data.length;i<l;i++){var o=data[i];g.formatRecord(o);if(o[p.statusName]=="delete"){continue}g._addNewRecord(o,previd,pid);previd=o["__id"];if(o["__hasChildren"]){load(o[p.tree.childrenName],o["__id"])}}}load(g.currentData[p.root],-1);return g.rows},_moveData:function(from,to,isAfter){var g=this,p=this.options;var fromRow=g.getRow(from);var toRow=g.getRow(to);var fromIndex,toIndex;var listdata=g._getParentChildren(fromRow);fromIndex=$.inArray(fromRow,listdata);listdata.splice(fromIndex,1);listdata=g._getParentChildren(toRow);toIndex=$.inArray(toRow,listdata);listdata.splice(toIndex+(isAfter?1:0),0,fromRow)},move:function(from,to,isAfter){this._moveData(from,to,isAfter);this.reRender()},moveRange:function(rows,to,isAfter){for(var i in rows){this._moveData(rows[i],to,isAfter)}this.reRender()},up:function(rowParm){var g=this,p=this.options;var rowdata=g.getRow(rowParm);var listdata=g._getParentChildren(rowdata);var index=$.inArray(rowdata,listdata);if(index==-1||index==0){return}var selected=g.getSelected();g.move(rowdata,listdata[index-1],false);g.select(selected)},down:function(rowParm){var g=this,p=this.options;var rowdata=g.getRow(rowParm);var listdata=g._getParentChildren(rowdata);var index=$.inArray(rowdata,listdata);if(index==-1||index==listdata.length-1){return}var selected=g.getSelected();g.move(rowdata,listdata[index+1],true);g.select(selected)},addRow:function(rowdata,neardata,isBefore,parentRowData){var g=this,p=this.options;rowdata=rowdata||{};g._addData(rowdata,parentRowData,neardata,isBefore);g.reRender();rowdata[p.statusName]="add";if(p.tree){var children=g.getChildren(rowdata,true);if(children){for(var i=0,l=children.length;i<l;i++){children[i][p.statusName]="add"}}}g.isDataChanged=true;p.total=p.total?(p.total+1):1;p.pageCount=Math.ceil(p.total/p.pageSize);g._buildPager();g.trigger("SysGridHeightChanged");g.trigger("afterAddRow",[rowdata]);return rowdata},updateRow:function(rowDom,newRowData){var g=this,p=this.options;var rowdata=g.getRow(rowDom);g.isDataChanged=true;$.extend(rowdata,newRowData||{});if(rowdata[p.statusName]!="add"){rowdata[p.statusName]="update"}g.reRender.ligerDefer(g,10,[{rowdata:rowdata}]);return rowdata},setCellEditing:function(rowdata,column,editing){var g=this,p=this.options;var cell=g.getCellObj(rowdata,column);var methodName=editing?"addClass":"removeClass";$(cell)[methodName]("l-grid-row-cell-editing");if(rowdata["__id"]!=0){var prevrowobj=$(g.getRowObj(rowdata["__id"])).prev();if(!prevrowobj.length){return}var prevrow=g.getRow(prevrowobj[0]);var cellprev=g.getCellObj(prevrow,column);if(!cellprev){return}$(cellprev)[methodName]("l-grid-row-cell-editing-topcell")}if(column["__previd"]!=-1&&column["__previd"]!=null){var cellprev=$(g.getCellObj(rowdata,column)).prev();$(cellprev)[methodName]("l-grid-row-cell-editing-leftcell")}},reRender:function(e){var g=this,p=this.options;e=e||{};var rowdata=e.rowdata,column=e.column;if(column&&(column.isdetail||column.ischeckbox)){return}if(rowdata&&rowdata[p.statusName]=="delete"){return}if(rowdata&&column){var cell=g.getCellObj(rowdata,column);$(cell).html(g._getCellHtml(rowdata,column));if(!column.issystem){g.setCellEditing(rowdata,column,false)}}else{if(rowdata){$(g.columns).each(function(){g.reRender({rowdata:rowdata,column:this})})}else{if(column){for(var rowid in g.records){g.reRender({rowdata:g.records[rowid],column:column})}for(var i=0;i<g.totalNumber;i++){var tobj=document.getElementById(g.id+"|total"+i+"|"+column["__id"]);$("div:first",tobj).html(g._getTotalCellContent(column,g.groups&&g.groups[i]?g.groups[i]:g.currentData[p.root]))}}else{g._showData()}}}},getData:function(status,removeStatus){var g=this,p=this.options;var data=[];for(var rowid in g.records){var o=$.extend(true,{},g.records[rowid]);if(o[p.statusName]==status||status==undefined){data.push(g.formatRecord(o,removeStatus))}}return data},formatRecord:function(o,removeStatus){delete o["__id"];delete o["__previd"];delete o["__nextid"];delete o["__index"];if(this.options.tree){delete o["__pid"];delete o["__level"];delete o["__hasChildren"]}if(removeStatus){delete o[this.options.statusName]}return o},getUpdated:function(){return this.getData("update",true)},getDeleted:function(){return this.deletedRows},getAdded:function(){return this.getData("add",true)},getColumn:function(columnParm){var g=this,p=this.options;if(typeof columnParm=="string"){if(g._isColumnId(columnParm)){return g._columns[columnParm]}else{return g.columns[parseInt(columnParm)]}}else{if(typeof(columnParm)=="number"){return g.columns[columnParm]}else{if(typeof columnParm=="object"&&columnParm.nodeType==1){var ids=columnParm.id.split("|");var columnid=ids[ids.length-1];return g._columns[columnid]}}}return columnParm},getColumnType:function(columnname){var g=this,p=this.options;for(i=0;i<g.columns.length;i++){if(g.columns[i].name==columnname){if(g.columns[i].type){return g.columns[i].type}return"string"}}return null},isTotalSummary:function(){var g=this,p=this.options;for(var i=0;i<g.columns.length;i++){if(g.columns[i].totalSummary){return true}}return false},getColumns:function(columnLevel){var g=this,p=this.options;var columns=[];for(var id in g._columns){var col=g._columns[id];if(columnLevel!=undefined){if(col["__level"]==columnLevel){columns.push(col)}}else{if(col["__leaf"]){columns.push(col)}}}return columns},changeSort:function(columnName,sortOrder){var g=this,p=this.options;if(g.loading){return true}if(p.dataAction=="local"){var columnType=g.getColumnType(columnName);if(!g.sortedData){g.sortedData=g.filteredData}if(p.sortName==columnName){g.sortedData[p.root].reverse()}else{g.sortedData[p.root].sort(function(data1,data2){return g._compareData(data1,data2,columnName,columnType)})}if(p.usePager){g.currentData=g._getCurrentPageData(g.sortedData)}else{g.currentData=g.sortedData}g._showData()}p.sortName=columnName;p.sortOrder=sortOrder;if(p.dataAction=="server"){g.loadData(p.where)}},changePage:function(ctype){var g=this,p=this.options;if(g.loading){return true}if(p.dataAction!="local"&&g.isDataChanged&&!confirm(p.isContinueByDataChanged)){return false}p.pageCount=parseInt($(".pcontrol span",g.toolbar).html());switch(ctype){case"first":if(p.page==1){return}p.newPage=1;break;case"prev":if(p.page==1){return}if(p.page>1){p.newPage=parseInt(p.page)-1}break;case"next":if(p.page>=p.pageCount){return}p.newPage=parseInt(p.page)+1;break;case"last":if(p.page>=p.pageCount){return}p.newPage=p.pageCount;break;case"input":var nv=parseInt($(".pcontrol input",g.toolbar).val());if(isNaN(nv)){nv=1}if(nv<1){nv=1}else{if(nv>p.pageCount){nv=p.pageCount}}$(".pcontrol input",g.toolbar).val(nv);p.newPage=nv;break}if(p.newPage==p.page){return false}if(p.newPage==1){$(".l-bar-btnfirst span",g.toolbar).addClass("l-disabled");$(".l-bar-btnprev span",g.toolbar).addClass("l-disabled")}else{$(".l-bar-btnfirst span",g.toolbar).removeClass("l-disabled");$(".l-bar-btnprev span",g.toolbar).removeClass("l-disabled")}if(p.newPage==p.pageCount){$(".l-bar-btnlast span",g.toolbar).addClass("l-disabled");$(".l-bar-btnnext span",g.toolbar).addClass("l-disabled")}else{$(".l-bar-btnlast span",g.toolbar).removeClass("l-disabled");$(".l-bar-btnnext span",g.toolbar).removeClass("l-disabled")}g.trigger("changePage",[p.newPage]);if(p.dataAction=="server"){g.loadData(p.where)}else{g.currentData=g._getCurrentPageData(g.filteredData);g._showData()}},getSelectedRow:function(){for(var i in this.selected){var o=this.selected[i];if(o["__id"] in this.records){return o}}return null},getSelectedRows:function(){var arr=[];for(var i in this.selected){var o=this.selected[i];if(o["__id"] in this.records){arr.push(o)}}return arr},getSelectedRowObj:function(){for(var i in this.selected){var o=this.selected[i];if(o["__id"] in this.records){return this.getRowObj(o)}}return null},getSelectedRowObjs:function(){var arr=[];for(var i in this.selected){var o=this.selected[i];if(o["__id"] in this.records){arr.push(this.getRowObj(o))}}return arr},getCellObj:function(rowParm,column){var rowdata=this.getRow(rowParm);column=this.getColumn(column);return document.getElementById(this._getCellDomId(rowdata,column))},getRowObj:function(rowParm,frozen){var g=this,p=this.options;if(rowParm==null){return null}if(typeof(rowParm)=="string"){if(g._isRowId(rowParm)){return document.getElementById(g.id+(frozen?"|1|":"|2|")+rowParm)}else{return document.getElementById(g.id+(frozen?"|1|":"|2|")+g.rows[parseInt(rowParm)]["__id"])}}else{if(typeof(rowParm)=="number"){return document.getElementById(g.id+(frozen?"|1|":"|2|")+g.rows[rowParm]["__id"])}else{if(typeof(rowParm)=="object"&&rowParm["__id"]){return g.getRowObj(rowParm["__id"],frozen)}}}return rowParm},getRow:function(rowParm){var g=this,p=this.options;if(rowParm==null){return null}if(typeof(rowParm)=="string"){if(g._isRowId(rowParm)){return g.records[rowParm]}else{return g.rows[parseInt(rowParm)]}}else{if(typeof(rowParm)=="number"){return g.rows[parseInt(rowParm)]}else{if(typeof(rowParm)=="object"&&rowParm.nodeType==1&&!rowParm["__id"]){return g._getRowByDomId(rowParm.id)}}}return rowParm},_setColumnVisible:function(column,hide){var g=this,p=this.options;if(!hide){column._hide=false;document.getElementById(column["__domid"]).style.display="";if(column["__pid"]!=-1){var pcol=g._columns[column["__pid"]];if(pcol._hide){document.getElementById(pcol["__domid"]).style.display="";this._setColumnVisible(pcol,hide)}}}else{column._hide=true;document.getElementById(column["__domid"]).style.display="none";if(column["__pid"]!=-1){var hideall=true;var pcol=this._columns[column["__pid"]];for(var i=0;pcol&&i<pcol.columns.length;i++){if(!pcol.columns[i]._hide){hideall=false;break}}if(hideall){pcol._hide=true;document.getElementById(pcol["__domid"]).style.display="none";this._setColumnVisible(pcol,hide)}}}},toggleCol:function(columnparm,visible,toggleByPopup){var g=this,p=this.options;var column;if(typeof(columnparm)=="number"){column=g.columns[columnparm]}else{if(typeof(columnparm)=="object"&&columnparm["__id"]){column=columnparm}else{if(typeof(columnparm)=="string"){if(g._isColumnId(columnparm)){column=g._columns[columnparm]}else{$(g.columns).each(function(){if(this.name==columnparm){g.toggleCol(this,visible,toggleByPopup)}});return}}}}if(!column){return}var columnindex=column["__leafindex"];var headercell=document.getElementById(column["__domid"]);if(!headercell){return}headercell=$(headercell);var cells=[];for(var i in g.rows){var obj=g.getCellObj(g.rows[i],column);if(obj){cells.push(obj)}}for(var i=0;i<g.totalNumber;i++){var tobj=document.getElementById(g.id+"|total"+i+"|"+column["__id"]);if(tobj){cells.push(tobj)}}var colwidth=column._width;if(visible&&column._hide){if(column.frozen){g.f.gridtablewidth+=(parseInt(colwidth)+1)}else{g.gridtablewidth+=(parseInt(colwidth)+1)}g._setColumnVisible(column,false);$(cells).show()}else{if(!visible&&!column._hide){if(column.frozen){g.f.gridtablewidth-=(parseInt(colwidth)+1)}else{g.gridtablewidth-=(parseInt(colwidth)+1)}g._setColumnVisible(column,true);$(cells).hide()}}if(column.frozen){$("div:first",g.f.gridheader).width(g.f.gridtablewidth);$("div:first",g.f.gridbody).width(g.f.gridtablewidth)}else{$("div:first",g.gridheader).width(g.gridtablewidth+40);$("div:first",g.gridbody).width(g.gridtablewidth)}g._updateFrozenWidth();if(!toggleByPopup){$(":checkbox[columnindex="+columnindex+"]",g.popup).each(function(){this.checked=visible;if($.fn.ligerCheckBox){var checkboxmanager=$(this).ligerGetCheckBoxManager();if(checkboxmanager){checkboxmanager.updateStyle()}}})}},setColumnWidth:function(columnparm,newwidth){var g=this,p=this.options;if(!newwidth){return}newwidth=parseInt(newwidth,10);var column;if(typeof(columnparm)=="number"){column=g.columns[columnparm]}else{if(typeof(columnparm)=="object"&&columnparm["__id"]){column=columnparm}else{if(typeof(columnparm)=="string"){if(g._isColumnId(columnparm)){column=g._columns[columnparm]}else{$(g.columns).each(function(){if(this.name==columnparm){g.setColumnWidth(this,newwidth)}});return}}}}if(!column){return}var mincolumnwidth=p.minColumnWidth;if(column.minWidth){mincolumnwidth=column.minWidth}newwidth=newwidth<mincolumnwidth?mincolumnwidth:newwidth;var diff=newwidth-column._width;if(g.trigger("beforeChangeColumnWidth",[column,newwidth])==false){return}column._width=newwidth;if(column.frozen){g.f.gridtablewidth+=diff;$("div:first",g.f.gridheader).width(g.f.gridtablewidth);$("div:first",g.f.gridbody).width(g.f.gridtablewidth)}else{g.gridtablewidth+=diff;$("div:first",g.gridheader).width(g.gridtablewidth+40);$("div:first",g.gridbody).width(g.gridtablewidth)}$(document.getElementById(column["__domid"])).css("width",newwidth);var cells=[];for(var rowid in g.records){var obj=g.getCellObj(g.records[rowid],column);if(obj){cells.push(obj)}if(!g.enabledDetailEdit()&&g.editors[rowid]&&g.editors[rowid][column["__id"]]){var o=g.editors[rowid][column["__id"]];if(o.editor.resize){o.editor.resize(o.input,newwidth,o.container.height(),o.editParm)}}}for(var i=0;i<g.totalNumber;i++){var tobj=document.getElementById(g.id+"|total"+i+"|"+column["__id"]);if(tobj){cells.push(tobj)}}$(cells).css("width",newwidth).find("> div.l-grid-row-cell-inner:first").css("width",newwidth-8);g._updateFrozenWidth();g.trigger("afterChangeColumnWidth",[column,newwidth])},changeHeaderText:function(columnparm,headerText){var g=this,p=this.options;var column;if(typeof(columnparm)=="number"){column=g.columns[columnparm]}else{if(typeof(columnparm)=="object"&&columnparm["__id"]){column=columnparm}else{if(typeof(columnparm)=="string"){if(g._isColumnId(columnparm)){column=g._columns[columnparm]}else{$(g.columns).each(function(){if(this.name==columnparm){g.changeHeaderText(this,headerText)}});return}}}}if(!column){return}var columnindex=column["__leafindex"];var headercell=document.getElementById(column["__domid"]);$(".l-grid-hd-cell-text",headercell).html(headerText);if(p.allowHideColumn){$(":checkbox[columnindex="+columnindex+"]",g.popup).parent().next().html(headerText)}},changeCol:function(from,to,isAfter){var g=this,p=this.options;if(!from||!to){return}var fromCol=g.getColumn(from);var toCol=g.getColumn(to);fromCol.frozen=toCol.frozen;var fromColIndex,toColIndex;var fromColumns=fromCol["__pid"]==-1?p.columns:g._columns[fromCol["__pid"]].columns;var toColumns=toCol["__pid"]==-1?p.columns:g._columns[toCol["__pid"]].columns;fromColIndex=$.inArray(fromCol,fromColumns);toColIndex=$.inArray(toCol,toColumns);var sameParent=fromColumns==toColumns;var sameLevel=fromCol["__level"]==toCol["__level"];toColumns.splice(toColIndex+(isAfter?1:0),0,fromCol);if(!sameParent){fromColumns.splice(fromColIndex,1)}else{if(isAfter){fromColumns.splice(fromColIndex,1)}else{fromColumns.splice(fromColIndex+1,1)}}g._setColumns(p.columns);g.reRender()},collapseDetail:function(rowParm){var g=this,p=this.options;var rowdata=g.getRow(rowParm);if(!rowdata){return}for(var i=0,l=g.columns.length;i<l;i++){if(g.columns[i].isdetail){var row=g.getRowObj(rowdata);var cell=g.getCellObj(rowdata,g.columns[i]);$(row).next("tr.l-grid-detailpanel").hide();$(".l-grid-row-cell-detailbtn:first",cell).removeClass("l-open");g.trigger("SysGridHeightChanged");return}}},extendDetail:function(rowParm){var g=this,p=this.options;var rowdata=g.getRow(rowParm);if(!rowdata){return}for(var i=0,l=g.columns;i<l;i++){if(g.columns[i].isdetail){var row=g.getRowObj(rowdata);var cell=g.getCellObj(rowdata,g.columns[i]);$(row).next("tr.l-grid-detailpanel").show();$(".l-grid-row-cell-detailbtn:first",cell).addClass("l-open");g.trigger("SysGridHeightChanged");return}}},getParent:function(rowParm){var g=this,p=this.options;if(!p.tree){return null}var rowdata=g.getRow(rowParm);if(!rowdata){return null}if(rowdata["__pid"] in g.records){return g.records[rowdata["__pid"]]}else{return null}},getChildren:function(rowParm,deep){var g=this,p=this.options;if(!p.tree){return null}var rowData=g.getRow(rowParm);if(!rowData){return null}var arr=[];function loadChildren(data){if(data[p.tree.childrenName]){for(var i=0,l=data[p.tree.childrenName].length;i<l;i++){var o=data[p.tree.childrenName][i];if(o["__status"]=="delete"){continue}arr.push(o);if(deep){loadChildren(o)}}}}loadChildren(rowData);return arr},isLeaf:function(rowParm){var g=this,p=this.options;var rowdata=g.getRow(rowParm);if(!rowdata){return}return rowdata["__hasChildren"]?false:true},hasChildren:function(rowParm){var g=this,p=this.options;var rowdata=this.getRow(rowParm);if(!rowdata){return}return(rowdata[p.tree.childrenName]&&rowdata[p.tree.childrenName].length)?true:false},existRecord:function(record){for(var rowid in this.records){if(this.records[rowid]==record){return true}}return false},_removeSelected:function(rowdata){var g=this,p=this.options;if(p.tree){var children=g.getChildren(rowdata,true);if(children){for(var i=0,l=children.length;i<l;i++){var index2=$.inArray(children[i],g.selected);if(index2!=-1){g.selected.splice(index2,1)}}}}var index=$.inArray(rowdata,g.selected);if(index!=-1){g.selected.splice(index,1)}},_getParentChildren:function(rowParm){var g=this,p=this.options;var rowdata=g.getRow(rowParm);var listdata;if(p.tree&&g.existRecord(rowdata)&&rowdata["__pid"] in g.records){listdata=g.records[rowdata["__pid"]][p.tree.childrenName]}else{listdata=g.currentData[p.root]}return listdata},_removeData:function(rowdata){var g=this,p=this.options;var listdata=g._getParentChildren(rowdata);var index=$.inArray(rowdata,listdata);if(index!=-1){listdata.splice(index,1)}g._removeSelected(rowdata)},_addData:function(rowdata,parentdata,neardata,isBefore){var g=this,p=this.options;var listdata=g.currentData[p.root];if(neardata){if(p.tree){if(parentdata){listdata=parentdata[p.tree.childrenName]}else{if(neardata["__pid"] in g.records){listdata=g.records[neardata["__pid"]][p.tree.childrenName]}}}var index=$.inArray(neardata,listdata);listdata.splice(index==-1?-1:index+(isBefore?0:1),0,rowdata)}else{if(p.tree&&parentdata){listdata=parentdata[p.tree.childrenName]}listdata.push(rowdata)}},_appendData:function(rowdata,parentdata,neardata,isBefore){var g=this,p=this.options;rowdata[p.statusName]="update";g._removeData(rowdata);g._addData(rowdata,parentdata,neardata,isBefore)},appendRange:function(rows,parentdata,neardata,isBefore){var g=this,p=this.options;var toRender=false;$.each(rows,function(i,item){if(item["__id"]&&g.existRecord(item)){if(g.isLeaf(parentdata)){g.upgrade(parentdata)}g._appendData(item,parentdata,neardata,isBefore);toRender=true}else{g.appendRow(item,parentdata,neardata,isBefore)}});if(toRender){g.reRender()}},appendRow:function(rowdata,parentdata,neardata,isBefore){var g=this,p=this.options;if($.isArray(rowdata)){g.appendRange(rowdata,parentdata,neardata,isBefore);return}if(rowdata["__id"]&&g.existRecord(rowdata)){g._appendData(rowdata,parentdata,neardata,isBefore);g.reRender();return}if(parentdata&&g.isLeaf(parentdata)){g.upgrade(parentdata)}g.addRow(rowdata,neardata,isBefore?true:false,parentdata)},upgrade:function(rowParm){var g=this,p=this.options;var rowdata=g.getRow(rowParm);if(!rowdata||!p.tree){return}rowdata[p.tree.childrenName]=rowdata[p.tree.childrenName]||[];rowdata["__hasChildren"]=true;var rowobjs=[g.getRowObj(rowdata)];if(g.enabledFrozen()){rowobjs.push(g.getRowObj(rowdata,true))}$("> td > div > .l-grid-tree-space:last",rowobjs).addClass("l-grid-tree-link l-grid-tree-link-open")},demotion:function(rowParm){var g=this,p=this.options;var rowdata=g.getRow(rowParm);if(!rowdata||!p.tree){return}var rowobjs=[g.getRowObj(rowdata)];if(g.enabledFrozen()){rowobjs.push(g.getRowObj(rowdata,true))}$("> td > div > .l-grid-tree-space:last",rowobjs).removeClass("l-grid-tree-link l-grid-tree-link-open l-grid-tree-link-close");if(g.hasChildren(rowdata)){var children=g.getChildren(rowdata);for(var i=0,l=children.length;i<l;i++){g.deleteRow(children[i])}}rowdata["__hasChildren"]=false},collapse:function(rowParm){var g=this,p=this.options;var targetRowObj=g.getRowObj(rowParm);var linkbtn=$(".l-grid-tree-link",targetRowObj);if(linkbtn.hasClass("l-grid-tree-link-close")){return}g.toggle(rowParm)},expand:function(rowParm){var g=this,p=this.options;var targetRowObj=g.getRowObj(rowParm);var linkbtn=$(".l-grid-tree-link",targetRowObj);if(linkbtn.hasClass("l-grid-tree-link-open")){return}g.toggle(rowParm)},toggle:function(rowParm){if(!rowParm){return}var g=this,p=this.options;var rowdata=g.getRow(rowParm);var targetRowObj=[g.getRowObj(rowdata)];if(g.enabledFrozen()){targetRowObj.push(g.getRowObj(rowdata,true))}var level=rowdata["__level"],indexInCollapsedRows;var linkbtn=$(".l-grid-tree-link:first",targetRowObj);var opening=true;g.collapsedRows=g.collapsedRows||[];if(linkbtn.hasClass("l-grid-tree-link-close")){linkbtn.removeClass("l-grid-tree-link-close").addClass("l-grid-tree-link-open");indexInCollapsedRows=$.inArray(rowdata,g.collapsedRows);if(indexInCollapsedRows!=-1){g.collapsedRows.splice(indexInCollapsedRows,1)}}else{opening=false;linkbtn.addClass("l-grid-tree-link-close").removeClass("l-grid-tree-link-open");indexInCollapsedRows=$.inArray(rowdata,g.collapsedRows);if(indexInCollapsedRows==-1){g.collapsedRows.push(rowdata)}}var children=g.getChildren(rowdata,true);for(var i=0,l=children.length;i<l;i++){var o=children[i];var currentRow=$([g.getRowObj(o["__id"])]);if(g.enabledFrozen()){currentRow=currentRow.add(g.getRowObj(o["__id"],true))}if(opening){$(".l-grid-tree-link",currentRow).removeClass("l-grid-tree-link-close").addClass("l-grid-tree-link-open");currentRow.show()}else{$(".l-grid-tree-link",currentRow).removeClass("l-grid-tree-link-open").addClass("l-grid-tree-link-close");currentRow.hide()}}},_bulid:function(){var g=this;g._clearGrid();g._initBuildHeader();g._initHeight();g._initFootbar();g._buildPager();g._setEvent()},_setColumns:function(columns){var g=this;g._initColumns();g._initBuildGridHeader();g._initBuildPopup()},_initBuildHeader:function(){var g=this,p=this.options;if(p.title){$(".l-panel-header-text",g.header).html(p.title);if(p.headerImg){g.header.append("<img src='"+p.headerImg+"' />").addClass("l-panel-header-hasicon")}}else{g.header.hide()}if(p.toolbar){if($.fn.ligerToolBar){g.toolbarManager=g.topbar.ligerToolBar(p.toolbar)}}else{g.topbar.remove()}},_createColumnId:function(column){if(column.id!=null){return column.id.toString()}return"c"+(100+this._columnCount)},_isColumnId:function(str){return(str in this._columns)},_initColumns:function(){var g=this,p=this.options;g._columns={};g._columnCount=0;g._columnLeafCount=0;g._columnMaxLevel=1;if(!p.columns){return}function removeProp(column,props){for(var i in props){if(props[i] in column){delete column[props[i]]}}}function setColumn(column,level,pid,previd){removeProp(column,["__id","__pid","__previd","__nextid","__domid","__leaf","__leafindex","__level","__colSpan","__rowSpan"]);if(level>g._columnMaxLevel){g._columnMaxLevel=level}g._columnCount++;column["__id"]=g._createColumnId(column);column["__domid"]=g.id+"|hcell|"+column["__id"];g._columns[column["__id"]]=column;if(!column.columns||!column.columns.length){column["__leafindex"]=g._columnLeafCount++}column["__level"]=level;column["__pid"]=pid;column["__previd"]=previd;if(!column.columns||!column.columns.length){column["__leaf"]=true;return 1}var leafcount=0;var newid=-1;for(var i=0,l=column.columns.length;i<l;i++){var col=column.columns[i];leafcount+=setColumn(col,level+1,column["__id"],newid);newid=col["__id"]}column["__leafcount"]=leafcount;return leafcount}var lastid=-1;if(p.rownumbers){var frozenRownumbers=g.enabledGroup()?false:p.frozen&&p.frozenRownumbers;var col={isrownumber:true,issystem:true,width:p.rownumbersColWidth,frozen:frozenRownumbers};setColumn(col,1,-1,lastid);lastid=col["__id"]}if(g.enabledDetail()){var frozenDetail=g.enabledGroup()?false:p.frozen&&p.frozenDetail;var col={isdetail:true,issystem:true,width:p.detailColWidth,frozen:frozenDetail};setColumn(col,1,-1,lastid);lastid=col["__id"]}if(g.enabledCheckbox()){var frozenCheckbox=g.enabledGroup()?false:p.frozen&&p.frozenCheckbox;var col={ischeckbox:true,issystem:true,width:p.detailColWidth,frozen:frozenCheckbox};setColumn(col,1,-1,lastid);lastid=col["__id"]}for(var i=0,l=p.columns.length;i<l;i++){var col=p.columns[i];setColumn(col,1,-1,lastid);lastid=col["__id"]}for(var id in g._columns){var col=g._columns[id];if(col["__leafcount"]>1){col["__colSpan"]=col["__leafcount"]}if(col["__leaf"]&&col["__level"]!=g._columnMaxLevel){col["__rowSpan"]=g._columnMaxLevel-col["__level"]+1}}g.columns=g.getColumns();$(g.columns).each(function(i,column){column.columnname=column.name;column.columnindex=i;column.type=column.type||"string";column.islast=i==g.columns.length-1;column.isSort=column.isSort==false?false:true;column.frozen=column.frozen?true:false;column._width=g._getColumnWidth(column);column._hide=column.hide?true:false})},_getColumnWidth:function(column){var g=this,p=this.options;if(column._width){return column._width}var colwidth;if(column.width){colwidth=column.width}else{if(p.columnWidth){colwidth=p.columnWidth}}if(!colwidth){var lwidth=4;if(g.enabledCheckbox()){lwidth+=p.checkboxColWidth}if(g.enabledDetail()){lwidth+=p.detailColWidth}colwidth=parseInt((g.grid.width()-lwidth)/g.columns.length)}if(typeof(colwidth)=="string"&&colwidth.indexOf("%")>0){column._width=colwidth=parseInt(parseInt(colwidth)*0.01*(g.grid.width()-g.columns.length))}if(column.minWidth&&colwidth<column.minWidth){colwidth=column.minWidth}if(column.maxWidth&&colwidth>column.maxWidth){colwidth=column.maxWidth}column._width=colwidth;return colwidth},_createHeaderCell:function(column){var g=this,p=this.options;var jcell=$("<td class='l-grid-hd-cell'><div class='l-grid-hd-cell-inner'><span class='l-grid-hd-cell-text'></span></div></td>");jcell.attr("id",column["__domid"]);if(!column["__leaf"]){jcell.addClass("l-grid-hd-cell-mul")}if(column.columnindex==g.columns.length-1){jcell.addClass("l-grid-hd-cell-last")}if(column.isrownumber){jcell.addClass("l-grid-hd-cell-rownumbers");jcell.html("<div class='l-grid-hd-cell-inner'></div>")}if(column.ischeckbox){jcell.addClass("l-grid-hd-cell-checkbox");jcell.html("<div class='l-grid-hd-cell-inner'><div class='l-grid-hd-cell-text l-grid-hd-cell-btn-checkbox'></div></div>")}if(column.isdetail){jcell.addClass("l-grid-hd-cell-detail");jcell.html("<div class='l-grid-hd-cell-inner'><div class='l-grid-hd-cell-text l-grid-hd-cell-btn-detail'></div></div>")}if(column.heightAlign){$(".l-grid-hd-cell-inner:first",jcell).css("textAlign",column.heightAlign)}if(column["__colSpan"]){jcell.attr("colSpan",column["__colSpan"])}if(column["__rowSpan"]){jcell.attr("rowSpan",column["__rowSpan"]);jcell.height(p.headerRowHeight*column["__rowSpan"])}else{jcell.height(p.headerRowHeight)}if(column["__leaf"]){jcell.width(column["_width"]);jcell.attr("columnindex",column["__leafindex"])}if(column._hide){jcell.hide()}if(column.name){jcell.attr({columnname:column.name})}var headerText="";if(column.display&&column.display!=""){headerText=column.display}else{if(column.headerRender){headerText=column.headerRender(column)}else{headerText="&nbsp;"}}$(".l-grid-hd-cell-text:first",jcell).html(headerText);if(!column.issystem&&column["__leaf"]&&column.resizable!==false&&$.fn.ligerResizable){g.colResizable[column["__id"]]=jcell.ligerResizable({handles:"e",onStartResize:function(e,ev){this.proxy.hide();g.draggingline.css({height:g.body.height(),top:0,left:ev.pageX-g.grid.offset().left+parseInt(g.body[0].scrollLeft)}).show()},onResize:function(e,ev){g.colresizing=true;g.draggingline.css({left:ev.pageX-g.grid.offset().left+parseInt(g.body[0].scrollLeft)});$("body").add(jcell).css("cursor","e-resize")},onStopResize:function(e){g.colresizing=false;$("body").add(jcell).css("cursor","default");g.draggingline.hide();g.setColumnWidth(column,column._width+e.diffX);return false}})}return jcell},_initBuildGridHeader:function(){var g=this,p=this.options;g.gridtablewidth=0;g.f.gridtablewidth=0;if(g.colResizable){for(var i in g.colResizable){g.colResizable[i].destroy()}g.colResizable=null}g.colResizable={};$("tbody:first",g.gridheader).html("");$("tbody:first",g.f.gridheader).html("");for(var level=1;level<=g._columnMaxLevel;level++){var columns=g.getColumns(level);var islast=level==g._columnMaxLevel;var tr=$("<tr class='l-grid-hd-row'></tr>");var trf=$("<tr class='l-grid-hd-row'></tr>");if(!islast){tr.add(trf).addClass("l-grid-hd-mul")}$("tbody:first",g.gridheader).append(tr);$("tbody:first",g.f.gridheader).append(trf);$(columns).each(function(i,column){(column.frozen?trf:tr).append(g._createHeaderCell(column));if(column["__leaf"]){var colwidth=column["_width"];if(!column.frozen){g.gridtablewidth+=(parseInt(colwidth)?parseInt(colwidth):0)+1}else{g.f.gridtablewidth+=(parseInt(colwidth)?parseInt(colwidth):0)+1}}})}if(g._columnMaxLevel>0){var h=p.headerRowHeight*g._columnMaxLevel;g.gridheader.add(g.f.gridheader).height(h);if(p.rownumbers&&p.frozenRownumbers){g.f.gridheader.find("td:first").height(h)}}g._updateFrozenWidth();$("div:first",g.gridheader).width(g.gridtablewidth+40)},_initBuildPopup:function(){var g=this,p=this.options;$(":checkbox",g.popup).unbind();$("tbody tr",g.popup).remove();$(g.columns).each(function(i,column){if(column.issystem){return}if(column.isAllowHide==false){return}var chk='checked="checked"';if(column._hide){chk=""}var header=column.display;$("tbody",g.popup).append('<tr><td class="l-column-left"><input type="checkbox" '+chk+' class="l-checkbox" columnindex="'+i+'"/></td><td class="l-column-right">'+header+"</td></tr>")});if($.fn.ligerCheckBox){$("input:checkbox",g.popup).ligerCheckBox({onBeforeClick:function(obj){if(!obj.checked){return true}if($("input:checked",g.popup).length<=p.minColToggle){return false}return true}})}if(p.allowHideColumn){$("tr",g.popup).hover(function(){$(this).addClass("l-popup-row-over")},function(){$(this).removeClass("l-popup-row-over")});var onPopupCheckboxChange=function(){if($("input:checked",g.popup).length+1<=p.minColToggle){return false}g.toggleCol(parseInt($(this).attr("columnindex")),this.checked,true)};if($.fn.ligerCheckBox){$(":checkbox",g.popup).bind("change",onPopupCheckboxChange)}else{$(":checkbox",g.popup).bind("click",onPopupCheckboxChange)}}},_initHeight:function(){var g=this,p=this.options;if(p.height=="auto"){g.gridbody.height("auto");g.f.gridbody.height("auto")}if(p.width){g.grid.width(p.width)}g._onResize.call(g)},_initFootbar:function(){var g=this,p=this.options;if(p.usePager){var optStr="";var selectedIndex=-1;$(p.pageSizeOptions).each(function(i,item){var selectedStr="";if(p.pageSize==item){selectedIndex=i}optStr+="<option value='"+item+"' "+selectedStr+" >"+item+"</option>"});$(".l-bar-selectpagesize",g.toolbar).append("<select name='rp'>"+optStr+"</select>");if(selectedIndex!=-1){$(".l-bar-selectpagesize select",g.toolbar)[0].selectedIndex=selectedIndex}if(p.switchPageSizeApplyComboBox&&$.fn.ligerComboBox){$(".l-bar-selectpagesize select",g.toolbar).ligerComboBox({onBeforeSelect:function(){if(p.url&&g.isDataChanged&&!confirm(p.isContinueByDataChanged)){return false}return true},width:45})}}else{g.toolbar.hide()}},_searchData:function(data,clause){var g=this,p=this.options;var newData=new Array();for(var i=0;i<data.length;i++){if(clause(data[i],i)){newData[newData.length]=data[i]}}return newData},_clearGrid:function(){var g=this,p=this.options;for(var i in g.rows){var rowobj=$(g.getRowObj(g.rows[i]));if(g.enabledFrozen()){rowobj=rowobj.add(g.getRowObj(g.rows[i],true))}rowobj.unbind()}g.gridbody.html("");g.f.gridbody.html("");g.recordNumber=0;g.records={};g.rows=[];g.selected=[];g.totalNumber=0;g.editorcounter=0},_fillGridBody:function(data,frozen){var g=this,p=this.options;var gridhtmlarr=['<div class="l-grid-body-inner"><table class="l-grid-body-table" cellpadding=0 cellspacing=0><tbody>'];if(g.enabledGroup()){var groups=[];var groupsdata=[];g.groups=groupsdata;for(var rowparm in data){var item=data[rowparm];var groupColumnValue=item[p.groupColumnName];var valueIndex=$.inArray(groupColumnValue,groups);if(valueIndex==-1){groups.push(groupColumnValue);valueIndex=groups.length-1;groupsdata.push([])}groupsdata[valueIndex].push(item)}$(groupsdata).each(function(i,item){if(groupsdata.length==1){gridhtmlarr.push('<tr class="l-grid-grouprow l-grid-grouprow-last l-grid-grouprow-first"')}if(i==groupsdata.length-1){gridhtmlarr.push('<tr class="l-grid-grouprow l-grid-grouprow-last"')}else{if(i==0){gridhtmlarr.push('<tr class="l-grid-grouprow l-grid-grouprow-first"')}else{gridhtmlarr.push('<tr class="l-grid-grouprow"')}}gridhtmlarr.push(' groupindex"='+i+'" >');gridhtmlarr.push('<td colSpan="'+g.columns.length+'" class="l-grid-grouprow-cell">');gridhtmlarr.push('<span class="l-grid-group-togglebtn">&nbsp;&nbsp;&nbsp;&nbsp;</span>');if(p.groupRender){gridhtmlarr.push(p.groupRender(groups[i],item,p.groupColumnDisplay))}else{gridhtmlarr.push(p.groupColumnDisplay+":"+groups[i])}gridhtmlarr.push("</td>");gridhtmlarr.push("</tr>");gridhtmlarr.push(g._getHtmlFromData(item,frozen));if(g.isTotalSummary()){gridhtmlarr.push(g._getTotalSummaryHtml(item,"l-grid-totalsummary-group",frozen))}})}else{gridhtmlarr.push(g._getHtmlFromData(data,frozen))}gridhtmlarr.push("</tbody></table></div>");(frozen?g.f.gridbody:g.gridbody).html(gridhtmlarr.join(""));if(!g.enabledGroup()){g._bulidTotalSummary(frozen)}if(!p.fixedCellHeight&&p.rownumbers){if(g.rows&&g.rows.length>0){for(var i=0;i<g.rows.length;i++){$(document.getElementById("tableContainer|1|"+g.rows[i]["__id"])).height($(document.getElementById("tableContainer|2|"+g.rows[i]["__id"])).height())}}}$("> div:first",g.gridbody).width(g.gridtablewidth);g._onResize()},_showData:function(){var g=this,p=this.options;var data=g.currentData[p.root];if(p.usePager){if(p.dataAction=="server"&&g.data&&g.data[p.record]){p.total=g.data[p.record]}else{if(g.filteredData&&g.filteredData[p.root]){p.total=g.filteredData[p.root].length}else{if(g.data&&g.data[p.root]){p.total=g.data[p.root].length}else{if(data){p.total=data.length}}}}p.page=p.newPage;if(!p.total){p.total=0}if(!p.page){p.page=1}p.pageCount=Math.ceil(p.total/p.pageSize);if(!p.pageCount){p.pageCount=1}g._buildPager()}$(".l-bar-btnloading:first",g.toolbar).removeClass("l-bar-btnloading");if(g.trigger("beforeShowData",[g.currentData])==false){return}g._clearGrid();g.isDataChanged=false;if(!data){return}$(".l-bar-btnload:first span",g.toolbar).removeClass("l-disabled");g._updateGridData();if(g.enabledFrozen()){g._fillGridBody(g.rows,true)}g._fillGridBody(g.rows,false);g.trigger("SysGridHeightChanged");if(p.totalRender){$(".l-panel-bar-total",g.element).remove();$(".l-panel-bar",g.element).before('<div class="l-panel-bar-total">'+p.totalRender(g.data,g.filteredData)+"</div>")}if(p.mouseoverRowCssClass){for(var i in g.rows){var rowobj=$(g.getRowObj(g.rows[i]));if(g.enabledFrozen()){rowobj=rowobj.add(g.getRowObj(g.rows[i],true))}rowobj.bind("mouseover.gridrow",function(){g._onRowOver(this,true)}).bind("mouseout.gridrow",function(){g._onRowOver(this,false)})}}g.gridbody.trigger("scroll.grid");g.trigger("afterShowData",[g.currentData])},_getRowDomId:function(rowdata,frozen){return this.id+"|"+(frozen?"1":"2")+"|"+rowdata["__id"]},_getCellDomId:function(rowdata,column){return this._getRowDomId(rowdata,column.frozen)+"|"+column["__id"]},_getHtmlFromData:function(data,frozen){if(!data){return""}var g=this,p=this.options;var gridhtmlarr=[];for(var rowparm in data){var item=data[rowparm];var rowid=item["__id"];if(!item){continue}gridhtmlarr.push("<tr");gridhtmlarr.push(' id="'+g._getRowDomId(item,frozen)+'"');gridhtmlarr.push(' class="l-grid-row');if(!frozen&&g.enabledCheckbox()&&p.isChecked&&p.isChecked(item)){g.select(item);gridhtmlarr.push(" l-selected")}else{if(g.isSelected(item)){gridhtmlarr.push(" l-selected")}}if(item["__index"]%2==1&&p.alternatingRow){gridhtmlarr.push(" l-grid-row-alt")}gridhtmlarr.push('" ');if(p.rowAttrRender){gridhtmlarr.push(p.rowAttrRender(item,rowid))}if(p.tree&&g.collapsedRows&&g.collapsedRows.length){var isHide=function(){var pitem=g.getParent(item);while(pitem){if($.inArray(pitem,g.collapsedRows)!=-1){return true}pitem=g.getParent(pitem)}return false};if(isHide()){gridhtmlarr.push(' style="display:none;" ')}}gridhtmlarr.push(">");$(g.columns).each(function(columnindex,column){if(frozen!=column.frozen){return}gridhtmlarr.push("<td");gridhtmlarr.push(' id="'+g._getCellDomId(item,this)+'"');if(this.isrownumber){gridhtmlarr.push(' class="l-grid-row-cell l-grid-row-cell-rownumbers" style="width:'+this.width+'px"><div class="l-grid-row-cell-inner"');if(p.fixedCellHeight){gridhtmlarr.push(' style = "height:'+p.rowHeight+'px;" ')}gridhtmlarr.push(">"+(parseInt(item["__index"])+1)+"</div></td>");return}if(this.ischeckbox){gridhtmlarr.push(' class="l-grid-row-cell l-grid-row-cell-checkbox" style="width:'+this.width+'px"><div class="l-grid-row-cell-inner"');if(p.fixedCellHeight){gridhtmlarr.push(' style = "height:'+p.rowHeight+'px;" ')}gridhtmlarr.push('><span class="l-grid-row-cell-btn-checkbox"></span></div></td>');return}else{if(this.isdetail){gridhtmlarr.push(' class="l-grid-row-cell l-grid-row-cell-detail" style="width:'+this.width+'px"><div class="l-grid-row-cell-inner"');if(p.fixedCellHeight){gridhtmlarr.push(' style = "height:'+p.rowHeight+'px;" ')}gridhtmlarr.push('><span class="l-grid-row-cell-detailbtn"></span></div></td>');return}}var colwidth=this._width;gridhtmlarr.push(' class="l-grid-row-cell ');if(g.changedCells[rowid+"_"+this["__id"]]){gridhtmlarr.push("l-grid-row-cell-edited ")}if(this.islast){gridhtmlarr.push("l-grid-row-cell-last ")}gridhtmlarr.push('"');gridhtmlarr.push(' style = "');gridhtmlarr.push("width:"+colwidth+"px; ");if(column._hide){gridhtmlarr.push("display:none;")}gridhtmlarr.push(' ">');gridhtmlarr.push(g._getCellHtml(item,column));gridhtmlarr.push("</td>")});gridhtmlarr.push("</tr>")}return gridhtmlarr.join("")},_getCellHtml:function(rowdata,column){var g=this,p=this.options;if(column.isrownumber){return'<div class="l-grid-row-cell-inner">'+(parseInt(rowdata["__index"])+1)+"</div>"}var htmlarr=[];htmlarr.push('<div class="l-grid-row-cell-inner"');htmlarr.push(' style = "width:'+parseInt(column._width-8)+"px;");if(p.fixedCellHeight){htmlarr.push("height:"+p.rowHeight+"px;min-height:"+p.rowHeight+"px; ")}if(column.align){htmlarr.push("text-align:"+column.align+";")}var content=g._getCellContent(rowdata,column);htmlarr.push('">'+content+"</div>");return htmlarr.join("")},_getCellContent:function(rowdata,column){if(!rowdata||!column){return""}if(column.isrownumber){return parseInt(rowdata["__index"])+1}var rowid=rowdata["__id"];var rowindex=rowdata["__index"];var value=column.name?rowdata[column.name]:null;var g=this,p=this.options;var content="";if(column.render){content=column.render.call(g,rowdata,rowindex,value,column)}else{if(p.formatters[column.type]){content=p.formatters[column.type].call(g,value,column)}else{if(value!=null){content=value.toString()}}}if(p.tree&&(p.tree.columnName!=null&&p.tree.columnName==column.name||p.tree.columnId!=null&&p.tree.columnId==column.id)){content=g._getTreeCellHtml(content,rowdata)}return content||""},_getTreeCellHtml:function(oldContent,rowdata){var level=rowdata["__level"];var g=this,p=this.options;var isExtend=$.inArray(rowdata,g.collapsedRows||[])==-1;var isParent=p.tree.isParent(rowdata);var content="";level=parseInt(level)||1;for(var i=1;i<level;i++){content+="<div class='l-grid-tree-space'></div>"}if(isExtend&&isParent){content+="<div class='l-grid-tree-space l-grid-tree-link l-grid-tree-link-open'></div>"}else{if(isParent){content+="<div class='l-grid-tree-space l-grid-tree-link l-grid-tree-link-close'></div>"}else{content+="<div class='l-grid-tree-space'></div>"}}content+="<span class='l-grid-tree-content'>"+oldContent+"</span>";return content},_applyEditor:function(obj){var g=this,p=this.options;var rowcell=obj;var ids=rowcell.id.split("|");var columnid=ids[ids.length-1];var column=g._columns[columnid];var row=$(rowcell).parent();var rowdata=g.getRow(row[0]);var rowid=rowdata["__id"];var rowindex=rowdata["__index"];if(!column||!column.editor){return}var columnname=column.name;var columnindex=column.columnindex;if(column.editor.type&&p.editors[column.editor.type]){var currentdata=rowdata[columnname];var editParm={record:rowdata,value:currentdata,column:column,rowindex:rowindex};if(g.trigger("beforeEdit",[editParm])==false){return false}var editor=p.editors[column.editor.type];var jcell=$(rowcell),offset=$(rowcell).offset();jcell.html("");g.setCellEditing(rowdata,column,true);var width=$(rowcell).width(),height=$(rowcell).height();var container=$("<div class='l-grid-editor'></div>").appendTo("body");if($.browser.mozilla){container.css({left:offset.left,top:offset.top}).show()}else{container.css({left:offset.left+1,top:offset.top+1}).show()}var editorInput=g._createEditor(editor,container,editParm,width,height);g.editor={editing:true,editor:editor,input:editorInput,editParm:editParm,container:container};$(editorInput).focus();g.unbind("sysEndEdit");g.bind("sysEndEdit",function(){var newValue=editor.getValue(editorInput,editParm);if(newValue!=currentdata){$(rowcell).addClass("l-grid-row-cell-edited");g.changedCells[rowid+"_"+column["__id"]]=true;if(column.editor.onChange){column.editor.onChange(rowcell,newValue)}editParm.value=newValue;if(g._checkEditAndUpdateCell(editParm)){if(column.editor.onChanged){column.editor.onChanged(rowcell,newValue)}}}});editorInput.focus()}},_checkEditAndUpdateCell:function(editParm){var g=this,p=this.options;if(g.trigger("beforeSubmitEdit",[editParm])==false){return false}g.updateCell(editParm.column,editParm.value,editParm.record);if(editParm.column.render||g.enabledTotal()){g.reRender({column:editParm.column})}g.reRender({rowdata:editParm.record});return true},_getCurrentPageData:function(source){var g=this,p=this.options;var data={};data[p.root]=[];if(!source||!source[p.root]||!source[p.root].length){data[p.record]=0;return data}data[p.record]=source[p.root].length;if(!p.newPage){p.newPage=1}for(i=(p.newPage-1)*p.pageSize;i<source[p.root].length&&i<p.newPage*p.pageSize;i++){data[p.root].push(source[p.root][i])}return data},_compareData:function(data1,data2,columnName,columnType){var g=this,p=this.options;var val1=data1[columnName],val2=data2[columnName];if(val1==null&&val2!=null){return 1}else{if(val1==null&&val2==null){return 0}else{if(val1!=null&&val2==null){return -1}}}if(p.sorters[columnType]){return p.sorters[columnType].call(g,val1,val2)}else{return val1<val2?-1:val1>val2?1:0}},_getTotalCellContent:function(column,data){var g=this,p=this.options;var totalsummaryArr=[];if(column.totalSummary){var isExist=function(type){for(var i=0;i<types.length;i++){if(types[i].toLowerCase()==type.toLowerCase()){return true}}return false};var sum=0,count=0,avg=0;var max=parseFloat(data[0][column.name]);var min=parseFloat(data[0][column.name]);for(var i=0;i<data.length;i++){count+=1;var value=parseFloat(data[i][column.name]);if(!value){continue}sum+=value;if(value>max){max=value}if(value<min){min=value}}avg=sum*1/data.length;if(column.totalSummary.render){var renderhtml=column.totalSummary.render({sum:sum,count:count,avg:avg,min:min,max:max},column,g.data);totalsummaryArr.push(renderhtml)}else{if(column.totalSummary.type){var types=column.totalSummary.type.split(",");if(isExist("sum")){totalsummaryArr.push("<div>Sum="+sum.toFixed(2)+"</div>")}if(isExist("count")){totalsummaryArr.push("<div>Count="+count+"</div>")}if(isExist("max")){totalsummaryArr.push("<div>Max="+max.toFixed(2)+"</div>")}if(isExist("min")){totalsummaryArr.push("<div>Min="+min.toFixed(2)+"</div>")}if(isExist("avg")){totalsummaryArr.push("<div>Avg="+avg.toFixed(2)+"</div>")}}}}return totalsummaryArr.join("")},_getTotalSummaryHtml:function(data,classCssName,frozen){var g=this,p=this.options;var totalsummaryArr=[];if(classCssName){totalsummaryArr.push('<tr class="l-grid-totalsummary '+classCssName+'">')}else{totalsummaryArr.push('<tr class="l-grid-totalsummary">')}$(g.columns).each(function(columnindex,column){if(this.frozen!=frozen){return}if(this.isrownumber){totalsummaryArr.push('<td class="l-grid-totalsummary-cell l-grid-totalsummary-cell-rownumbers" style="width:'+this.width+'px"><div>&nbsp;</div></td>');return}if(this.ischeckbox){totalsummaryArr.push('<td class="l-grid-totalsummary-cell l-grid-totalsummary-cell-checkbox" style="width:'+this.width+'px"><div>&nbsp;</div></td>');return}else{if(this.isdetail){totalsummaryArr.push('<td class="l-grid-totalsummary-cell l-grid-totalsummary-cell-detail" style="width:'+this.width+'px"><div>&nbsp;</div></td>');return}}totalsummaryArr.push('<td class="l-grid-totalsummary-cell');if(this.islast){totalsummaryArr.push(" l-grid-totalsummary-cell-last")}totalsummaryArr.push('" ');totalsummaryArr.push('id="'+g.id+"|total"+g.totalNumber+"|"+column.__id+'" ');totalsummaryArr.push('width="'+this._width+'" ');columnname=this.columnname;if(columnname){totalsummaryArr.push('columnname="'+columnname+'" ')}totalsummaryArr.push('columnindex="'+columnindex+'" ');totalsummaryArr.push('><div class="l-grid-totalsummary-cell-inner"');if(column.align){totalsummaryArr.push(' style="text-Align:'+column.align+';"')}totalsummaryArr.push(">");totalsummaryArr.push(g._getTotalCellContent(column,data));totalsummaryArr.push("</div></td>")});totalsummaryArr.push("</tr>");if(!frozen){g.totalNumber++}return totalsummaryArr.join("")},_bulidTotalSummary:function(frozen){var g=this,p=this.options;if(!g.isTotalSummary()){return false}if(!g.currentData||g.currentData[p.root].length==0){return false}var totalRow=$(g._getTotalSummaryHtml(g.currentData[p.root],null,frozen));$("tbody:first",frozen?g.f.gridbody:g.gridbody).append(totalRow)},_buildPager:function(){var g=this,p=this.options;$(".pcontrol input",g.toolbar).val(p.page);if(!p.pageCount){p.pageCount=1}$(".pcontrol span",g.toolbar).html(p.pageCount);var r1=parseInt((p.page-1)*p.pageSize)+1;var r2=parseInt(r1)+parseInt(p.pageSize)-1;if(!p.total){p.total=0}if(p.total<r2){r2=p.total}if(!p.total){r1=r2=0}if(r1<0){r1=0}if(r2<0){r2=0}var stat=p.pageStatMessage;stat=stat.replace(/{from}/,r1);stat=stat.replace(/{to}/,r2);stat=stat.replace(/{total}/,p.total);stat=stat.replace(/{pagesize}/,p.pageSize);$(".l-bar-text",g.toolbar).html(stat);if(!p.total){$(".l-bar-btnfirst span,.l-bar-btnprev span,.l-bar-btnnext span,.l-bar-btnlast span",g.toolbar).addClass("l-disabled")}if(p.page==1){$(".l-bar-btnfirst span",g.toolbar).addClass("l-disabled");$(".l-bar-btnprev span",g.toolbar).addClass("l-disabled")}else{if(p.page>p.pageCount&&p.pageCount>0){$(".l-bar-btnfirst span",g.toolbar).removeClass("l-disabled");$(".l-bar-btnprev span",g.toolbar).removeClass("l-disabled")}}if(p.page==p.pageCount){$(".l-bar-btnlast span",g.toolbar).addClass("l-disabled");$(".l-bar-btnnext span",g.toolbar).addClass("l-disabled")}else{if(p.page<p.pageCount&&p.pageCount>0){$(".l-bar-btnlast span",g.toolbar).removeClass("l-disabled");$(".l-bar-btnnext span",g.toolbar).removeClass("l-disabled")}}},_getRowIdByDomId:function(domid){var ids=domid.split("|");var rowid=ids[2];return rowid},_getRowByDomId:function(domid){return this.records[this._getRowIdByDomId(domid)]},_getSrcElementByEvent:function(e){var g=this;var obj=(e.target||e.srcElement);var jobjs=$(obj).parents().add(obj);var fn=function(parm){for(var i=0,l=jobjs.length;i<l;i++){if(typeof parm=="string"){if($(jobjs[i]).hasClass(parm)){return jobjs[i]}}else{if(typeof parm=="object"){if(jobjs[i]==parm){return jobjs[i]}}}}return null};if(fn("l-grid-editor")){return{editing:true,editor:fn("l-grid-editor")}}if(jobjs.index(this.element)==-1){return{out:true}}var indetail=false;if(jobjs.hasClass("l-grid-detailpanel")&&g.detailrows){for(var i=0,l=g.detailrows.length;i<l;i++){if(jobjs.index(g.detailrows[i])!=-1){indetail=true;break}}}var r={grid:fn("l-panel"),indetail:indetail,frozen:fn(g.gridview1[0])?true:false,header:fn("l-panel-header"),gridheader:fn("l-grid-header"),gridbody:fn("l-grid-body"),total:fn("l-panel-bar-total"),popup:fn("l-grid-popup"),toolbar:fn("l-panel-bar")};if(r.gridheader){r.hrow=fn("l-grid-hd-row");r.hcell=fn("l-grid-hd-cell");r.hcelltext=fn("l-grid-hd-cell-text");r.checkboxall=fn("l-grid-hd-cell-checkbox");if(r.hcell){var columnid=r.hcell.id.split("|")[2];r.column=g._columns[columnid]}}if(r.gridbody){r.row=fn("l-grid-row");r.cell=fn("l-grid-row-cell");r.checkbox=fn("l-grid-row-cell-btn-checkbox");r.groupbtn=fn("l-grid-group-togglebtn");r.grouprow=fn("l-grid-grouprow");r.detailbtn=fn("l-grid-row-cell-detailbtn");r.detailrow=fn("l-grid-detailpanel");r.totalrow=fn("l-grid-totalsummary");r.totalcell=fn("l-grid-totalsummary-cell");r.rownumberscell=$(r.cell).hasClass("l-grid-row-cell-rownumbers")?r.cell:null;r.detailcell=$(r.cell).hasClass("l-grid-row-cell-detail")?r.cell:null;r.checkboxcell=$(r.cell).hasClass("l-grid-row-cell-checkbox")?r.cell:null;r.treelink=fn("l-grid-tree-link");r.editor=fn("l-grid-editor");if(r.row){r.data=this._getRowByDomId(r.row.id)}if(r.cell){r.editing=$(r.cell).hasClass("l-grid-row-cell-editing")}if(r.editor){r.editing=true}if(r.editing){r.out=false}}if(r.toolbar){r.first=fn("l-bar-btnfirst");r.last=fn("l-bar-btnlast");r.next=fn("l-bar-btnnext");r.prev=fn("l-bar-btnprev");r.load=fn("l-bar-btnload");r.button=fn("l-bar-button")}return r},_setEvent:function(){var g=this,p=this.options;g.grid.bind("mousedown.grid",function(e){g._onMouseDown.call(g,e)});g.grid.bind("dblclick.grid",function(e){g._onDblClick.call(g,e)});g.grid.bind("contextmenu.grid",function(e){return g._onContextmenu.call(g,e)});$(document).bind("mouseup.grid",function(e){g._onMouseUp.call(g,e)});$(document).bind("click.grid",function(e){g._onClick.call(g,e)});$(window).bind("resize.grid",function(e){g._onResize.call(g)});$(document).bind("keydown.grid",function(e){if(e.ctrlKey){g.ctrlKey=true}});$(document).bind("keyup.grid",function(e){delete g.ctrlKey;if(e.keyCode==13){if(g.editor&&g.editor.editing){var c=g._getNextEditCell(g.editor);if(c){$(c).click();g.editor.input.focus()}}}});g.gridbody.bind("scroll.grid",function(){var scrollLeft=g.gridbody.scrollLeft();var scrollTop=g.gridbody.scrollTop();if(scrollLeft!=null){g.gridheader[0].scrollLeft=scrollLeft}if(scrollTop!=null){g.f.gridbody[0].scrollTop=scrollTop}g.endEdit();g.trigger("SysGridHeightChanged")});$("select",g.toolbar).change(function(){if(g.isDataChanged&&!confirm(p.isContinueByDataChanged)){return false}p.newPage=1;p.pageSize=this.value;g.loadData(p.where)});$("span.pcontrol :text",g.toolbar).blur(function(e){g.changePage("input")});$("div.l-bar-button",g.toolbar).hover(function(){$(this).addClass("l-bar-button-over")},function(){$(this).removeClass("l-bar-button-over")});if($.fn.ligerDrag&&p.colDraggable){g.colDroptip=$("<div class='l-drag-coldroptip' style='display:none'><div class='l-drop-move-up'></div><div class='l-drop-move-down'></div></div>").appendTo("body");g.gridheader.add(g.f.gridheader).ligerDrag({revert:true,animate:false,proxyX:0,proxyY:0,proxy:function(draggable,e){var src=g._getSrcElementByEvent(e);if(src.hcell&&src.column){var content=$(".l-grid-hd-cell-text:first",src.hcell).html();var proxy=$("<div class='l-drag-proxy' style='display:none'><div class='l-drop-icon l-drop-no'></div></div>").appendTo("body");proxy.append(content);return proxy}},onRevert:function(){return false},onRendered:function(){this.set("cursor","default");g.children[this.id]=this},onStartDrag:function(current,e){if(e.button==2){return false}if(g.colresizing){return false}this.set("cursor","default");var src=g._getSrcElementByEvent(e);if(!src.hcell||!src.column||src.column.issystem||src.hcelltext){return false}if($(src.hcell).css("cursor").indexOf("resize")!=-1){return false}this.draggingColumn=src.column;g.coldragging=true;var gridOffset=g.grid.offset();this.validRange={top:gridOffset.top,bottom:gridOffset.top+g.gridheader.height(),left:gridOffset.left-10,right:gridOffset.left+g.grid.width()+10}},onDrag:function(current,e){this.set("cursor","default");var column=this.draggingColumn;if(!column){return false}if(g.colresizing){return false}if(g.colDropIn==null){g.colDropIn=-1}var pageX=e.pageX;var pageY=e.pageY;var visit=false;var gridOffset=g.grid.offset();var validRange=this.validRange;if(pageX<validRange.left||pageX>validRange.right||pageY>validRange.bottom||pageY<validRange.top){g.colDropIn=-1;g.colDroptip.hide();this.proxy.find(".l-drop-icon:first").removeClass("l-drop-yes").addClass("l-drop-no");return}for(var colid in g._columns){var col=g._columns[colid];if(column==col){visit=true;continue}if(col.issystem){continue}var sameLevel=col["__level"]==column["__level"];var isAfter=!sameLevel?false:visit?true:false;if(column.frozen!=col.frozen){isAfter=col.frozen?false:true}if(g.colDropIn!=-1&&g.colDropIn!=colid){continue}var cell=document.getElementById(col["__domid"]);var offset=$(cell).offset();var range={top:offset.top,bottom:offset.top+$(cell).height(),left:offset.left-10,right:offset.left+10};if(isAfter){var cellwidth=$(cell).width();range.left+=cellwidth;range.right+=cellwidth}if(pageX>range.left&&pageX<range.right&&pageY>range.top&&pageY<range.bottom){var height=p.headerRowHeight;if(col["__rowSpan"]){height*=col["__rowSpan"]}g.colDroptip.css({left:range.left+5,top:range.top-9,height:height+9*2}).show();g.colDropIn=colid;g.colDropDir=isAfter?"right":"left";this.proxy.find(".l-drop-icon:first").removeClass("l-drop-no").addClass("l-drop-yes");break}else{if(g.colDropIn!=-1){g.colDropIn=-1;g.colDroptip.hide();this.proxy.find(".l-drop-icon:first").removeClass("l-drop-yes").addClass("l-drop-no")}}}},onStopDrag:function(current,e){var column=this.draggingColumn;g.coldragging=false;if(g.colDropIn!=-1){g.changeCol.ligerDefer(g,0,[column,g.colDropIn,g.colDropDir=="right"]);g.colDropIn=-1}g.colDroptip.hide();this.set("cursor","default")}})}if($.fn.ligerDrag&&p.rowDraggable){g.rowDroptip=$("<div class='l-drag-rowdroptip' style='display:none'></div>").appendTo("body");g.gridbody.add(g.f.gridbody).ligerDrag({revert:true,animate:false,proxyX:0,proxyY:0,proxy:function(draggable,e){var src=g._getSrcElementByEvent(e);if(src.row){var content=p.draggingMessage.replace(/{count}/,draggable.draggingRows?draggable.draggingRows.length:1);if(p.rowDraggingRender){content=p.rowDraggingRender(draggable.draggingRows,draggable,g)}var proxy=$("<div class='l-drag-proxy' style='display:none'><div class='l-drop-icon l-drop-no'></div>"+content+"</div>").appendTo("body");return proxy}},onRevert:function(){return false},onRendered:function(){this.set("cursor","default");g.children[this.id]=this},onStartDrag:function(current,e){if(e.button==2){return false}if(g.colresizing){return false}if(!g.columns.length){return false}this.set("cursor","default");var src=g._getSrcElementByEvent(e);if(!src.cell||!src.data||src.checkbox){return false}var ids=src.cell.id.split("|");var column=g._columns[ids[ids.length-1]];if(src.rownumberscell||src.detailcell||src.checkboxcell||column==g.columns[0]){if(g.enabledCheckbox()){this.draggingRows=g.getSelecteds();if(!this.draggingRows||!this.draggingRows.length){return false}}else{this.draggingRows=[src.data]}this.draggingRow=src.data;this.set("cursor","move");g.rowdragging=true;this.validRange={top:g.gridbody.offset().top,bottom:g.gridbody.offset().top+g.gridbody.height(),left:g.grid.offset().left-10,right:g.grid.offset().left+g.grid.width()+10}}else{return false}},onDrag:function(current,e){var rowdata=this.draggingRow;if(!rowdata){return false}var rows=this.draggingRows?this.draggingRows:[rowdata];if(g.colresizing){return false}if(g.rowDropIn==null){g.rowDropIn=-1}var pageX=e.pageX;var pageY=e.pageY;var visit=false;var validRange=this.validRange;if(pageX<validRange.left||pageX>validRange.right||pageY>validRange.bottom||pageY<validRange.top){g.rowDropIn=-1;g.rowDroptip.hide();this.proxy.find(".l-drop-icon:first").removeClass("l-drop-yes l-drop-add").addClass("l-drop-no");return}for(var i in g.rows){var rd=g.rows[i];var rowid=rd["__id"];if(rowdata==rd){visit=true}if($.inArray(rd,rows)!=-1){continue}var isAfter=visit?true:false;if(g.rowDropIn!=-1&&g.rowDropIn!=rowid){continue}var rowobj=g.getRowObj(rowid);var offset=$(rowobj).offset();var range={top:offset.top-4,bottom:offset.top+$(rowobj).height()+4,left:g.grid.offset().left,right:g.grid.offset().left+g.grid.width()};if(pageX>range.left&&pageX<range.right&&pageY>range.top&&pageY<range.bottom){var lineTop=offset.top;if(isAfter){lineTop+=$(rowobj).height()}g.rowDroptip.css({left:range.left,top:lineTop,width:range.right-range.left}).show();g.rowDropIn=rowid;g.rowDropDir=isAfter?"bottom":"top";if(p.tree&&pageY>range.top+5&&pageY<range.bottom-5){this.proxy.find(".l-drop-icon:first").removeClass("l-drop-no l-drop-yes").addClass("l-drop-add");g.rowDroptip.hide();g.rowDropInParent=true}else{this.proxy.find(".l-drop-icon:first").removeClass("l-drop-no l-drop-add").addClass("l-drop-yes");g.rowDroptip.show();g.rowDropInParent=false}break}else{if(g.rowDropIn!=-1){g.rowDropIn=-1;g.rowDropInParent=false;g.rowDroptip.hide();this.proxy.find(".l-drop-icon:first").removeClass("l-drop-yes  l-drop-add").addClass("l-drop-no")}}}},onStopDrag:function(current,e){var rows=this.draggingRows;g.rowdragging=false;for(var i=0;i<rows.length;i++){var children=rows[i].children;if(children){rows=$.grep(rows,function(node,i){var isIn=$.inArray(node,children)==-1;return isIn})}}if(g.rowDropIn!=-1){if(p.tree){var neardata,prow;if(g.rowDropInParent){prow=g.getRow(g.rowDropIn)}else{neardata=g.getRow(g.rowDropIn);prow=g.getParent(neardata)}g.appendRange(rows,prow,neardata,g.rowDropDir!="bottom");g.trigger("rowDragDrop",{rows:rows,parent:prow,near:neardata,after:g.rowDropDir=="bottom"})}else{g.moveRange(rows,g.rowDropIn,g.rowDropDir=="bottom");g.trigger("rowDragDrop",{rows:rows,parent:prow,near:g.getRow(g.rowDropIn),after:g.rowDropDir=="bottom"})}g.rowDropIn=-1}g.rowDroptip.hide();this.set("cursor","default")}})}},_onRowOver:function(rowParm,over){if(l.draggable.dragging){return}var g=this,p=this.options;var rowdata=g.getRow(rowParm);var methodName=over?"addClass":"removeClass";if(g.enabledFrozen()){$(g.getRowObj(rowdata,true))[methodName](p.mouseoverRowCssClass)}$(g.getRowObj(rowdata,false))[methodName](p.mouseoverRowCssClass)},_onMouseUp:function(e){var g=this,p=this.options;if(l.draggable.dragging){var src=g._getSrcElementByEvent(e);if(src.hcell&&src.column){g.trigger("dragdrop",[{type:"header",column:src.column,cell:src.hcell},e])}else{if(src.row){g.trigger("dragdrop",[{type:"row",record:src.data,row:src.row},e])}}}},_onMouseDown:function(e){var g=this,p=this.options},_onContextmenu:function(e){var g=this,p=this.options;var src=g._getSrcElementByEvent(e);if(src.row){if(p.whenRClickToSelect){g.select(src.data)}if(g.hasBind("contextmenu")){return g.trigger("contextmenu",[{data:src.data,rowindex:src.data["__index"],row:src.row},e])}}else{if(src.hcell){if(!p.allowHideColumn){return true}var columnindex=$(src.hcell).attr("columnindex");if(columnindex==undefined){return true}var left=(e.pageX-g.body.offset().left+parseInt(g.body[0].scrollLeft));if(columnindex==g.columns.length-1){left-=50}g.popup.css({left:left,top:g.gridheader.height()+1});g.popup.toggle();return false}}},_onDblClick:function(e){var g=this,p=this.options;var src=g._getSrcElementByEvent(e);if(src.row){g.trigger("dblClickRow",[src.data,src.data["__id"],src.row])}},_onClick:function(e){var obj=(e.target||e.srcElement);var g=this,p=this.options;var src=g._getSrcElementByEvent(e);if(src.out){if(g.editor.editing&&!$.ligerui.win.masking){g.endEdit()}if(p.allowHideColumn){g.popup.hide()}return}if(src.indetail||src.editing){return}if(g.editor.editing){g.endEdit()}if(p.allowHideColumn){if(!src.popup){g.popup.hide()}}if(src.checkboxall){var row=$(src.hrow);var uncheck=row.hasClass("l-checked");if(g.trigger("beforeCheckAllRow",[!uncheck,g.element])==false){return false}if(uncheck){row.removeClass("l-checked")}else{row.addClass("l-checked")}g.selected=[];for(var rowid in g.records){if(uncheck){g.unselect(g.records[rowid])}else{g.select(g.records[rowid])}}g.trigger("checkAllRow",[!uncheck,g.element])}else{if(src.hcelltext){var hcell=$(src.hcelltext).parent().parent();if(!p.enabledSort||!src.column){return}if(src.column.isSort==false){return}if(p.url&&g.isDataChanged&&!confirm(p.isContinueByDataChanged)){return}var sort=$(".l-grid-hd-cell-sort:first",hcell);var columnName=src.column.name;if(!columnName){return}if(sort.length>0){if(sort.hasClass("l-grid-hd-cell-sort-asc")){sort.removeClass("l-grid-hd-cell-sort-asc").addClass("l-grid-hd-cell-sort-desc");hcell.removeClass("l-grid-hd-cell-asc").addClass("l-grid-hd-cell-desc");g.changeSort(columnName,"desc")}else{if(sort.hasClass("l-grid-hd-cell-sort-desc")){sort.removeClass("l-grid-hd-cell-sort-desc").addClass("l-grid-hd-cell-sort-asc");hcell.removeClass("l-grid-hd-cell-desc").addClass("l-grid-hd-cell-asc");g.changeSort(columnName,"asc")}}}else{hcell.removeClass("l-grid-hd-cell-desc").addClass("l-grid-hd-cell-asc");$(src.hcelltext).after("<span class='l-grid-hd-cell-sort l-grid-hd-cell-sort-asc'>&nbsp;&nbsp;</span>");g.changeSort(columnName,"asc")}$(".l-grid-hd-cell-sort",g.gridheader).add($(".l-grid-hd-cell-sort",g.f.gridheader)).not($(".l-grid-hd-cell-sort:first",hcell)).remove()}else{if(src.detailbtn&&p.detail){var item=src.data;var row=$([g.getRowObj(item,false)]);if(g.enabledFrozen()){row=row.add(g.getRowObj(item,true))}var rowid=item["__id"];if($(src.detailbtn).hasClass("l-open")){if(p.detail.onCollapse){p.detail.onCollapse(item,$(".l-grid-detailpanel-inner:first",nextrow)[0])}row.next("tr.l-grid-detailpanel").hide();$(src.detailbtn).removeClass("l-open")}else{var nextrow=row.next("tr.l-grid-detailpanel");if(nextrow.length>0){nextrow.show();if(p.detail.onExtend){p.detail.onExtend(item,$(".l-grid-detailpanel-inner:first",nextrow)[0])}$(src.detailbtn).addClass("l-open");g.trigger("SysGridHeightChanged");return}$(src.detailbtn).addClass("l-open");var frozenColNum=0;for(var i=0;i<g.columns.length;i++){if(g.columns[i].frozen){frozenColNum++}}var detailRow=$("<tr class='l-grid-detailpanel'><td><div class='l-grid-detailpanel-inner' style='display:none'></div></td></tr>");var detailFrozenRow=$("<tr class='l-grid-detailpanel'><td><div class='l-grid-detailpanel-inner' style='display:none'></div></td></tr>");detailRow.attr("id",g.id+"|detail|"+rowid);g.detailrows=g.detailrows||[];g.detailrows.push(detailRow[0]);g.detailrows.push(detailFrozenRow[0]);var detailRowInner=$("div:first",detailRow);detailRowInner.parent().attr("colSpan",g.columns.length-frozenColNum);row.eq(0).after(detailRow);if(frozenColNum>0){detailFrozenRow.find("td:first").attr("colSpan",frozenColNum);row.eq(1).after(detailFrozenRow)}if(p.detail.onShowDetail){p.detail.onShowDetail(item,detailRowInner[0],function(){g.trigger("SysGridHeightChanged")});$("div:first",detailFrozenRow).add(detailRowInner).show().height(p.detail.height||p.detailHeight)}else{if(p.detail.render){detailRowInner.append(p.detail.render());detailRowInner.show()}}g.trigger("SysGridHeightChanged")}}else{if(src.groupbtn){var grouprow=$(src.grouprow);var opening=true;if($(src.groupbtn).hasClass("l-grid-group-togglebtn-close")){$(src.groupbtn).removeClass("l-grid-group-togglebtn-close");if(grouprow.hasClass("l-grid-grouprow-last")){$("td:first",grouprow).width("auto")}}else{opening=false;$(src.groupbtn).addClass("l-grid-group-togglebtn-close");if(grouprow.hasClass("l-grid-grouprow-last")){$("td:first",grouprow).width(g.gridtablewidth)}}var currentRow=grouprow.next(".l-grid-row,.l-grid-totalsummary-group,.l-grid-detailpanel");while(true){if(currentRow.length==0){break}if(opening){currentRow.show();if(currentRow.hasClass("l-grid-detailpanel")&&!currentRow.prev().find("td.l-grid-row-cell-detail:first span.l-grid-row-cell-detailbtn:first").hasClass("l-open")){currentRow.hide()}}else{currentRow.hide()}currentRow=currentRow.next(".l-grid-row,.l-grid-totalsummary-group,.l-grid-detailpanel")}g.trigger("SysGridHeightChanged")}else{if(src.treelink){g.toggle(src.data)}else{if(src.row&&g.enabledCheckbox()){var selectRowButtonOnly=p.selectRowButtonOnly?true:false;if(p.enabledEdit){selectRowButtonOnly=true}if(src.checkbox||!selectRowButtonOnly){var row=$(src.row);var uncheck=row.hasClass("l-selected");if(g.trigger("beforeCheckRow",[!uncheck,src.data,src.data["__id"],src.row])==false){return false}var met=uncheck?"unselect":"select";g[met](src.data);if(p.tree&&p.autoCheckChildren){var children=g.getChildren(src.data,true);for(var i=0,l=children.length;i<l;i++){g[met](children[i])}}g.trigger("checkRow",[!uncheck,src.data,src.data["__id"],src.row])}if(!src.checkbox&&src.cell&&p.enabledEdit&&p.clickToEdit){g._applyEditor(src.cell)}}else{if(src.row&&!g.enabledCheckbox()){if(src.cell&&p.enabledEdit&&p.clickToEdit){g._applyEditor(src.cell)}if($(src.row).hasClass("l-selected")){if(!p.allowUnSelectRow){$(src.row).addClass("l-selected-again");return}if(e.ctrlKey){g.unselect(src.data)}}else{g.select(src.data)}}else{if(src.toolbar){if(src.first){if(g.trigger("toFirst",[g.element])==false){return false}g.changePage("first")}else{if(src.prev){if(g.trigger("toPrev",[g.element])==false){return false}g.changePage("prev")}else{if(src.next){if(g.trigger("toNext",[g.element])==false){return false}g.changePage("next")}else{if(src.last){if(g.trigger("toLast",[g.element])==false){return false}g.changePage("last")}else{if(src.load){if($("span",src.load).hasClass("l-disabled")){return false}if(g.trigger("reload",[g.element])==false){return false}if(p.url&&g.isDataChanged&&!confirm(p.isContinueByDataChanged)){return false}g.loadData(p.where)}}}}}}}}}}}}}},select:function(rowParm){var g=this,p=this.options;var rowdata=g.getRow(rowParm);if(null==rowdata){return}var rowid=rowdata["__id"];var rowobj=g.getRowObj(rowid);var rowobj1=g.getRowObj(rowid,true);if(!g.enabledCheckbox()&&!g.ctrlKey){for(var i in g.selected){var o=g.selected[i];if(o["__id"] in g.records){$(g.getRowObj(o)).removeClass("l-selected l-selected-again");if(g.enabledFrozen()){$(g.getRowObj(o,true)).removeClass("l-selected l-selected-again")}}}g.selected=[]}if(rowobj){$(rowobj).addClass("l-selected")}if(rowobj1){$(rowobj1).addClass("l-selected")}g.selected[g.selected.length]=rowdata;g.trigger("selectRow",[rowdata,rowid,rowobj])},unselect:function(rowParm){var g=this,p=this.options;var rowdata=g.getRow(rowParm);var rowid=rowdata["__id"];var rowobj=g.getRowObj(rowid);var rowobj1=g.getRowObj(rowid,true);$(rowobj).removeClass("l-selected l-selected-again");if(g.enabledFrozen()){$(rowobj1).removeClass("l-selected l-selected-again")}g._removeSelected(rowdata);g.trigger("unSelectRow",[rowdata,rowid,rowobj])},isSelected:function(rowParm){var g=this,p=this.options;var rowdata=g.getRow(rowParm);for(var i in g.selected){if(g.selected[i]==rowdata){return true}}return false},_onResize:function(){var g=this,p=this.options;if(p.height&&p.height!="auto"){var windowHeight=$(window).height();var h=0;var parentHeight=null;if(typeof(p.height)=="string"&&p.height.indexOf("%")>0){var gridparent=g.grid.parent();if(p.InWindow){parentHeight=windowHeight;parentHeight-=parseInt($("body").css("paddingTop"));parentHeight-=parseInt($("body").css("paddingBottom"))}else{parentHeight=gridparent.height()}h=parentHeight*parseFloat(p.height)*0.01;if(p.InWindow||gridparent[0].tagName.toLowerCase()=="body"){h-=(g.grid.offset().top-parseInt($("body").css("paddingTop")))}}else{h=parseInt(p.height)}h+=p.heightDiff;g.windowHeight=windowHeight;g._setHeight(h)}if(g.enabledFrozen()){var gridView1Width=g.gridview1.width();var gridViewWidth=g.gridview.width();g.gridview2.css({width:gridViewWidth-gridView1Width})}g.trigger("SysGridHeightChanged")},_getNextEditCell:function(editor){if(editor&&editor.editing){var g=this,p=this.options;var editParam=editor.editParm;var ce;var columns=g.getColumns();for(var i=0;i<columns.length;i++){if(columns[i]["__id"]==editParam.column["__id"]){if(i<columns.length-1){if(columns[i+1].editor){ce=g.getCellObj(editParam.record,columns[i+1]);break}}}}if(ce==null){var rowindex=editParam.record["__index"];if(rowindex<g.getData().length-1){var v=g.getRowObj(rowindex+1);for(var i=0;i<columns.length;i++){if(columns[i].editor){ce=g.getCellObj(v,columns[i]);break}}}}return ce}return null}});$.ligerui.controls.Grid.prototype.enabledTotal=$.ligerui.controls.Grid.prototype.isTotalSummary;$.ligerui.controls.Grid.prototype.add=$.ligerui.controls.Grid.prototype.addRow;$.ligerui.controls.Grid.prototype.update=$.ligerui.controls.Grid.prototype.updateRow;$.ligerui.controls.Grid.prototype.append=$.ligerui.controls.Grid.prototype.appendRow;$.ligerui.controls.Grid.prototype.getSelected=$.ligerui.controls.Grid.prototype.getSelectedRow;$.ligerui.controls.Grid.prototype.getSelecteds=$.ligerui.controls.Grid.prototype.getSelectedRows;$.ligerui.controls.Grid.prototype.getCheckedRows=$.ligerui.controls.Grid.prototype.getSelectedRows;$.ligerui.controls.Grid.prototype.getCheckedRowObjs=$.ligerui.controls.Grid.prototype.getSelectedRowObjs;$.ligerui.controls.Grid.prototype.setOptions=$.ligerui.controls.Grid.prototype.set})(jQuery);(function(A){A.fn.ligerLayout=function(B){return A.ligerui.run.call(this,"ligerLayout",arguments)};A.fn.ligerGetLayoutManager=function(){return A.ligerui.run.call(this,"ligerGetLayoutManager",arguments)};A.ligerDefaults.Layout={topHeight:50,bottomHeight:50,leftWidth:110,centerWidth:300,rightWidth:170,InWindow:true,heightDiff:0,height:"100%",onHeightChanged:null,isLeftCollapse:false,isRightCollapse:false,allowLeftCollapse:true,allowRightCollapse:true,allowLeftResize:true,allowRightResize:true,allowTopResize:true,allowBottomResize:true,space:3,onEndResize:null,minLeftWidth:80,minRightWidth:80};A.ligerMethos.Layout={};A.ligerui.controls.Layout=function(C,B){A.ligerui.controls.Layout.base.constructor.call(this,C,B)};A.ligerui.controls.Layout.ligerExtend(A.ligerui.core.UIComponent,{__getType:function(){return"Layout"},__idPrev:function(){return"Layout"},_extendMethods:function(){return A.ligerMethos.Layout},_render:function(){var B=this,D=this.options;B.layout=A(this.element);B.layout.addClass("l-layout");B.width=B.layout.width();if(A("> div[position=top]",B.layout).length>0){B.top=A("> div[position=top]",B.layout).wrap('<div class="l-layout-top" style="top:0px;"></div>').parent();B.top.content=A("> div[position=top]",B.top);if(!B.top.content.hasClass("l-layout-content")){B.top.content.addClass("l-layout-content")}B.topHeight=D.topHeight;if(B.topHeight){B.top.height(B.topHeight)}}if(A("> div[position=bottom]",B.layout).length>0){B.bottom=A("> div[position=bottom]",B.layout).wrap('<div class="l-layout-bottom"></div>').parent();B.bottom.content=A("> div[position=bottom]",B.bottom);if(!B.bottom.content.hasClass("l-layout-content")){B.bottom.content.addClass("l-layout-content")}B.bottomHeight=D.bottomHeight;if(B.bottomHeight){B.bottom.height(B.bottomHeight)}var F=B.bottom.content.attr("title");if(F){B.bottom.header=A('<div class="l-layout-header"></div>');B.bottom.prepend(B.bottom.header);B.bottom.header.html(F);B.bottom.content.attr("title","")}}if(A("> div[position=left]",B.layout).length>0){B.left=A("> div[position=left]",B.layout).wrap('<div class="l-layout-left" style="left:0px;"></div>').parent();B.left.content=A("> div[position=left]",B.left);if(!B.left.content.hasClass("l-layout-content")){B.left.content.addClass("l-layout-content")}if(!D.allowLeftCollapse){A(".l-layout-header-toggle",B.left.header).remove()}var E=B.left.content.attr("title");if(E){B.left.header=A('<div class="l-layout-header"><div class="l-layout-header-toggle"></div><div class="l-layout-header-inner"></div></div>');B.left.prepend(B.left.header);B.left.header.toggle=A(".l-layout-header-toggle",B.left.header);if(!D.allowLeftCollapse){A(".l-layout-header-toggle",B.left.header).remove()}B.left.content.attr("title","");A(".l-layout-header-inner",B.left.header).html(E)}B.leftWidth=D.leftWidth;if(B.leftWidth){B.left.width(B.leftWidth)}}if(A("> div[position=center]",B.layout).length>0){B.center=A("> div[position=center]",B.layout).wrap('<div class="l-layout-center" ></div>').parent();B.center.content=A("> div[position=center]",B.center);B.center.content.addClass("l-layout-content");var C=B.center.content.attr("title");if(C){B.center.content.attr("title","");B.center.header=A('<div class="l-layout-header"></div>');B.center.prepend(B.center.header);B.center.header.html(C)}B.centerWidth=D.centerWidth;if(B.centerWidth){B.center.width(B.centerWidth)}}if(A("> div[position=right]",B.layout).length>0){B.right=A("> div[position=right]",B.layout).wrap('<div class="l-layout-right"></div>').parent();B.right.header=A('<div class="l-layout-header"><div class="l-layout-header-toggle"></div><div class="l-layout-header-inner"></div></div>');B.right.prepend(B.right.header);B.right.header.toggle=A(".l-layout-header-toggle",B.right.header);if(!D.allowRightCollapse){A(".l-layout-header-toggle",B.right.header).remove()}B.right.content=A("> div[position=right]",B.right);if(!B.right.content.hasClass("l-layout-content")){B.right.content.addClass("l-layout-content")}var G=B.right.content.attr("title");if(G){B.right.content.attr("title","");A(".l-layout-header-inner",B.right.header).html(G)}B.rightWidth=D.rightWidth;if(B.rightWidth){B.right.width(B.rightWidth)}}B.layout.lock=A("<div class='l-layout-lock'></div>");B.layout.append(B.layout.lock);B._addDropHandle();B.isLeftCollapse=D.isLeftCollapse;B.isRightCollapse=D.isRightCollapse;B.leftCollapse=A('<div class="l-layout-collapse-left" style="display: none; "><div class="l-layout-collapse-left-toggle"></div></div>');B.rightCollapse=A('<div class="l-layout-collapse-right" style="display: none; "><div class="l-layout-collapse-right-toggle"></div></div>');B.layout.append(B.leftCollapse).append(B.rightCollapse);B.leftCollapse.toggle=A("> .l-layout-collapse-left-toggle",B.leftCollapse);B.rightCollapse.toggle=A("> .l-layout-collapse-right-toggle",B.rightCollapse);B._setCollapse();B._bulid();A(window).resize(function(){B._onResize()});B.set(D)},setLeftCollapse:function(D){var B=this,C=this.options;if(!B.left){return false}B.isLeftCollapse=D;if(B.isLeftCollapse){B.leftCollapse.show();B.leftDropHandle&&B.leftDropHandle.hide();B.left.hide()}else{B.leftCollapse.hide();B.leftDropHandle&&B.leftDropHandle.show();B.left.show()}B._onResize()},setRightCollapse:function(D){var B=this,C=this.options;if(!B.right){return false}B.isRightCollapse=D;B._onResize();if(B.isRightCollapse){B.rightCollapse.show();B.rightDropHandle&&B.rightDropHandle.hide();B.right.hide()}else{B.rightCollapse.hide();B.rightDropHandle&&B.rightDropHandle.show();B.right.show()}B._onResize()},_bulid:function(){var B=this,C=this.options;A("> .l-layout-left .l-layout-header,> .l-layout-right .l-layout-header",B.layout).hover(function(){A(this).addClass("l-layout-header-over")},function(){A(this).removeClass("l-layout-header-over")});A(".l-layout-header-toggle",B.layout).hover(function(){A(this).addClass("l-layout-header-toggle-over")},function(){A(this).removeClass("l-layout-header-toggle-over")});A(".l-layout-header-toggle",B.left).click(function(){B.setLeftCollapse(true)});A(".l-layout-header-toggle",B.right).click(function(){B.setRightCollapse(true)});B.middleTop=0;if(B.top){B.middleTop+=B.top.height();B.middleTop+=parseInt(B.top.css("borderTopWidth"));B.middleTop+=parseInt(B.top.css("borderBottomWidth"));B.middleTop+=C.space}if(B.left){B.left.css({top:B.middleTop});B.leftCollapse.css({top:B.middleTop})}if(B.center){B.center.css({top:B.middleTop})}if(B.right){B.right.css({top:B.middleTop});B.rightCollapse.css({top:B.middleTop})}if(B.left){B.left.css({left:0})}B._onResize();B._onResize()},_setCollapse:function(){var B=this,C=this.options;B.leftCollapse.hover(function(){A(this).addClass("l-layout-collapse-left-over")},function(){A(this).removeClass("l-layout-collapse-left-over")});B.leftCollapse.toggle.hover(function(){A(this).addClass("l-layout-collapse-left-toggle-over")},function(){A(this).removeClass("l-layout-collapse-left-toggle-over")});B.rightCollapse.hover(function(){A(this).addClass("l-layout-collapse-right-over")},function(){A(this).removeClass("l-layout-collapse-right-over")});B.rightCollapse.toggle.hover(function(){A(this).addClass("l-layout-collapse-right-toggle-over")},function(){A(this).removeClass("l-layout-collapse-right-toggle-over")});B.leftCollapse.toggle.click(function(){B.setLeftCollapse(false)});B.rightCollapse.toggle.click(function(){B.setRightCollapse(false)});if(B.left&&B.isLeftCollapse){B.leftCollapse.show();B.leftDropHandle&&B.leftDropHandle.hide();B.left.hide()}if(B.right&&B.isRightCollapse){B.rightCollapse.show();B.rightDropHandle&&B.rightDropHandle.hide();B.right.hide()}},_addDropHandle:function(){var B=this,C=this.options;if(B.left&&C.allowLeftResize){B.leftDropHandle=A("<div class='l-layout-drophandle-left'></div>");B.layout.append(B.leftDropHandle);B.leftDropHandle&&B.leftDropHandle.show();B.leftDropHandle.mousedown(function(D){B._start("leftresize",D)})}if(B.right&&C.allowRightResize){B.rightDropHandle=A("<div class='l-layout-drophandle-right'></div>");B.layout.append(B.rightDropHandle);B.rightDropHandle&&B.rightDropHandle.show();B.rightDropHandle.mousedown(function(D){B._start("rightresize",D)})}if(B.top&&C.allowTopResize){B.topDropHandle=A("<div class='l-layout-drophandle-top'></div>");B.layout.append(B.topDropHandle);B.topDropHandle.show();B.topDropHandle.mousedown(function(D){B._start("topresize",D)})}if(B.bottom&&C.allowBottomResize){B.bottomDropHandle=A("<div class='l-layout-drophandle-bottom'></div>");B.layout.append(B.bottomDropHandle);B.bottomDropHandle.show();B.bottomDropHandle.mousedown(function(D){B._start("bottomresize",D)})}B.draggingxline=A("<div class='l-layout-dragging-xline'></div>");B.draggingyline=A("<div class='l-layout-dragging-yline'></div>");B.layout.append(B.draggingxline).append(B.draggingyline)},_setDropHandlePosition:function(){var B=this,C=this.options;if(B.leftDropHandle){B.leftDropHandle.css({left:B.left.width()+parseInt(B.left.css("left")),height:B.middleHeight,top:B.middleTop})}if(B.rightDropHandle){B.rightDropHandle.css({left:parseInt(B.right.css("left"))-C.space,height:B.middleHeight,top:B.middleTop})}if(B.topDropHandle){B.topDropHandle.css({top:B.top.height()+parseInt(B.top.css("top")),width:B.top.width()})}if(B.bottomDropHandle){B.bottomDropHandle.css({top:parseInt(B.bottom.css("top"))-C.space,width:B.bottom.width()})}},_onResize:function(){var I=this,C=this.options;var E=I.layout.height();var F=0;var D=A(window).height();var B=null;if(typeof(C.height)=="string"&&C.height.indexOf("%")>0){var H=I.layout.parent();if(C.InWindow||H[0].tagName.toLowerCase()=="body"){B=D;B-=parseInt(A("body").css("paddingTop"));B-=parseInt(A("body").css("paddingBottom"))}else{B=H.height()}F=B*parseFloat(C.height)*0.01;if(C.InWindow||H[0].tagName.toLowerCase()=="body"){F-=(I.layout.offset().top-parseInt(A("body").css("paddingTop")))}}else{F=parseInt(C.height)}F+=C.heightDiff;I.layout.height(F);I.layoutHeight=I.layout.height();I.middleWidth=I.layout.width();I.middleHeight=I.layout.height();if(I.top){I.middleHeight-=I.top.height();I.middleHeight-=parseInt(I.top.css("borderTopWidth"));I.middleHeight-=parseInt(I.top.css("borderBottomWidth"));I.middleHeight-=C.space}if(I.bottom){I.middleHeight-=I.bottom.height();I.middleHeight-=parseInt(I.bottom.css("borderTopWidth"));I.middleHeight-=parseInt(I.bottom.css("borderBottomWidth"));I.middleHeight-=C.space}I.middleHeight-=2;if(I.hasBind("heightChanged")&&I.layoutHeight!=E){I.trigger("heightChanged",[{layoutHeight:I.layoutHeight,diff:I.layoutHeight-E,middleHeight:I.middleHeight}])}if(I.center){I.centerWidth=I.middleWidth;if(I.left){if(I.isLeftCollapse){I.centerWidth-=I.leftCollapse.width();I.centerWidth-=parseInt(I.leftCollapse.css("borderLeftWidth"));I.centerWidth-=parseInt(I.leftCollapse.css("borderRightWidth"));I.centerWidth-=parseInt(I.leftCollapse.css("left"));I.centerWidth-=C.space}else{I.centerWidth-=I.leftWidth;I.centerWidth-=parseInt(I.left.css("borderLeftWidth"));I.centerWidth-=parseInt(I.left.css("borderRightWidth"));I.centerWidth-=parseInt(I.left.css("left"));I.centerWidth-=C.space}}if(I.right){if(I.isRightCollapse){I.centerWidth-=I.rightCollapse.width();I.centerWidth-=parseInt(I.rightCollapse.css("borderLeftWidth"));I.centerWidth-=parseInt(I.rightCollapse.css("borderRightWidth"));I.centerWidth-=parseInt(I.rightCollapse.css("right"));I.centerWidth-=C.space}else{I.centerWidth-=I.rightWidth;I.centerWidth-=parseInt(I.right.css("borderLeftWidth"));I.centerWidth-=parseInt(I.right.css("borderRightWidth"));I.centerWidth-=C.space}}I.centerLeft=0;if(I.left){if(I.isLeftCollapse){I.centerLeft+=I.leftCollapse.width();I.centerLeft+=parseInt(I.leftCollapse.css("borderLeftWidth"));I.centerLeft+=parseInt(I.leftCollapse.css("borderRightWidth"));I.centerLeft+=parseInt(I.leftCollapse.css("left"));I.centerLeft+=C.space}else{I.centerLeft+=I.left.width();I.centerLeft+=parseInt(I.left.css("borderLeftWidth"));I.centerLeft+=parseInt(I.left.css("borderRightWidth"));I.centerLeft+=C.space}}I.center.css({left:I.centerLeft});I.center.width(I.centerWidth-5);I.center.height(I.middleHeight);var G=I.middleHeight;if(I.center.header){G-=I.center.header.height()}I.center.content.height(G)}if(I.left){I.leftCollapse.height(I.middleHeight);I.left.height(I.middleHeight)}if(I.right){I.rightCollapse.height(I.middleHeight);I.right.height(I.middleHeight);I.rightLeft=0;if(I.left){if(I.isLeftCollapse){I.rightLeft+=I.leftCollapse.width();I.rightLeft+=parseInt(I.leftCollapse.css("borderLeftWidth"));I.rightLeft+=parseInt(I.leftCollapse.css("borderRightWidth"));I.rightLeft+=C.space}else{I.rightLeft+=I.left.width();I.rightLeft+=parseInt(I.left.css("borderLeftWidth"));I.rightLeft+=parseInt(I.left.css("borderRightWidth"));I.rightLeft+=parseInt(I.left.css("left"));I.rightLeft+=C.space}}if(I.center){I.rightLeft+=I.center.width();I.rightLeft+=parseInt(I.center.css("borderLeftWidth"));I.rightLeft+=parseInt(I.center.css("borderRightWidth"));I.rightLeft+=C.space}I.right.css({left:I.rightLeft})}if(I.bottom){I.bottomTop=I.layoutHeight-I.bottom.height()-2;I.bottom.css({top:I.bottomTop})}I._setDropHandlePosition()},_start:function(E,C){var B=this,D=this.options;B.dragtype=E;if(E=="leftresize"||E=="rightresize"){B.xresize={startX:C.pageX};B.draggingyline.css({left:C.pageX-B.layout.offset().left,height:B.middleHeight,top:B.middleTop}).show();A("body").css("cursor","col-resize")}else{if(E=="topresize"||E=="bottomresize"){B.yresize={startY:C.pageY};B.draggingxline.css({top:C.pageY-B.layout.offset().top,width:B.layout.width()}).show();A("body").css("cursor","row-resize")}else{return}}B.layout.lock.width(B.layout.width());B.layout.lock.height(B.layout.height());B.layout.lock.show();if(A.browser.msie||A.browser.safari){A("body").bind("selectstart",function(){return false})}A(document).bind("mouseup",function(){B._stop.apply(B,arguments)});A(document).bind("mousemove",function(){B._drag.apply(B,arguments)})},_drag:function(C){var B=this,D=this.options;if(B.xresize){B.xresize.diff=C.pageX-B.xresize.startX;B.draggingyline.css({left:C.pageX-B.layout.offset().left});A("body").css("cursor","col-resize")}else{if(B.yresize){B.yresize.diff=C.pageY-B.yresize.startY;B.draggingxline.css({top:C.pageY-B.layout.offset().top});A("body").css("cursor","row-resize")}}},_stop:function(C){var B=this,D=this.options;var E;if(B.xresize&&B.xresize.diff!=undefined){E=B.xresize.diff;if(B.dragtype=="leftresize"){if(D.minLeftWidth){if(B.leftWidth+B.xresize.diff<D.minLeftWidth){return}}B.leftWidth+=B.xresize.diff;B.left.width(B.leftWidth);if(B.center){B.center.width(B.center.width()-B.xresize.diff).css({left:parseInt(B.center.css("left"))+B.xresize.diff})}else{if(B.right){B.right.width(B.left.width()-B.xresize.diff).css({left:parseInt(B.right.css("left"))+B.xresize.diff})}}}else{if(B.dragtype=="rightresize"){if(D.minRightWidth){if(B.rightWidth-B.xresize.diff<D.minRightWidth){return}}B.rightWidth-=B.xresize.diff;B.right.width(B.rightWidth).css({left:parseInt(B.right.css("left"))+B.xresize.diff});if(B.center){B.center.width(B.center.width()+B.xresize.diff)}else{if(B.left){B.left.width(B.left.width()+B.xresize.diff)}}}}}else{if(B.yresize&&B.yresize.diff!=undefined){E=B.yresize.diff;if(B.dragtype=="topresize"){B.top.height(B.top.height()+B.yresize.diff);B.middleTop+=B.yresize.diff;B.middleHeight-=B.yresize.diff;if(B.left){B.left.css({top:B.middleTop}).height(B.middleHeight);B.leftCollapse.css({top:B.middleTop}).height(B.middleHeight)}if(B.center){B.center.css({top:B.middleTop}).height(B.middleHeight)}if(B.right){B.right.css({top:B.middleTop}).height(B.middleHeight);B.rightCollapse.css({top:B.middleTop}).height(B.middleHeight)}}else{if(B.dragtype=="bottomresize"){B.bottom.height(B.bottom.height()-B.yresize.diff);B.middleHeight+=B.yresize.diff;B.bottomTop+=B.yresize.diff;B.bottom.css({top:B.bottomTop});if(B.left){B.left.height(B.middleHeight);B.leftCollapse.height(B.middleHeight)}if(B.center){B.center.height(B.middleHeight)}if(B.right){B.right.height(B.middleHeight);B.rightCollapse.height(B.middleHeight)}}}}}B.trigger("endResize",[{direction:B.dragtype?B.dragtype.replace(/resize/,""):"",diff:E},C]);B._setDropHandlePosition();B.draggingxline.hide();B.draggingyline.hide();B.xresize=B.yresize=B.dragtype=false;B.layout.lock.hide();if(A.browser.msie||A.browser.safari){A("body").unbind("selectstart")}A(document).unbind("mousemove",B._drag);A(document).unbind("mouseup",B._stop);A("body").css("cursor","")}})})(jQuery);(function(A){A.ligerMenu=function(B){return A.ligerui.run.call(null,"ligerMenu",arguments)};A.ligerDefaults.Menu={width:120,top:0,left:0,items:null,shadow:true};A.ligerMethos.Menu={};A.ligerui.controls.Menu=function(B){A.ligerui.controls.Menu.base.constructor.call(this,null,B)};A.ligerui.controls.Menu.ligerExtend(A.ligerui.core.UIComponent,{__getType:function(){return"Menu"},__idPrev:function(){return"Menu"},_extendMethods:function(){return A.ligerMethos.Menu},_render:function(){var B=this,C=this.options;B.menuItemCount=0;B.menus={};B.menu=B.createMenu();B.element=B.menu[0];B.menu.css({top:C.top,left:C.left,width:C.width});C.items&&A(C.items).each(function(D,E){B.addItem(E)});A(document).bind("click.menu",function(){for(var D in B.menus){var E=B.menus[D];if(!E){return}E.hide();if(E.shadow){E.shadow.hide()}}});B.set(C)},show:function(D,E){var B=this,C=this.options;if(E==undefined){E=B.menu}if(D&&D.left!=undefined){E.css({left:D.left})}if(D&&D.top!=undefined){E.css({top:D.top})}E.show();B.updateShadow(E)},updateShadow:function(D){var B=this,C=this.options;if(!C.shadow){return}D.shadow.css({left:D.css("left"),top:D.css("top"),width:D.outerWidth(),height:D.outerHeight()});if(D.is(":visible")){D.shadow.show()}else{D.shadow.hide()}},hide:function(D){var B=this,C=this.options;if(D==undefined){D=B.menu}B.hideAllSubMenu(D);D.hide();B.updateShadow(D)},toggle:function(){var B=this,C=this.options;B.menu.toggle();B.updateShadow(B.menu)},removeItem:function(C){var B=this,D=this.options;A("> .l-menu-item[menuitemid="+C+"]",B.menu.items).remove()},setEnabled:function(C){var B=this,D=this.options;A("> .l-menu-item[menuitemid="+C+"]",B.menu.items).removeClass("l-menu-item-disable")},setDisabled:function(C){var B=this,D=this.options;A("> .l-menu-item[menuitemid="+C+"]",B.menu.items).addClass("l-menu-item-disable")},isEnable:function(C){var B=this,D=this.options;return !A("> .l-menu-item[menuitemid="+C+"]",B.menu.items).hasClass("l-menu-item-disable")},getItemCount:function(){var B=this,C=this.options;return A("> .l-menu-item",B.menu.items).length},addItem:function(I,F){var H=this,B=this.options;if(!I){return}if(F==undefined){F=H.menu}if(I.line){F.items.append('<div class="l-menu-item-line"></div>');return}var D=A('<div class="l-menu-item"><div class="l-menu-item-text"></div> </div>');var C=A("> .l-menu-item",F.items).length;F.items.append(D);D.attr("ligeruimenutemid",++H.menuItemCount);I.id&&D.attr("menuitemid",I.id);I.text&&A(">.l-menu-item-text:first",D).html(I.text);I.icon&&D.prepend('<div class="l-menu-item-icon l-icon-'+I.icon+'" style="background:url(\''+I.icon+"');\"></div>");if(I.disable||I.disabled){D.addClass("l-menu-item-disable")}if(I.children){D.append('<div class="l-menu-item-arrow"></div>');var G=H.createMenu(D.attr("ligeruimenutemid"));H.menus[D.attr("ligeruimenutemid")]=G;G.width(B.width);G.hover(null,function(){if(!G.showedSubMenu){H.hide(G)}});A(I.children).each(function(){H.addItem(this,G)})}I.click&&D.click(function(){if(A(this).hasClass("l-menu-item-disable")){return}I.click(I,C)});I.dblclick&&D.dblclick(function(){if(A(this).hasClass("l-menu-item-disable")){return}I.dblclick(I,C)});var E=A("> .l-menu-over:first",F);D.hover(function(){if(A(this).hasClass("l-menu-item-disable")){return}var K=A(this).offset().top;var J=K-F.offset().top;E.css({top:J});H.hideAllSubMenu(F);if(I.children){var L=A(this).attr("ligeruimenutemid");if(!L){return}if(H.menus[L]){H.show({top:K,left:A(this).offset().left+A(this).width()-5},H.menus[L]);F.showedSubMenu=true}}},function(){if(A(this).hasClass("l-menu-item-disable")){return}var J=A(this).attr("ligeruimenutemid");if(I.children){var J=A(this).attr("ligeruimenutemid");if(!J){return}}})},hideAllSubMenu:function(D){var B=this,C=this.options;if(D==undefined){D=B.menu}A("> .l-menu-item",D.items).each(function(){if(A("> .l-menu-item-arrow",this).length>0){var E=A(this).attr("ligeruimenutemid");if(!E){return}B.menus[E]&&B.hide(B.menus[E])}});D.showedSubMenu=false},createMenu:function(C){var B=this,D=this.options;var E=A('<div class="l-menu" style="display:none"><div class="l-menu-yline"></div><div class="l-menu-over"><div class="l-menu-over-l"></div> <div class="l-menu-over-r"></div></div><div class="l-menu-inner"></div></div>');C&&E.attr("ligeruiparentmenuitemid",C);E.items=A("> .l-menu-inner:first",E);E.appendTo("body");if(D.shadow){E.shadow=A('<div class="l-menu-shadow"></div>').insertAfter(E);B.updateShadow(E)}E.hover(null,function(){if(!E.showedSubMenu){A("> .l-menu-over:first",E).css({top:-24})}});if(C){B.menus[C]=E}else{B.menus[0]=E}return E}});A.ligerui.controls.Menu.prototype.setEnable=A.ligerui.controls.Menu.prototype.setEnabled;A.ligerui.controls.Menu.prototype.setDisable=A.ligerui.controls.Menu.prototype.setDisabled})(jQuery);(function(A){A.fn.ligerMenuBar=function(B){return A.ligerui.run.call(this,"ligerMenuBar",arguments)};A.fn.ligerGetMenuBarManager=function(){return A.ligerui.run.call(this,"ligerGetMenuBarManager",arguments)};A.ligerDefaults.MenuBar={};A.ligerMethos.MenuBar={};A.ligerui.controls.MenuBar=function(C,B){A.ligerui.controls.MenuBar.base.constructor.call(this,C,B)};A.ligerui.controls.MenuBar.ligerExtend(A.ligerui.core.UIComponent,{__getType:function(){return"MenuBar"},__idPrev:function(){return"MenuBar"},_extendMethods:function(){return A.ligerMethos.MenuBar},_render:function(){var B=this,C=this.options;B.menubar=A(this.element);if(!B.menubar.hasClass("l-menubar")){B.menubar.addClass("l-menubar")}if(C&&C.items){A(C.items).each(function(D,E){B.addItem(E)})}A(document).click(function(){A(".l-panel-btn-selected",B.menubar).removeClass("l-panel-btn-selected")});B.set(C)},addItem:function(D){var B=this,C=this.options;var E=A('<div class="l-menubar-item l-panel-btn"><span></span><div class="l-panel-btn-l"></div><div class="l-panel-btn-r"></div><div class="l-menubar-item-down"></div></div>');B.menubar.append(E);D.id&&E.attr("menubarid",D.id);D.text&&A("span:first",E).html(D.text);D.disable&&E.addClass("l-menubar-item-disable");D.click&&E.click(function(){D.click(D)});if(D.menu){var F=A.ligerMenu(D.menu);E.hover(function(){B.actionMenu&&B.actionMenu.hide();var G=A(this).offset().left;var H=A(this).offset().top+A(this).height();F.show({top:H,left:G});B.actionMenu=F;A(this).addClass("l-panel-btn-over l-panel-btn-selected").siblings(".l-menubar-item").removeClass("l-panel-btn-selected")},function(){A(this).removeClass("l-panel-btn-over")})}else{E.hover(function(){A(this).addClass("l-panel-btn-over")},function(){A(this).removeClass("l-panel-btn-over")});A(".l-menubar-item-down",E).remove()}}})})(jQuery);(function(A){A.ligerMessageBox=function(B){return A.ligerui.run.call(null,"ligerMessageBox",arguments,{isStatic:true})};A.ligerDefaults.MessageBox={isDrag:true};A.ligerMethos.MessageBox={};A.ligerui.controls.MessageBox=function(B){A.ligerui.controls.MessageBox.base.constructor.call(this,null,B)};A.ligerui.controls.MessageBox.ligerExtend(A.ligerui.core.UIComponent,{__getType:function(){return"MessageBox"},__idPrev:function(){return"MessageBox"},_extendMethods:function(){return A.ligerMethos.MessageBox},_render:function(){var F=this,B=this.options;var H="";H+='<div class="l-messagebox">';H+='        <div class="l-messagebox-lt"></div><div class="l-messagebox-rt"></div>';H+='        <div class="l-messagebox-l"></div><div class="l-messagebox-r"></div> ';H+='        <div class="l-messagebox-image"></div>';H+='        <div class="l-messagebox-title">';H+='            <div class="l-messagebox-title-inner"></div>';H+='            <div class="l-messagebox-close"></div>';H+="        </div>";H+='        <div class="l-messagebox-content">';H+="        </div>";H+='        <div class="l-messagebox-buttons"><div class="l-messagebox-buttons-inner">';H+="        </div></div>";H+="    </div>";F.messageBox=A(H);A("body").append(F.messageBox);F.messageBox.close=function(){F._removeWindowMask();F.messageBox.remove()};B.width&&F.messageBox.width(B.width);B.title&&A(".l-messagebox-title-inner",F.messageBox).html(B.title);B.content&&A(".l-messagebox-content",F.messageBox).html(B.content);if(B.buttons){A(B.buttons).each(function(J,K){var L=A('<div class="l-messagebox-btn"><div class="l-messagebox-btn-l"></div><div class="l-messagebox-btn-r"></div><div class="l-messagebox-btn-inner"></div></div>');A(".l-messagebox-btn-inner",L).html(K.text);A(".l-messagebox-buttons-inner",F.messageBox).append(L);K.width&&L.width(K.width);K.onclick&&L.click(function(){K.onclick(K,J,F.messageBox)})});A(".l-messagebox-buttons-inner",F.messageBox).append("<div class='l-clear'></div>")}var C=F.messageBox.width();var I=0;A(".l-messagebox-buttons-inner .l-messagebox-btn",F.messageBox).each(function(){I+=A(this).width()});A(".l-messagebox-buttons-inner",F.messageBox).css({marginLeft:parseInt((C-I)*0.5)});F._applyWindowMask();F._applyDrag();F._setImage();var E=0;var D=0;var G=B.width||F.messageBox.width();if(B.left!=null){E=B.left}else{B.left=E=0.5*(A(window).width()-G)}if(B.top!=null){D=B.top}else{B.top=D=0.5*(A(window).height()-F.messageBox.height())+A(window).scrollTop()-10}if(E<0){B.left=E=0}if(D<0){B.top=D=0}F.messageBox.css({left:E,top:D});A(".l-messagebox-btn",F.messageBox).hover(function(){A(this).addClass("l-messagebox-btn-over")},function(){A(this).removeClass("l-messagebox-btn-over")});A(".l-messagebox-close",F.messageBox).hover(function(){A(this).addClass("l-messagebox-close-over")},function(){A(this).removeClass("l-messagebox-close-over")}).click(function(){F.messageBox.close()});F.set(B)},close:function(){var B=this,C=this.options;this.g._removeWindowMask();this.messageBox.remove()},_applyWindowMask:function(){var B=this,C=this.options;A(".l-window-mask").remove();A("<div class='l-window-mask' style='display: block;'></div>").appendTo(A("body"))},_removeWindowMask:function(){var B=this,C=this.options;A(".l-window-mask").remove()},_applyDrag:function(){var B=this,C=this.options;if(C.isDrag&&A.fn.ligerDrag){B.messageBox.ligerDrag({handler:".l-messagebox-title-inner",animate:false})}},_setImage:function(){var B=this,C=this.options;if(C.type){if(C.type=="success"||C.type=="donne"){A(".l-messagebox-image",B.messageBox).addClass("l-messagebox-image-donne").show();A(".l-messagebox-content",B.messageBox).css({paddingLeft:64,paddingBottom:30})}else{if(C.type=="error"){A(".l-messagebox-image",B.messageBox).addClass("l-messagebox-image-error").show();A(".l-messagebox-content",B.messageBox).css({paddingLeft:64,paddingBottom:30})}else{if(C.type=="warn"){A(".l-messagebox-image",B.messageBox).addClass("l-messagebox-image-warn").show();A(".l-messagebox-content",B.messageBox).css({paddingLeft:64,paddingBottom:30})}else{if(C.type=="question"){A(".l-messagebox-image",B.messageBox).addClass("l-messagebox-image-question").show();A(".l-messagebox-content",B.messageBox).css({paddingLeft:64,paddingBottom:40})}}}}}}});A.ligerMessageBox.show=function(B){return A.ligerMessageBox(B)};A.ligerMessageBox.alert=function(E,F,B,D){E=E||"";F=F||E;var C=function(G,H,I){I.close();if(D){D(G,H,I)}};p={title:E,content:F,buttons:[{text:"确定",onclick:C}]};if(B){p.type=B}return A.ligerMessageBox(p)};A.ligerMessageBox.confirm=function(D,E,B){var C=function(F,G,H){H.close();if(B){B(G==0)}};p={type:"question",title:D,content:E,buttons:[{text:"是",onclick:C},{text:"否",onclick:C}]};return A.ligerMessageBox(p)};A.ligerMessageBox.success=function(C,D,B){return A.ligerMessageBox.alert(C,D,"success",B)};A.ligerMessageBox.error=function(C,D,B){return A.ligerMessageBox.alert(C,D,"error",B)};A.ligerMessageBox.warn=function(C,D,B){return A.ligerMessageBox.alert(C,D,"warn",B)};A.ligerMessageBox.question=function(B,C){return A.ligerMessageBox.alert(B,C,"question")}})(jQuery);(function(A){A.fn.ligerRadio=function(){return A.ligerui.run.call(this,"ligerRadio",arguments)};A.fn.ligerGetRadioManager=function(){return A.ligerui.run.call(this,"ligerGetRadioManager",arguments)};A.ligerDefaults.Radio={disabled:false};A.ligerMethos.Radio={};A.ligerui.controls.Radio=function(C,B){A.ligerui.controls.Radio.base.constructor.call(this,C,B)};A.ligerui.controls.Radio.ligerExtend(A.ligerui.controls.Input,{__getType:function(){return"Radio"},__idPrev:function(){return"Radio"},_extendMethods:function(){return A.ligerMethos.Radio},_render:function(){var B=this,C=this.options;B.input=A(this.element);B.link=A('<a href="javascript:void(0)" class="l-radio"></a>');B.wrapper=B.input.addClass("l-hidden").wrap('<div class="l-radio-wrapper"></div>').parent();B.wrapper.prepend(B.link);B.input.change(function(){if(this.checked){B.link.addClass("l-radio-checked")}else{B.link.removeClass("l-radio-checked")}return true});B.link.click(function(){B._doclick()});B.wrapper.hover(function(){if(!C.disabled){A(this).addClass("l-over")}},function(){A(this).removeClass("l-over")});this.element.checked&&B.link.addClass("l-radio-checked");if(this.element.id){A("label[for="+this.element.id+"]").click(function(){B._doclick()})}B.set(C)},setValue:function(D){var B=this,C=this.options;if(!D){B.input[0].checked=false;B.link.removeClass("l-radio-checked")}else{B.input[0].checked=true;B.link.addClass("l-radio-checked")}},getValue:function(){return this.input[0].checked},setEnabled:function(){this.input.attr("disabled",false);this.wrapper.removeClass("l-disabled");this.options.disabled=false},setDisabled:function(){this.input.attr("disabled",true);this.wrapper.addClass("l-disabled");this.options.disabled=true},updateStyle:function(){if(this.input.attr("disabled")){this.wrapper.addClass("l-disabled");this.options.disabled=true}if(this.input[0].checked){this.link.addClass("l-checkbox-checked")}else{this.link.removeClass("l-checkbox-checked")}},_doclick:function(){var B=this,D=this.options;if(B.input.attr("disabled")){return false}B.input.trigger("click").trigger("change");var C;if(B.input[0].form){C=B.input[0].form}else{C=document}A("input:radio[name="+B.input[0].name+"]",C).not(B.input).trigger("change");return false}})})(jQuery);(function(A){A.fn.ligerResizable=function(B){return A.ligerui.run.call(this,"ligerResizable",arguments,{idAttrName:"ligeruiresizableid",hasElement:false,propertyToElemnt:"target"})};A.fn.ligerGetResizableManager=function(){return A.ligerui.run.call(this,"ligerGetResizableManager",arguments,{idAttrName:"ligeruiresizableid",hasElement:false,propertyToElemnt:"target"})};A.ligerDefaults.Resizable={handles:"n, e, s, w, ne, se, sw, nw",maxWidth:2000,maxHeight:2000,minWidth:20,minHeight:20,scope:3,animate:false,onStartResize:function(B){},onResize:function(B){},onStopResize:function(B){},onEndResize:null};A.ligerui.controls.Resizable=function(B){A.ligerui.controls.Resizable.base.constructor.call(this,null,B)};A.ligerui.controls.Resizable.ligerExtend(A.ligerui.core.UIComponent,{__getType:function(){return"Resizable"},__idPrev:function(){return"Resizable"},_render:function(){var B=this,C=this.options;B.target=A(C.target);B.set(C);B.target.mousemove(function(E){if(C.disabled){return}B.dir=B._getDir(E);if(B.dir){B.target.css("cursor",B.dir+"-resize")}else{if(B.target.css("cursor").indexOf("-resize")>0){B.target.css("cursor","default")}}if(C.target.ligeruidragid){var D=A.ligerui.get(C.target.ligeruidragid);if(D&&B.dir){D.set("disabled",true)}else{if(D){D.set("disabled",false)}}}}).mousedown(function(D){if(C.disabled){return}if(B.dir){B._start(D)}})},_rendered:function(){this.options.target.ligeruiresizableid=this.id},_getDir:function(B){var J=this,C=this.options;var D="";var F=J.target.offset();var I=J.target.width();var K=J.target.height();var E=C.scope;var H=B.pageX||B.screenX;var G=B.pageY||B.screenY;if(G>=F.top&&G<F.top+E){D+="n"}else{if(G<=F.top+K&&G>F.top+K-E){D+="s"}}if(H>=F.left&&H<F.left+E){D+="w"}else{if(H<=F.left+I&&H>F.left+I-E){D+="e"}}if(C.handles=="all"||D==""){return D}if(A.inArray(D,J.handles)!=-1){return D}return""},_setHandles:function(B){if(!B){return}this.handles=B.replace(/(\s*)/g,"").split(",")},_createProxy:function(){var B=this;B.proxy=A('<div class="l-resizable"></div>');B.proxy.width(B.target.width()).height(B.target.height());B.proxy.attr("resizableid",B.id).appendTo("body")},_removeProxy:function(){var B=this;if(B.proxy){B.proxy.remove();B.proxy=null}},_start:function(C){var B=this,D=this.options;B._createProxy();B.proxy.css({left:B.target.offset().left,top:B.target.offset().top,position:"absolute"});B.current={dir:B.dir,left:B.target.offset().left,top:B.target.offset().top,startX:C.pageX||C.screenX,startY:C.pageY||C.clientY,width:B.target.width(),height:B.target.height()};A(document).bind("selectstart.resizable",function(){return false});A(document).bind("mouseup.resizable",function(){B._stop.apply(B,arguments)});A(document).bind("mousemove.resizable",function(){B._drag.apply(B,arguments)});B.proxy.show();B.trigger("startResize",[B.current,C])},changeBy:{t:["n","ne","nw"],l:["w","sw","nw"],w:["w","sw","nw","e","ne","se"],h:["n","ne","nw","s","se","sw"]},_drag:function(C){var B=this,D=this.options;if(!B.current){return}if(!B.proxy){return}B.proxy.css("cursor",B.current.dir==""?"default":B.current.dir+"-resize");var F=C.pageX||C.screenX;var E=C.pageY||C.screenY;B.current.diffX=F-B.current.startX;B.current.diffY=E-B.current.startY;B._applyResize(B.proxy);B.trigger("resize",[B.current,C])},_stop:function(C){var B=this,D=this.options;if(B.hasBind("stopResize")){if(B.trigger("stopResize",[B.current,C])!=false){B._applyResize()}}else{B._applyResize()}B._removeProxy();B.trigger("endResize",[B.current,C]);A(document).unbind("selectstart.resizable");A(document).unbind("mousemove.resizable");A(document).unbind("mouseup.resizable")},_applyResize:function(F){var B=this,C=this.options;var E={left:B.current.left,top:B.current.top,width:B.current.width,height:B.current.height};var D=false;if(!F){F=B.target;D=true;if(!isNaN(parseInt(B.target.css("top")))){E.top=parseInt(B.target.css("top"))}else{E.top=0}if(!isNaN(parseInt(B.target.css("left")))){E.left=parseInt(B.target.css("left"))}else{E.left=0}}if(A.inArray(B.current.dir,B.changeBy.l)>-1){E.left+=B.current.diffX;B.current.diffLeft=B.current.diffX}else{if(D){delete E.left}}if(A.inArray(B.current.dir,B.changeBy.t)>-1){E.top+=B.current.diffY;B.current.diffTop=B.current.diffY}else{if(D){delete E.top}}if(A.inArray(B.current.dir,B.changeBy.w)>-1){E.width+=(B.current.dir.indexOf("w")==-1?1:-1)*B.current.diffX;B.current.newWidth=E.width}else{if(D){delete E.width}}if(A.inArray(B.current.dir,B.changeBy.h)>-1){E.height+=(B.current.dir.indexOf("n")==-1?1:-1)*B.current.diffY;B.current.newHeight=E.height}else{if(D){delete E.height}}if(D&&C.animate){F.animate(E)}else{F.css(E)}}})})(jQuery);(function(A){A.fn.ligerSpinner=function(){return A.ligerui.run.call(this,"ligerSpinner",arguments)};A.fn.ligerGetSpinnerManager=function(){return A.ligerui.run.call(this,"ligerGetSpinnerManager",arguments)};A.ligerDefaults.Spinner={type:"float",isNegative:true,decimalplace:2,step:0.1,interval:50,onChangeValue:false,minValue:null,maxValue:null,disabled:false};A.ligerMethos.Spinner={};A.ligerui.controls.Spinner=function(C,B){A.ligerui.controls.Spinner.base.constructor.call(this,C,B)};A.ligerui.controls.Spinner.ligerExtend(A.ligerui.controls.Input,{__getType:function(){return"Spinner"},__idPrev:function(){return"Spinner"},_extendMethods:function(){return A.ligerMethos.Spinner},_init:function(){A.ligerui.controls.Spinner.base._init.call(this);var B=this.options;if(B.type=="float"){B.step=0.1;B.interval=50}else{if(B.type=="int"){B.step=1;B.interval=100}else{if(B.type=="time"){B.step=1;B.interval=100}}}},_render:function(){var B=this,C=this.options;B.interval=null;B.inputText=null;B.value=null;B.textFieldID="";if(this.element.tagName.toLowerCase()=="input"&&this.element.type&&this.element.type=="text"){B.inputText=A(this.element);if(this.element.id){B.textFieldID=this.element.id}}else{B.inputText=A('<input type="text"/>');B.inputText.appendTo(A(this.element))}if(B.textFieldID==""&&C.textFieldID){B.textFieldID=C.textFieldID}B.link=A('<div class="l-trigger"><div class="l-spinner-up"><div class="l-spinner-icon"></div></div><div class="l-spinner-split"></div><div class="l-spinner-down"><div class="l-spinner-icon"></div></div></div>');B.wrapper=B.inputText.wrap('<div class="l-text"></div>').parent();B.wrapper.append('<div class="l-text-l"></div><div class="l-text-r"></div>');B.wrapper.append(B.link).after(B.selectBox).after(B.valueField);B.link.up=A(".l-spinner-up",B.link);B.link.down=A(".l-spinner-down",B.link);B.inputText.addClass("l-text-field");if(C.disabled){B.wrapper.addClass("l-text-disabled")}if(!B._isVerify(B.inputText.val())){B.value=B._getDefaultValue();B.inputText.val(B.value)}B.link.up.hover(function(){if(!C.disabled){A(this).addClass("l-spinner-up-over")}},function(){clearInterval(B.interval);A(document).unbind("selectstart.spinner");A(this).removeClass("l-spinner-up-over")}).mousedown(function(){if(!C.disabled){B._uping.call(B);B.interval=setInterval(function(){B._uping.call(B)},C.interval);A(document).bind("selectstart.spinner",function(){return false})}}).mouseup(function(){clearInterval(B.interval);B.inputText.trigger("change").focus();A(document).unbind("selectstart.spinner")});B.link.down.hover(function(){if(!C.disabled){A(this).addClass("l-spinner-down-over")}},function(){clearInterval(B.interval);A(document).unbind("selectstart.spinner");A(this).removeClass("l-spinner-down-over")}).mousedown(function(){if(!C.disabled){B.interval=setInterval(function(){B._downing.call(B)},C.interval);A(document).bind("selectstart.spinner",function(){return false})}}).mouseup(function(){clearInterval(B.interval);B.inputText.trigger("change").focus();A(document).unbind("selectstart.spinner")});B.inputText.change(function(){var D=B.inputText.val();B.value=B._getVerifyValue(D);B.trigger("changeValue",[B.value]);B.inputText.val(B.value)}).blur(function(){B.wrapper.removeClass("l-text-focus")}).focus(function(){B.wrapper.addClass("l-text-focus")});B.wrapper.hover(function(){if(!C.disabled){B.wrapper.addClass("l-text-over")}},function(){B.wrapper.removeClass("l-text-over")});B.set(C)},_setWidth:function(C){var B=this;if(C>20){B.wrapper.css({width:C});B.inputText.css({width:C-20})}},_setHeight:function(C){var B=this;if(C>10){B.wrapper.height(C);B.inputText.height(C-2);B.link.height(C-4)}},_setDisabled:function(B){if(B){this.wrapper.addClass("l-text-disabled")}else{this.wrapper.removeClass("l-text-disabled")}},setValue:function(B){this.inputText.val(B)},getValue:function(){return this.inputText.val()},_round:function(E,C){var B=this,D=this.options;var F=1;for(;C>0;F*=10,C--){}for(;C<0;F/=10,C++){}return Math.round(E*F)/F},_isInt:function(E){var B=this,D=this.options;var C=D.isNegative?/^-?\d+$/:/^\d+$/;if(!C.test(E)){return false}if(parseFloat(E)!=E){return false}return true},_isFloat:function(E){var B=this,D=this.options;var C=D.isNegative?/^-?\d+(\.\d+)?$/:/^\d+(\.\d+)?$/;if(!C.test(E)){return false}if(parseFloat(E)!=E){return false}return true},_isTime:function(D){var B=this,C=this.options;var E=D.match(/^(\d{1,2}):(\d{1,2})$/);if(E==null){return false}if(E[1]>24||E[2]>60){return false}return true},_isVerify:function(D){var B=this,C=this.options;if(C.type=="float"){if(!B._isFloat(D)){return false}var E=parseFloat(D);if(C.minValue!=undefined&&C.minValue>E){return false}if(C.maxValue!=undefined&&C.maxValue<E){return false}return true}else{if(C.type=="int"){if(!B._isInt(D)){return false}var E=parseInt(D);if(C.minValue!=undefined&&C.minValue>E){return false}if(C.maxValue!=undefined&&C.maxValue<E){return false}return true}else{if(C.type=="time"){return B._isTime(D)}}}return false},_getVerifyValue:function(D){var B=this,C=this.options;var E=null;if(C.type=="float"){E=B._round(D,C.decimalplace)}else{if(C.type=="int"){E=parseInt(D)}else{if(C.type=="time"){E=D}}}if(!B._isVerify(E)){return B.value}else{return E}},_isOverValue:function(D){var B=this,C=this.options;if(C.minValue!=null&&C.minValue>D){return true}if(C.maxValue!=null&&C.maxValue<D){return true}return false},_getDefaultValue:function(){var B=this,C=this.options;if(C.type=="float"||C.type=="int"){return 0}else{if(C.type=="time"){return"00:00"}}},_addValue:function(D){var B=this,C=this.options;var E=B.inputText.val();E=parseFloat(E)+D;if(B._isOverValue(E)){return}B.inputText.val(E);B.inputText.trigger("change")},_addTime:function(F){var B=this,C=this.options;var D=B.inputText.val();var E=D.match(/^(\d{1,2}):(\d{1,2})$/);newminute=parseInt(E[2])+F;if(newminute<10){newminute="0"+newminute}D=E[1]+":"+newminute;if(B._isOverValue(D)){return}B.inputText.val(D);B.inputText.trigger("change")},_uping:function(){var B=this,C=this.options;if(C.type=="float"||C.type=="int"){B._addValue(C.step)}else{if(C.type=="time"){B._addTime(C.step)}}},_downing:function(){var B=this,C=this.options;if(C.type=="float"||C.type=="int"){B._addValue(-1*C.step)}else{if(C.type=="time"){B._addTime(-1*C.step)}}},_isDateTime:function(E){var B=this,D=this.options;var C=E.match(/^(\d{1,4})(-|\/)(\d{1,2})\2(\d{1,2})$/);if(C==null){return false}var F=new Date(C[1],C[3]-1,C[4]);if(F=="NaN"){return false}return(F.getFullYear()==C[1]&&(F.getMonth()+1)==C[3]&&F.getDate()==C[4])},_isLongDateTime:function(E){var B=this,D=this.options;var G=/^(\d{1,4})(-|\/)(\d{1,2})\2(\d{1,2}) (\d{1,2}):(\d{1,2})$/;var C=E.match(G);if(C==null){return false}var F=new Date(C[1],C[3]-1,C[4],C[5],C[6]);if(F=="NaN"){return false}return(F.getFullYear()==C[1]&&(F.getMonth()+1)==C[3]&&F.getDate()==C[4]&&F.getHours()==C[5]&&F.getMinutes()==C[6])}})})(jQuery);(function(A){A.fn.ligerTab=function(B){return A.ligerui.run.call(this,"ligerTab",arguments)};A.fn.ligerGetTabManager=function(){return A.ligerui.run.call(this,"ligerGetTabManager",arguments)};A.ligerDefaults.Tab={height:null,heightDiff:0,changeHeightOnResize:false,contextmenu:true,dblClickToClose:false,dragToMove:false,onBeforeOverrideTabItem:null,onAfterOverrideTabItem:null,onBeforeRemoveTabItem:null,onAfterRemoveTabItem:null,onBeforeAddTabItem:null,onAfterAddTabItem:null,onBeforeSelectTabItem:null,onAfterSelectTabItem:null};A.ligerDefaults.TabString={closeMessage:"关闭当前页",closeOtherMessage:"关闭其他",closeAllMessage:"关闭所有",reloadMessage:"刷新"};A.ligerMethos.Tab={};A.ligerui.controls.Tab=function(C,B){A.ligerui.controls.Tab.base.constructor.call(this,C,B)};A.ligerui.controls.Tab.ligerExtend(A.ligerui.core.UIComponent,{__getType:function(){return"Tab"},__idPrev:function(){return"Tab"},_extendMethods:function(){return A.ligerMethos.Tab},_render:function(){var B=this,D=this.options;if(D.height){B.makeFullHeight=true}B.tab=A(this.element);B.tab.addClass("l-tab");if(D.contextmenu&&A.ligerMenu){B.tab.menu=A.ligerMenu({width:100,items:[{text:D.closeMessage,id:"close",click:function(){B._menuItemClick.apply(B,arguments)}},{text:D.closeOtherMessage,id:"closeother",click:function(){B._menuItemClick.apply(B,arguments)}},{text:D.closeAllMessage,id:"closeall",click:function(){B._menuItemClick.apply(B,arguments)}},{text:D.reloadMessage,id:"reload",click:function(){B._menuItemClick.apply(B,arguments)}}]})}B.tab.content=A('<div class="l-tab-content"></div>');A("> div",B.tab).appendTo(B.tab.content);B.tab.content.appendTo(B.tab);B.tab.links=A('<div class="l-tab-links"><ul style="left: 0px; "></ul></div>');B.tab.links.prependTo(B.tab);B.tab.links.ul=A("ul",B.tab.links);var E=A("> div[lselected=true]",B.tab.content);var C=E.length>0;B.selectedTabId=E.attr("tabid");A("> div",B.tab.content).each(function(K,I){var H=A('<li class=""><a></a><div class="l-tab-links-item-left"></div><div class="l-tab-links-item-right"></div></li>');var G=A(this);if(G.attr("title")){A("> a",H).html(G.attr("title"));G.attr("title","")}var F=G.attr("tabid");if(F==undefined){F=B.getNewTabid();G.attr("tabid",F);if(G.attr("lselected")){B.selectedTabId=F}}H.attr("tabid",F);if(!C&&K==0){B.selectedTabId=F}var L=G.attr("showClose");if(L){H.append("<div class='l-tab-links-item-close'></div>")}A("> ul",B.tab.links).append(H);if(!G.hasClass("l-tab-content-item")){G.addClass("l-tab-content-item")}if(G.find("iframe").length>0){var J=A("iframe:first",G);if(J[0].readyState!="complete"){if(G.find(".l-tab-loading:first").length==0){G.prepend("<div class='l-tab-loading' style='display:block;'></div>")}var M=A(".l-tab-loading:first",G);J.bind("load.tab",function(){M.hide()})}}});B.selectTabItem(B.selectedTabId);if(D.height){if(typeof(D.height)=="string"&&D.height.indexOf("%")>0){B.onResize();if(D.changeHeightOnResize){A(window).resize(function(){B.onResize.call(B)})}}else{B.setHeight(D.height)}}if(B.makeFullHeight){B.setContentHeight()}A("li",B.tab.links).each(function(){B._addTabItemEvent(A(this))});B.tab.bind("dblclick.tab",function(G){if(!D.dblClickToClose){return}B.dblclicking=true;var H=(G.target||G.srcElement);var F=H.tagName.toLowerCase();if(F=="a"){var J=A(H).parent().attr("tabid");var I=A(H).parent().find("div.l-tab-links-item-close").length?true:false;if(I){B.removeTabItem(J)}}B.dblclicking=false});B.set(D)},_applyDrag:function(D){var B=this,E=this.options;B.droptip=B.droptip||A("<div class='l-tab-drag-droptip' style='display:none'><div class='l-drop-move-up'></div><div class='l-drop-move-down'></div></div>").appendTo("body");var C=A(D).ligerDrag({revert:true,animate:false,proxy:function(){var F=A(this).find("a").html();B.dragproxy=A("<div class='l-tab-drag-proxy' style='display:none'><div class='l-drop-icon l-drop-no'></div></div>").appendTo("body");B.dragproxy.append(F);return B.dragproxy},onRendered:function(){this.set("cursor","pointer")},onStartDrag:function(H,F){if(!A(D).hasClass("l-selected")){return false}if(F.button==2){return false}var G=F.srcElement||F.target;if(A(G).hasClass("l-tab-links-item-close")){return false}},onDrag:function(H,F){if(B.dropIn==null){B.dropIn=-1}var G=B.tab.links.ul.find(">li");var I=G.index(H.target);G.each(function(J,L){if(I==J){return}var P=J>I;if(B.dropIn!=-1&&B.dropIn!=J){return}var M=A(this).offset();var O={top:M.top,bottom:M.top+A(this).height(),left:M.left-10,right:M.left+10};if(P){O.left+=A(this).width();O.right+=A(this).width()}var N=F.pageX||F.screenX;var K=F.pageY||F.screenY;if(N>O.left&&N<O.right&&K>O.top&&K<O.bottom){B.droptip.css({left:O.left+5,top:O.top-9}).show();B.dropIn=J;B.dragproxy.find(".l-drop-icon").removeClass("l-drop-no").addClass("l-drop-yes")}else{B.dropIn=-1;B.droptip.hide();B.dragproxy.find(".l-drop-icon").removeClass("l-drop-yes").addClass("l-drop-no")}})},onStopDrag:function(I,G){if(B.dropIn>-1){var H=B.tab.links.ul.find(">li:eq("+B.dropIn+")").attr("tabid");var F=A(I.target).attr("tabid");setTimeout(function(){B.moveTabItem(F,H)},0);B.dropIn=-1;B.dragproxy.remove()}B.droptip.hide();this.set("cursor","default")}});return C},_setDragToMove:function(D){if(!A.fn.ligerDrag){return}var B=this,C=this.options;if(D){if(B.drags){return}B.drags=B.drags||[];B.tab.links.ul.find(">li").each(function(){B.drags.push(B._applyDrag(this))})}},moveTabItem:function(C,E){var B=this;var D=B.tab.links.ul.find(">li[tabid="+C+"]");var G=B.tab.links.ul.find(">li[tabid="+E+"]");var F=B.tab.links.ul.find(">li").index(D);var H=B.tab.links.ul.find(">li").index(G);if(F<H){G.after(D)}else{G.before(D)}},setTabButton:function(){var B=this,C=this.options;var E=0;A("li",B.tab.links.ul).each(function(){E+=A(this).width()+2});var D=B.tab.width();if(E>D){B.tab.links.append('<div class="l-tab-links-left"></div><div class="l-tab-links-right"></div>');B.setTabButtonEven();return true}else{B.tab.links.ul.animate({left:0});A(".l-tab-links-left,.l-tab-links-right",B.tab.links).remove();return false}},setTabButtonEven:function(){var B=this,C=this.options;A(".l-tab-links-left",B.tab.links).hover(function(){A(this).addClass("l-tab-links-left-over")},function(){A(this).removeClass("l-tab-links-left-over")}).click(function(){B.moveToPrevTabItem()});A(".l-tab-links-right",B.tab.links).hover(function(){A(this).addClass("l-tab-links-right-over")},function(){A(this).removeClass("l-tab-links-right-over")}).click(function(){B.moveToNextTabItem()})},moveToPrevTabItem:function(){var B=this,D=this.options;var F=A(".l-tab-links-left",B.tab.links).width();var G=new Array();A("li",B.tab.links).each(function(H,I){var J=-1*F;if(H>0){J=parseInt(G[H-1])+A(this).prev().width()+2}G.push(J)});var E=-1*parseInt(B.tab.links.ul.css("left"));for(var C=0;C<G.length-1;C++){if(G[C]<E&&G[C+1]>=E){B.tab.links.ul.animate({left:-1*parseInt(G[C])});return}}},moveToNextTabItem:function(){var L=this,C=this.options;var I=A(".l-tab-links-right",L.tab).width();var B=0;var E=A("li",L.tab.links.ul);E.each(function(){B+=A(this).width()+2});var J=L.tab.width();var K=new Array();for(var H=E.length-1;H>=0;H--){var D=B-J+I+2;if(H!=E.length-1){D=parseInt(K[E.length-2-H])-A(E[H+1]).width()-2}K.push(D)}var F=-1*parseInt(L.tab.links.ul.css("left"));for(var G=1;G<K.length;G++){if(K[G]<=F&&K[G-1]>F){L.tab.links.ul.animate({left:-1*parseInt(K[G-1])});return}}},getTabItemCount:function(){var B=this,C=this.options;return A("li",B.tab.links.ul).length},getSelectedTabItemID:function(){var B=this,C=this.options;return A("li.l-selected",B.tab.links.ul).attr("tabid")},removeSelectedTabItem:function(){var B=this,C=this.options;B.removeTabItem(B.getSelectedTabItemID())},overrideSelectedTabItem:function(D){var B=this,C=this.options;B.overrideTabItem(B.getSelectedTabItemID(),D)},overrideTabItem:function(I,H){var E=this,C=this.options;if(E.trigger("beforeOverrideTabItem",[I])==false){return false}var B=H.tabid;if(B==undefined){B=E.getNewTabid()}var L=H.url;var M=H.content;var K=H.target;var D=H.text;var J=H.showClose;var N=H.height;if(E.isTabItemExist(B)){return}var G=A("li[tabid="+I+"]",E.tab.links.ul);var F=A(".l-tab-content-item[tabid="+I+"]",E.tab.content);if(!G||!F){return}G.attr("tabid",B);F.attr("tabid",B);if(A("iframe",F).length==0&&L){F.html("<iframe frameborder='0'></iframe>")}else{if(M){F.html(M)}}A("iframe",F).attr("name",B);if(J==undefined){J=true}if(J==false){A(".l-tab-links-item-close",G).remove()}else{if(A(".l-tab-links-item-close",G).length==0){G.append("<div class='l-tab-links-item-close'></div>")}}if(D==undefined){D=B}if(N){F.height(N)}A("a",G).text(D);A("iframe",F).attr("src",L);E.trigger("afterOverrideTabItem",[I])},selectTabItem:function(D){var B=this,C=this.options;if(B.trigger("beforeSelectTabItem",[D])==false){return false}B.selectedTabId=D;A("> .l-tab-content-item[tabid="+D+"]",B.tab.content).show().siblings().hide();A("li[tabid="+D+"]",B.tab.links.ul).addClass("l-selected").siblings().removeClass("l-selected");B.trigger("afterSelectTabItem",[D])},moveToLastTabItem:function(){var B=this,C=this.options;var F=0;A("li",B.tab.links.ul).each(function(){F+=A(this).width()+2});var D=B.tab.width();if(F>D){var E=A(".l-tab-links-right",B.tab.links).width();B.tab.links.ul.animate({left:-1*(F-D+E+2)})}},isTabItemExist:function(D){var B=this,C=this.options;return A("li[tabid="+D+"]",B.tab.links.ul).length>0},addTabItem:function(G){var E=this,C=this.options;if(E.trigger("beforeAddTabItem",[B])==false){return false}var B=G.tabid;if(B==undefined){B=E.getNewTabid()}var L=G.url;var O=G.content;var I=G.text;var K=G.showClose;var D=G.height;if(E.isTabItemExist(B)){E.selectTabItem(B);return}var M=A("<li><a></a><div class='l-tab-links-item-left'></div><div class='l-tab-links-item-right'></div><div class='l-tab-links-item-close'></div></li>");var F=A("<div class='l-tab-content-item'><div class='l-tab-loading' style='display:block;'></div><iframe frameborder='0'></iframe></div>");var N=A("div:first",F);var J=A("iframe:first",F);if(E.makeFullHeight){var H=E.tab.height()-E.tab.links.height();F.height(H)}M.attr("tabid",B);F.attr("tabid",B);if(L){J.attr("name",B).attr("id",B).attr("src",L).bind("load.tab",function(){N.hide();if(G.callback){G.callback()}})}else{J.remove();N.remove()}if(O){F.html(O)}else{if(G.target){F.append(G.target)}}if(K==undefined){K=true}if(K==false){A(".l-tab-links-item-close",M).remove()}if(I==undefined){I=B}if(D){F.height(D)}A("a",M).text(I);E.tab.links.ul.append(M);E.tab.content.append(F);E.selectTabItem(B);if(E.setTabButton()){E.moveToLastTabItem()}E._addTabItemEvent(M);if(C.dragToMove&&A.fn.ligerDrag){E.drags=E.drags||[];M.each(function(){E.drags.push(E._applyDrag(this))})}E.trigger("afterAddTabItem",[B])},_addTabItemEvent:function(D){var B=this,C=this.options;D.click(function(){var E=A(this).attr("tabid");B.selectTabItem(E)});B.tab.menu&&B._addTabItemContextMenuEven(D);A(".l-tab-links-item-close",D).hover(function(){A(this).addClass("l-tab-links-item-close-over")},function(){A(this).removeClass("l-tab-links-item-close-over")}).click(function(){var E=A(this).parent().attr("tabid");B.removeTabItem(E)})},removeTabItem:function(D){var B=this,C=this.options;if(B.trigger("beforeRemoveTabItem",[D])==false){return false}var E=A("li[tabid="+D+"]",B.tab.links.ul).hasClass("l-selected");if(E){A(".l-tab-content-item[tabid="+D+"]",B.tab.content).prev().show();A("li[tabid="+D+"]",B.tab.links.ul).prev().addClass("l-selected").siblings().removeClass("l-selected")}A(".l-tab-content-item[tabid="+D+"]",B.tab.content).remove();A("li[tabid="+D+"]",B.tab.links.ul).remove();B.setTabButton();B.trigger("afterRemoveTabItem",[D])},addHeight:function(E){var B=this,D=this.options;var C=B.tab.height()+E;B.setHeight(C)},setHeight:function(C){var B=this,D=this.options;B.tab.height(C);B.setContentHeight()},setContentHeight:function(){var B=this,C=this.options;var D=B.tab.height()-B.tab.links.height();B.tab.content.height(D);A("> .l-tab-content-item",B.tab.content).height(D)},getNewTabid:function(){var B=this,C=this.options;B.getnewidcount=B.getnewidcount||0;return"tabitem"+(++B.getnewidcount)},getTabidList:function(E,F){var B=this,D=this.options;var C=[];A("> li",B.tab.links.ul).each(function(){if(A(this).attr("tabid")&&A(this).attr("tabid")!=E&&(!F||A(".l-tab-links-item-close",this).length>0)){C.push(A(this).attr("tabid"))}});return C},removeOther:function(F,B){var D=this,E=this.options;var C=D.getTabidList(F,true);A(C).each(function(){D.removeTabItem(this)})},reload:function(F){var B=this,E=this.options;var D=A(".l-tab-content-item[tabid="+F+"]");var H=A(".l-tab-loading:first",D);var C=A("iframe:first",D);var G=A(C).attr("src");H.show();C.attr("src",G).unbind("load.tab").bind("load.tab",function(){H.hide()})},removeAll:function(B){var D=this,E=this.options;var C=D.getTabidList(null,true);A(C).each(function(){D.removeTabItem(this)})},onResize:function(){var B=this,C=this.options;if(!C.height||typeof(C.height)!="string"||C.height.indexOf("%")==-1){return false}if(B.tab.parent()[0].tagName.toLowerCase()=="body"){var D=A(window).height();D-=parseInt(B.tab.parent().css("paddingTop"));D-=parseInt(B.tab.parent().css("paddingBottom"));B.height=C.heightDiff+D*parseFloat(B.height)*0.01}else{B.height=C.heightDiff+(B.tab.parent().height()*parseFloat(C.height)*0.01)}B.tab.height(B.height);B.setContentHeight()},_menuItemClick:function(D){var B=this,C=this.options;if(!D.id||!B.actionTabid){return}switch(D.id){case"close":B.removeTabItem(B.actionTabid);B.actionTabid=null;break;case"closeother":B.removeOther(B.actionTabid);break;case"closeall":B.removeAll();B.actionTabid=null;break;case"reload":B.selectTabItem(B.actionTabid);B.reload(B.actionTabid);break}},_addTabItemContextMenuEven:function(D){var B=this,C=this.options;D.bind("contextmenu",function(E){if(!B.tab.menu){return}B.actionTabid=D.attr("tabid");B.tab.menu.show({top:E.pageY,left:E.pageX});if(A(".l-tab-links-item-close",this).length==0){B.tab.menu.setDisabled("close")}else{B.tab.menu.setEnabled("close")}return false})}})})(jQuery);(function(A){A.fn.ligerTextBox=function(){return A.ligerui.run.call(this,"ligerTextBox",arguments)};A.fn.ligerGetTextBoxManager=function(){return A.ligerui.run.call(this,"ligerGetTextBoxManager",arguments)};A.ligerDefaults.TextBox={onChangeValue:null,width:null,disabled:false,value:null,nullText:null,digits:false,number:false};A.ligerui.controls.TextBox=function(C,B){A.ligerui.controls.TextBox.base.constructor.call(this,C,B)};A.ligerui.controls.TextBox.ligerExtend(A.ligerui.controls.Input,{__getType:function(){return"TextBox"},__idPrev:function(){return"TextBox"},_init:function(){A.ligerui.controls.TextBox.base._init.call(this);var B=this,C=this.options;if(!C.width){C.width=A(B.element).width()}if(A(this.element).attr("readonly")){C.disabled=true}},_render:function(){var B=this,C=this.options;B.inputText=A(this.element);B.wrapper=B.inputText.wrap('<div class="l-text"></div>').parent();B.wrapper.append('<div class="l-text-l"></div><div class="l-text-r"></div>');if(!B.inputText.hasClass("l-text-field")){B.inputText.addClass("l-text-field")}this._setEvent();B.set(C);B.checkValue()},_getValue:function(){return this.inputText.val()},_setNullText:function(){this.checkNotNull()},checkValue:function(){var B=this,C=this.options;var D=B.inputText.val();if(C.number&&!/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/.test(D)||C.digits&&!/^\d+$/.test(D)){B.inputText.val(B.value||0);return}B.value=D},checkNotNull:function(){var B=this,C=this.options;if(C.nullText&&!C.disabled){if(!B.inputText.val()){B.inputText.addClass("l-text-field-null").val(C.nullText)}}},_setEvent:function(){var B=this,C=this.options;B.inputText.bind("blur.textBox",function(){B.trigger("blur");B.checkNotNull();B.checkValue();B.wrapper.removeClass("l-text-focus")}).bind("focus.textBox",function(){B.trigger("focus");if(C.nullText){if(A(this).hasClass("l-text-field-null")){A(this).removeClass("l-text-field-null").val("")}}B.wrapper.addClass("l-text-focus")}).change(function(){B.trigger("changeValue",[this.value])});B.wrapper.hover(function(){B.trigger("mouseOver");B.wrapper.addClass("l-text-over")},function(){B.trigger("mouseOut");B.wrapper.removeClass("l-text-over")})},_setDisabled:function(B){if(B){this.inputText.attr("readonly","readonly");this.wrapper.addClass("l-text-disabled")}else{this.inputText.removeAttr("readonly");this.wrapper.removeClass("l-text-disabled")}},_setWidth:function(B){if(B>20){this.wrapper.css({width:B});this.inputText.css({width:B-4})}},_setHeight:function(B){if(B>10){this.wrapper.height(B);this.inputText.height(B-2)}},_setValue:function(B){if(B!=null){this.inputText.val(B)}},_setLabel:function(D){var B=this,C=this.options;if(!B.labelwrapper){B.labelwrapper=B.wrapper.wrap('<div class="l-labeltext"></div>').parent();var E=A('<div class="l-text-label" style="float:left;">'+D+":&nbsp</div>");B.labelwrapper.prepend(E);B.wrapper.css("float","left");if(!C.labelWidth){C.labelWidth=E.width()}else{B._setLabelWidth(C.labelWidth)}E.height(B.wrapper.height());if(C.labelAlign){B._setLabelAlign(C.labelAlign)}B.labelwrapper.append('<br style="clear:both;" />');B.labelwrapper.width(C.labelWidth+C.width+2)}else{B.labelwrapper.find(".l-text-label").html(D+":&nbsp")}},_setLabelWidth:function(D){var B=this,C=this.options;if(!B.labelwrapper){return}B.labelwrapper.find(".l-text-label").width(D)},_setLabelAlign:function(D){var B=this,C=this.options;if(!B.labelwrapper){return}B.labelwrapper.find(".l-text-label").css("text-align",D)},updateStyle:function(){var B=this,C=this.options;if(B.inputText.attr("disabled")||B.inputText.attr("readonly")){B.wrapper.addClass("l-text-disabled");B.options.disabled=true}else{B.wrapper.removeClass("l-text-disabled");B.options.disabled=false}if(B.inputText.hasClass("l-text-field-null")&&B.inputText.val()!=C.nullText){B.inputText.removeClass("l-text-field-null")}B.checkValue()}})})(jQuery);(function(A){A.ligerTip=function(B){return A.ligerui.run.call(null,"ligerTip",arguments)};A.fn.ligerTip=function(B){this.each(function(){var C=A.extend({},A.ligerDefaults.ElementTip,B||{});C.target=C.target||this;if(C.auto||B==undefined){if(!C.content){C.content=this.title;if(C.removeTitle){A(this).removeAttr("title")}}C.content=C.content||this.title;A(this).bind("mouseover.tip",function(){C.x=A(this).offset().left+A(this).width()+(C.distanceX||0);C.y=A(this).offset().top+(C.distanceY||0);A.ligerTip(C)}).bind("mouseout.tip",function(){var D=A.ligerui.managers[this.ligeruitipid];if(D){D.remove()}})}else{if(C.target.ligeruitipid){return}C.x=A(this).offset().left+A(this).width()+(C.distanceX||0);C.y=A(this).offset().top+(C.distanceY||0);C.x=C.x||0;C.y=C.y||0;A.ligerTip(C)}});return A.ligerui.get(this,"ligeruitipid")};A.fn.ligerHideTip=function(B){return this.each(function(){var C=B||{};if(C.isLabel==undefined){C.isLabel=this.tagName.toLowerCase()=="label"&&A(this).attr("for")!=null}var E=this;if(C.isLabel){var F=A("#"+A(this).attr("for"));if(F.length==0){return}E=F[0]}var D=A.ligerui.managers[E.ligeruitipid];if(D){D.remove()}}).unbind("mouseover.tip").unbind("mouseout.tip")};A.fn.ligerGetTipManager=function(){return A.ligerui.get(this)};A.ligerDefaults=A.ligerDefaults||{};A.ligerDefaults.HideTip={};A.ligerDefaults.Tip={content:null,callback:null,width:150,height:null,x:0,y:0,appendIdTo:null,target:null,auto:null,removeTitle:true};A.ligerDefaults.ElementTip={distanceX:1,distanceY:-3,auto:null,removeTitle:true};A.ligerMethos.Tip={};A.ligerui.controls.Tip=function(B){A.ligerui.controls.Tip.base.constructor.call(this,null,B)};A.ligerui.controls.Tip.ligerExtend(A.ligerui.core.UIComponent,{__getType:function(){return"Tip"},__idPrev:function(){return"Tip"},_extendMethods:function(){return A.ligerMethos.Tip},_render:function(){var B=this,D=this.options;var C=A('<div class="l-verify-tip"><div class="l-verify-tip-corner"></div><div class="l-verify-tip-content"></div></div>');B.tip=C;B.tip.attr("id",B.id);if(D.content){A("> .l-verify-tip-content:first",C).html(D.content);C.appendTo("body")}else{return}C.css({left:D.x,top:D.y}).show();D.width&&A("> .l-verify-tip-content:first",C).width(D.width-8);D.height&&A("> .l-verify-tip-content:first",C).width(D.height);eee=D.appendIdTo;if(D.appendIdTo){D.appendIdTo.attr("ligerTipId",B.id)}if(D.target){A(D.target).attr("ligerTipId",B.id);D.target.ligeruitipid=B.id}D.callback&&D.callback(C);B.set(D)},_setContent:function(B){A("> .l-verify-tip-content:first",this.tip).html(B)},remove:function(){if(this.options.appendIdTo){this.options.appendIdTo.removeAttr("ligerTipId")}if(this.options.target){A(this.options.target).removeAttr("ligerTipId");this.options.target.ligeruitipid=null}this.tip.remove()}})})(jQuery);(function(A){A.fn.ligerToolBar=function(B){return A.ligerui.run.call(this,"ligerToolBar",arguments)};A.fn.ligerGetToolBarManager=function(){return A.ligerui.run.call(this,"ligerGetToolBarManager",arguments)};A.ligerDefaults.ToolBar={};A.ligerMethos.ToolBar={};A.ligerui.controls.ToolBar=function(C,B){A.ligerui.controls.ToolBar.base.constructor.call(this,C,B)};A.ligerui.controls.ToolBar.ligerExtend(A.ligerui.core.UIComponent,{__getType:function(){return"ToolBar"},__idPrev:function(){return"ToolBar"},_extendMethods:function(){return A.ligerMethos.ToolBar},_render:function(){var B=this,C=this.options;B.toolBar=A(this.element);B.toolBar.addClass("l-toolbar");B.set(C)},_setItems:function(C){var B=this;A(C).each(function(D,E){B.addItem(E)})},addItem:function(D){var B=this,C=this.options;if(D.line){B.toolBar.append('<div class="l-bar-separator"></div>');return}var E=E=A('<div title="'+D.text+'" class="l-toolbar-item l-panel-btn"><span></span><div class="l-panel-btn-l"></div><div class="l-panel-btn-r"></div></div>');if(D.icon=="locate"){B.toolBar.append(A('<input id="'+D.id+'" style="float:left;margin-left:2px;width:110px;"/>'));inputEnterSearch(D.id,D.click)}B.toolBar.append(E);D.id&&E.attr("toolbarid",D.id);if(D.img){E.append("<img src='"+D.img+"' />");E.addClass("l-toolbar-item-hasicon")}else{if(D.icon){E.append("<div class='l-icon l-icon-"+D.icon+"'></div>");E.addClass("l-toolbar-item-hasicon")}}D.disable&&E.addClass("l-toolbar-item-disable");D.click&&E.click(function(){if(D.disable){return}D.click(D)});E.hover(function(){A(this).addClass("l-panel-btn-over")},function(){A(this).removeClass("l-panel-btn-over")})}})})(jQuery);(function(A){A.fn.ligerTree=function(B){return A.ligerui.run.call(this,"ligerTree",arguments)};A.fn.ligerGetTreeManager=function(){return A.ligerui.run.call(this,"ligerGetTreeManager",arguments)};A.ligerDefaults.Tree={url:null,data:null,checkbox:true,autoCheckboxEven:true,parentIcon:"folder",childIcon:"leaf",textFieldName:"text",attribute:["id","url"],treeLine:true,nodeWidth:90,statusName:"__status",isLeaf:null,single:false,onBeforeExpand:function(){},onContextmenu:function(){},onExpand:function(){},onBeforeCollapse:function(){},onCollapse:function(){},onBeforeSelect:function(){},onSelect:function(){},onBeforeCancelSelect:function(){},onCancelselect:function(){},onCheck:function(){},onSuccess:function(){},onError:function(){},onClick:function(){},idFieldName:"id",parentIDFieldName:null,topParentIDValue:0,onBeforeAppend:function(){},onAppend:function(){},onAfterAppend:function(){},slide:true,iconFieldName:"icon",nodeDraggable:false,nodeDraggingRender:null,btnClickToToggleOnly:true};A.ligerui.controls.Tree=function(C,B){A.ligerui.controls.Tree.base.constructor.call(this,C,B)};A.ligerui.controls.Tree.ligerExtend(A.ligerui.core.UIComponent,{_init:function(){A.ligerui.controls.Tree.base._init.call(this);var B=this,C=this.options;if(C.single){C.autoCheckboxEven=false}},_render:function(){var B=this,C=this.options;B.set(C,true);B.tree=A(B.element);B.tree.addClass("l-tree");B.sysAttribute=["isexpand","ischecked","href","style"];B.loading=A("<div class='l-tree-loading'></div>");B.tree.after(B.loading);B.data=[];B.maxOutlineLevel=1;B.treedataindex=0;B._applyTree();B._setTreeEven();B.set(C,false)},_setTreeLine:function(B){if(B){this.tree.removeClass("l-tree-noline")}else{this.tree.addClass("l-tree-noline")}},_setUrl:function(B){if(B){this.loadData(null,B)}},_setData:function(B){if(B){this.append(null,B)}},setData:function(B){this.set("data",B)},getData:function(){return this.data},hasChildren:function(B){if(this.options.isLeaf){return !this.options.isLeaf(B)}return B.children?true:false},getParent:function(C,D){var B=this;C=B.getNodeDom(C);var E=B.getParentTreeItem(C,D);if(!E){return null}var F=A(E).attr("treedataindex");return B._getDataNodeByTreeDataIndex(F)},getParentTreeItem:function(C,E){var B=this;C=B.getNodeDom(C);var H=A(C);if(H.parent().hasClass("l-tree")){return null}if(E==undefined){if(H.parent().parent("li").length==0){return null}return H.parent().parent("li")[0]}var G=parseInt(H.attr("outlinelevel"));var D=H;for(var F=G-1;F>=E;F--){D=D.parent().parent("li")}return D[0]},getChecked:function(){var B=this,C=this.options;if(!this.options.checkbox){return null}var D=[];A(".l-checkbox-checked",B.tree).parent().parent("li").each(function(){var E=parseInt(A(this).attr("treedataindex"));D.push({target:this,data:B._getDataNodeByTreeDataIndex(B.data,E)})});return D},getSelected:function(){var B=this,C=this.options;var D={};D.target=A(".l-selected",B.tree).parent("li")[0];if(D.target){var E=parseInt(A(D.target).attr("treedataindex"));D.data=B._getDataNodeByTreeDataIndex(B.data,E);return D}return null},upgrade:function(C){var B=this,D=this.options;A(".l-note",C).each(function(){A(this).removeClass("l-note").addClass("l-expandable-open")});A(".l-note-last",C).each(function(){A(this).removeClass("l-note-last").addClass("l-expandable-open")});A("."+B._getChildNodeClassName(),C).each(function(){A(this).removeClass(B._getChildNodeClassName()).addClass(B._getParentNodeClassName(true))})},demotion:function(C){var B=this,D=this.options;if(!C&&C[0].tagName.toLowerCase()!="li"){return}var E=A(C).hasClass("l-last");A(".l-expandable-open",C).each(function(){A(this).removeClass("l-expandable-open").addClass(E?"l-note-last":"l-note")});A(".l-expandable-close",C).each(function(){A(this).removeClass("l-expandable-close").addClass(E?"l-note-last":"l-note")});A("."+B._getParentNodeClassName(true),C).each(function(){A(this).removeClass(B._getParentNodeClassName(true)).addClass(B._getChildNodeClassName())})},collapseAll:function(){var B=this,C=this.options;A(".l-expandable-open",B.tree).click()},expandAll:function(){var B=this,C=this.options;A(".l-expandable-close",B.tree).click()},loadData:function(E,C,F){var B=this,D=this.options;B.loading.show();var G=F?"post":"get";F=F||[];A.ajax({type:G,url:C,data:F,dataType:"json",success:function(H){if(!H){return}B.loading.hide();B.append(E,H);B.trigger("success",[H])},error:function(J,H,K){try{B.loading.hide();B.trigger("error",[J,H,K])}catch(I){}}})},clear:function(){var B=this,C=this.options;A("> li",B.tree).each(function(){B.remove(this)})},getNodeDom:function(B){var C=this,D=this.options;if(B==null){return B}if(typeof(B)=="string"||typeof(B)=="number"){return A("li[treedataindex="+B+"]",C.tree).get(0)}else{if(typeof(B)=="object"&&"treedataindex" in B){return C.getNodeDom(B["treedataindex"])}}return B},remove:function(D){var B=this,E=this.options;D=B.getNodeDom(D);var F=parseInt(A(D).attr("treedataindex"));var G=B._getDataNodeByTreeDataIndex(B.data,F);if(G){B._setTreeDataStatus([G],"delete")}var C=B.getParentTreeItem(D);if(E.checkbox){B._setParentCheckboxStatus(A(D))}A(D).remove();B._updateStyle(C?A("ul:first",C):B.tree)},_updateStyle:function(E){var B=this,C=this.options;var D=A(" > li",E);var F=D.length;if(!F){return}D.each(function(G,H){if(G==0&&!A(this).hasClass("l-first")){A(this).addClass("l-first")}if(G==F-1&&!A(this).hasClass("l-last")){A(this).addClass("l-last")}if(G==0&&G==F-1){A(this).addClass("l-onlychild")}A("> div .l-note,> div .l-note-last",this).removeClass("l-note l-note-last").addClass(G==F-1?"l-note-last":"l-note");B._setTreeItem(this,{isLast:G==F-1})})},update:function(F,C){var B=this,D=this.options;F=B.getNodeDom(F);var E=parseInt(A(F).attr("treedataindex"));nodedata=B._getDataNodeByTreeDataIndex(B.data,E);for(var G in C){nodedata[G]=C[G];if(G==D.textFieldName){A("> .l-body > span",F).text(C[G])}}},append:function(G,N,D,M){var F=this,B=this.options;G=F.getNodeDom(G);if(F.trigger("beforeAppend",[G,N])==false){return false}if(!N||!N.length){return false}if(B.idFieldName&&B.parentIDFieldName){N=F.arrayToTree(N,B.idFieldName,B.parentIDFieldName)}F._addTreeDataIndexToData(N);F._setTreeDataStatus(N,"add");if(D!=null){D=F.getNodeDom(D)}F.trigger("append",[G,N]);F._appendData(G,N);if(G==null){var I=F._getTreeHTMLByData(N,1,[],true);I[I.length-1]=I[0]="";if(D!=null){A(D)[M?"after":"before"](I.join(""));F._updateStyle(G?A("ul:first",G):F.tree)}else{if(A("> li:last",F.tree).length>0){F._setTreeItem(A("> li:last",F.tree)[0],{isLast:false})}F.tree.append(I.join(""))}A(".l-body",F.tree).hover(function(){A(this).addClass("l-over")},function(){A(this).removeClass("l-over")});F._upadteTreeWidth();F.trigger("afterAppend",[G,N]);return}var J=A(G);var K=parseInt(J.attr("outlinelevel"));var E=A("> ul",J).length>0;if(!E){J.append("<ul class='l-children'></ul>");F.upgrade(G)}var H=[];for(var L=1;L<=K-1;L++){var C=A(F.getParentTreeItem(G,L));H.push(C.hasClass("l-last"))}H.push(J.hasClass("l-last"));var I=F._getTreeHTMLByData(N,K+1,H,true);I[I.length-1]=I[0]="";if(D!=null){A(D)[M?"after":"before"](I.join(""));F._updateStyle(G?A("ul:first",G):F.tree)}else{if(A("> .l-children > li:last",J).length>0){F._setTreeItem(A("> .l-children > li:last",J)[0],{isLast:false})}A(">.l-children",G).append(I.join(""))}F._upadteTreeWidth();A(">.l-children .l-body",G).hover(function(){A(this).addClass("l-over")},function(){A(this).removeClass("l-over")});F.trigger("afterAppend",[G,N])},cancelSelect:function(G){var I=this,C=this.options;var D=I.getNodeDom(G);var F=A(D);var H=parseInt(F.attr("treedataindex"));var E=I._getDataNodeByTreeDataIndex(I.data,H);var B=A(">div:first",F);if(C.checkbox){A(".l-checkbox",B).removeClass("l-checkbox-checked").addClass("l-checkbox-unchecked")}else{B.removeClass("l-selected")}I.trigger("cancelSelect",[{data:E,target:F[0]}])},selectNode:function(D){var I=this,C=this.options;var G=null;if(typeof(D)=="function"){G=D}else{if(typeof(D)=="object"){var F=A(D);var H=parseInt(F.attr("treedataindex"));var E=I._getDataNodeByTreeDataIndex(I.data,H);var B=A(">div:first",F);if(C.checkbox){A(".l-checkbox",B).removeClass("l-checkbox-unchecked").addClass("l-checkbox-checked")}else{B.addClass("l-selected")}I.trigger("select",[{data:E,target:F[0]}]);return}else{G=function(J){if(!J[C.idFieldName]){return false}return J[C.idFieldName].toString()==D.toString()}}}A("li",I.tree).each(function(){var L=A(this);var K=parseInt(L.attr("treedataindex"));var J=I._getDataNodeByTreeDataIndex(I.data,K);if(G(J,K)){I.selectNode(this)}else{I.cancelSelect(this)}})},getTextByID:function(E){var B=this,C=this.options;var D=B.getDataByID(E);if(!D){return null}return D[C.textFieldName]},getDataByID:function(E){var B=this,C=this.options;var D=null;A("li",B.tree).each(function(){if(D){return}var H=A(this);var G=parseInt(H.attr("treedataindex"));var F=B._getDataNodeByTreeDataIndex(B.data,G);if(F[C.idFieldName].toString()==E.toString()){D=F}});return D},arrayToTree:function(D,I,J){if(!D||!D.length){return[]}var K=[];var E={};var B=D.length;for(var F=0;F<B;F++){var G=D[F];E[G[I]]=G}for(var F=0;F<B;F++){var H=D[F];var C=E[H[J]];if(!C){K.push(H);continue}C.children=C.children||[];C.children.push(H)}return K},_getDataNodeByTreeDataIndex:function(G,F){var B=this,E=this.options;for(var C=0;C<G.length;C++){if(G[C].treedataindex==F){return G[C]}if(G[C].children){var D=B._getDataNodeByTreeDataIndex(G[C].children,F);if(D){return D}}}return null},_setTreeDataStatus:function(E,D){var B=this,C=this.options;A(E).each(function(){this[C.statusName]=D;if(this.children){B._setTreeDataStatus(this.children,D)}})},_addTreeDataIndexToData:function(D){var B=this,C=this.options;A(D).each(function(){if(this.treedataindex!=undefined){return}this.treedataindex=B.treedataindex++;if(this.children){B._addTreeDataIndexToData(this.children)}})},_addToNodes:function(D){var B=this,C=this.options;B.nodes=B.nodes||[];if(A.inArray(D,B.nodes)==-1){B.nodes.push(D)}if(D.children){A(D.children).each(function(E,F){B._addToNodes(F)})}},_appendData:function(D,G){var B=this,E=this.options;var F=parseInt(A(D).attr("treedataindex"));var C=B._getDataNodeByTreeDataIndex(B.data,F);if(B.treedataindex==undefined){B.treedataindex=0}if(C&&C.children==undefined){C.children=[]}A(G).each(function(H,I){if(C){C.children[C.children.length]=I}else{B.data[B.data.length]=I}B._addToNodes(I)})},_setTreeItem:function(E,G){var B=this,F=this.options;if(!G){return}E=B.getNodeDom(E);var C=A(E);var D=parseInt(C.attr("outlinelevel"));if(G.isLast!=undefined){if(G.isLast==true){C.removeClass("l-last").addClass("l-last");A("> div .l-note",C).removeClass("l-note").addClass("l-note-last");A(".l-children li",C).find(".l-box:eq("+(D-1)+")").removeClass("l-line")}else{if(G.isLast==false){C.removeClass("l-last");A("> div .l-note-last",C).removeClass("l-note-last").addClass("l-note");A(".l-children li",C).find(".l-box:eq("+(D-1)+")").removeClass("l-line").addClass("l-line")}}}},_upadteTreeWidth:function(){var B=this,C=this.options;var D=B.maxOutlineLevel*22;if(C.checkbox){D+=22}if(C.parentIcon||C.childIcon){D+=22}D+=C.nodeWidth;B.tree.width(D)},_getChildNodeClassName:function(){var B=this,C=this.options;return"l-tree-icon-"+C.childIcon},_getParentNodeClassName:function(C){var B=this,D=this.options;var E="l-tree-icon-"+D.parentIcon;if(C){E+="-open"}return E},_getTreeHTMLByData:function(E,M,I,O){var F=this,B=this.options;if(F.maxOutlineLevel<M){F.maxOutlineLevel=M}I=I||[];M=M||1;var J=[];if(!O){J.push('<ul class="l-children" style="display:none">')}else{J.push("<ul class='l-children'>")}for(var L=0;L<E.length;L++){var C=L==0;var P=L==E.length-1;var D=false;var K=E[L];if(K.isexpand&&K.isexpand=="true"){D=true}J.push("<li ");if(K.treedataindex!=undefined){J.push('treedataindex="'+K.treedataindex+'" ')}if(D){J.push("isexpand="+K.isexpand+" ")}J.push("outlinelevel="+M+" ");for(var G=0;G<F.sysAttribute.length;G++){if(A(this).attr(F.sysAttribute[G])){E[dataindex][F.sysAttribute[G]]=A(this).attr(F.sysAttribute[G])}}for(var G=0;G<B.attribute.length;G++){if(K[B.attribute[G]]){J.push(B.attribute[G]+'="'+K[B.attribute[G]]+'" ')}}J.push('class="');C&&J.push("l-first ");P&&J.push("l-last ");C&&P&&J.push("l-onlychild ");J.push('"');J.push(">");J.push('<div class="l-body">');for(var H=0;H<=M-2;H++){if(I[H]){J.push('<div class="l-box"></div>')}else{J.push('<div class="l-box l-line"></div>')}}if(F.hasChildren(K)){if(D){J.push('<div class="l-box l-expandable-open"></div>')}else{J.push('<div class="l-box l-expandable-close"></div>')}if(B.checkbox){if(K.ischecked){J.push('<div class="l-box l-checkbox l-checkbox-checked"></div>')}else{J.push('<div class="l-box l-checkbox l-checkbox-unchecked"></div>')}}if(B.parentIcon){J.push('<div class="l-box l-tree-icon ');J.push(F._getParentNodeClassName(B.parentIcon?true:false)+" ");if(B.iconFieldName&&K[B.iconFieldName]){J.push("l-tree-icon-none")}J.push('">');if(B.iconFieldName&&K[B.iconFieldName]){J.push('<img src="'+K[B.iconFieldName]+'" />')}J.push("</div>")}}else{if(P){J.push('<div class="l-box l-note-last"></div>')}else{J.push('<div class="l-box l-note"></div>')}if(B.checkbox){if(K.ischecked){J.push('<div class="l-box l-checkbox l-checkbox-checked"></div>')}else{J.push('<div class="l-box l-checkbox l-checkbox-unchecked"></div>')}}if(B.childIcon){J.push('<div class="l-box l-tree-icon ');J.push(F._getChildNodeClassName()+" ");if(B.iconFieldName&&K[B.iconFieldName]){J.push("l-tree-icon-none")}J.push('">');if(B.iconFieldName&&K[B.iconFieldName]){J.push('<img src="'+K[B.iconFieldName]+'" />')}J.push("</div>")}}J.push("<span>"+K[B.textFieldName]+"</span></div>");if(F.hasChildren(K)){var N=[];for(var H=0;H<I.length;H++){N.push(I[H])}N.push(P);J.push(F._getTreeHTMLByData(K.children,M+1,N,D).join(""))}J.push("</li>")}J.push("</ul>");return J},_getDataByTreeHTML:function(D){var B=this,C=this.options;var E=[];A("> li",D).each(function(F,G){var I=E.length;E[I]={treedataindex:B.treedataindex++};E[I][C.textFieldName]=A("> span,> a",this).html();for(var H=0;H<B.sysAttribute.length;H++){if(A(this).attr(B.sysAttribute[H])){E[I][B.sysAttribute[H]]=A(this).attr(B.sysAttribute[H])}}for(var H=0;H<C.attribute.length;H++){if(A(this).attr(C.attribute[H])){E[I][C.attribute[H]]=A(this).attr(C.attribute[H])}}if(A("> ul",this).length>0){E[I].children=B._getDataByTreeHTML(A("> ul",this))}});return E},_applyTree:function(){var B=this,C=this.options;B.data=B._getDataByTreeHTML(B.tree);var D=B._getTreeHTMLByData(B.data,1,[],true);D[D.length-1]=D[0]="";B.tree.html(D.join(""));B._upadteTreeWidth();A(".l-body",B.tree).hover(function(){A(this).addClass("l-over")},function(){A(this).removeClass("l-over")})},_applyTreeEven:function(C){var B=this,D=this.options;A("> .l-body",C).hover(function(){A(this).addClass("l-over")},function(){A(this).removeClass("l-over")})},_getSrcElementByEvent:function(B){var I=this;var G=(B.target||B.srcElement);var D=G.tagName.toLowerCase();var F=A(G).parents().add(G);var E=function(K){for(var J=F.length-1;J>=0;J--){if(A(F[J]).hasClass(K)){return F[J]}}return null};if(F.index(this.element)==-1){return{out:true}}var C={tree:E("l-tree"),node:E("l-body"),checkbox:E("l-checkbox"),icon:E("l-tree-icon"),text:D=="span"};if(C.node){var H=parseInt(A(C.node).parent().attr("treedataindex"));C.data=I._getDataNodeByTreeDataIndex(I.data,H)}return C},_setTreeEven:function(){var B=this,C=this.options;if(B.hasBind("contextmenu")){B.tree.bind("contextmenu",function(D){var E=(D.target||D.srcElement);var H=null;if(E.tagName.toLowerCase()=="a"||E.tagName.toLowerCase()=="span"||A(E).hasClass("l-box")){H=A(E).parent().parent()}else{if(A(E).hasClass("l-body")){H=A(E).parent()}else{if(E.tagName.toLowerCase()=="li"){H=A(E)}}}if(!H){return}var G=parseInt(H.attr("treedataindex"));var F=B._getDataNodeByTreeDataIndex(B.data,G);return B.trigger("contextmenu",[{data:F,target:H[0]},D])})}B.tree.click(function(D){var H=(D.target||D.srcElement);var G=null;if(H.tagName.toLowerCase()=="a"||H.tagName.toLowerCase()=="span"||A(H).hasClass("l-box")){G=A(H).parent().parent()}else{if(A(H).hasClass("l-body")){G=A(H).parent()}else{G=A(H)}}if(!G){return}var K=parseInt(G.attr("treedataindex"));var F=B._getDataNodeByTreeDataIndex(B.data,K);var I=A("div.l-body:first",G).find("div.l-expandable-open:first,div.l-expandable-close:first");var J=A(H).hasClass("l-expandable-open")||A(H).hasClass("l-expandable-close");if(!A(H).hasClass("l-checkbox")&&!J){if(A(">div:first",G).hasClass("l-selected")){if(B.trigger("beforeCancelSelect",[{data:F,target:G[0]}])==false){return false}A(">div:first",G).removeClass("l-selected");B.trigger("cancelSelect",[{data:F,target:G[0]}])}else{if(B.trigger("beforeSelect",[{data:F,target:G[0]}])==false){return false}A(".l-body",B.tree).removeClass("l-selected");A(">div:first",G).addClass("l-selected");B.trigger("select",[{data:F,target:G[0]}])}}if(A(H).hasClass("l-checkbox")){if(C.autoCheckboxEven){if(A(H).hasClass("l-checkbox-unchecked")){A(H).removeClass("l-checkbox-unchecked").addClass("l-checkbox-checked");A(".l-children .l-checkbox",G).removeClass("l-checkbox-incomplete l-checkbox-unchecked").addClass("l-checkbox-checked");B.trigger("check",[{data:F,target:G[0]},true])}else{if(A(H).hasClass("l-checkbox-checked")){A(H).removeClass("l-checkbox-checked").addClass("l-checkbox-unchecked");A(".l-children .l-checkbox",G).removeClass("l-checkbox-incomplete l-checkbox-checked").addClass("l-checkbox-unchecked");B.trigger("check",[{data:F,target:G[0]},false])}else{if(A(H).hasClass("l-checkbox-incomplete")){A(H).removeClass("l-checkbox-incomplete").addClass("l-checkbox-checked");A(".l-children .l-checkbox",G).removeClass("l-checkbox-incomplete l-checkbox-unchecked").addClass("l-checkbox-checked");B.trigger("check",[{data:F,target:G[0]},true])}}}B._setParentCheckboxStatus(G)}else{if(A(H).hasClass("l-checkbox-unchecked")){A(H).removeClass("l-checkbox-unchecked").addClass("l-checkbox-checked");if(C.single){A(".l-checkbox",B.tree).not(H).removeClass("l-checkbox-checked").addClass("l-checkbox-unchecked")}B.trigger("check",[{data:F,target:G[0]},true])}else{if(A(H).hasClass("l-checkbox-checked")){A(H).removeClass("l-checkbox-checked").addClass("l-checkbox-unchecked");B.trigger("check",[{data:F,target:G[0]},false])}}}}else{if(I.hasClass("l-expandable-open")&&(!C.btnClickToToggleOnly||J)){if(B.trigger("beforeCollapse",[{data:F,target:G[0]}])==false){return false}I.removeClass("l-expandable-open").addClass("l-expandable-close");if(C.slide){A("> .l-children",G).slideToggle("fast")}else{A("> .l-children",G).toggle()}A("> div ."+B._getParentNodeClassName(true),G).removeClass(B._getParentNodeClassName(true)).addClass(B._getParentNodeClassName());B.trigger("collapse",[{data:F,target:G[0]}])}else{if(I.hasClass("l-expandable-close")&&(!C.btnClickToToggleOnly||J)){if(B.trigger("beforeExpand",[{data:F,target:G[0]}])==false){return false}I.removeClass("l-expandable-close").addClass("l-expandable-open");var E=function(){B.trigger("expand",[{data:F,target:G[0]}])};if(C.slide){A("> .l-children",G).slideToggle("fast",E)}else{A("> .l-children",G).toggle();E()}A("> div ."+B._getParentNodeClassName(),G).removeClass(B._getParentNodeClassName()).addClass(B._getParentNodeClassName(true))}}}B.trigger("click",[{data:F,target:G[0]}])});if(A.fn.ligerDrag&&C.nodeDraggable){B.nodeDroptip=A("<div class='l-drag-nodedroptip' style='display:none'></div>").appendTo("body");B.tree.ligerDrag({revert:true,animate:false,proxyX:20,proxyY:20,proxy:function(G,D){var E=B._getSrcElementByEvent(D);if(E.node){var I="dragging";if(C.nodeDraggingRender){I=C.nodeDraggingRender(G.draggingNodes,G,B)}else{I="";var K=false;for(var H in G.draggingNodes){var J=G.draggingNodes[H];if(K){I+=","}I+=J.text;K=true}}var F=A("<div class='l-drag-proxy' style='display:none'><div class='l-drop-icon l-drop-no'></div>"+I+"</div>").appendTo("body");return F}},onRevert:function(){return false},onRendered:function(){this.set("cursor","default");B.children[this.id]=this},onStartDrag:function(F,E){if(E.button==2){return false}this.set("cursor","default");var H=B._getSrcElementByEvent(E);if(H.checkbox){return false}if(C.checkbox){var G=B.getChecked();this.draggingNodes=[];for(var D in G){this.draggingNodes.push(G[D].data)}if(!this.draggingNodes||!this.draggingNodes.length){return false}}else{this.draggingNodes=[H.data]}this.draggingNode=H.data;this.set("cursor","move");B.nodedragging=true;this.validRange={top:B.tree.offset().top,bottom:B.tree.offset().top+B.tree.height(),left:B.tree.offset().left,right:B.tree.offset().left+B.tree.width()}},onDrag:function(K,F){var R=this.draggingNode;if(!R){return false}var H=this.draggingNodes?this.draggingNodes:[R];if(B.nodeDropIn==null){B.nodeDropIn=-1}var Q=F.pageX;var S=F.pageY;var G=false;var T=this.validRange;if(Q<T.left||Q>T.right||S>T.bottom||S<T.top){B.nodeDropIn=-1;B.nodeDroptip.hide();this.proxy.find(".l-drop-icon:first").removeClass("l-drop-yes l-drop-add").addClass("l-drop-no");return}for(var I=0,J=B.nodes.length;I<J;I++){var P=B.nodes[I];var D=P["treedataindex"];if(R["treedataindex"]==D){G=true}if(A.inArray(P,H)!=-1){continue}var O=G?true:false;if(B.nodeDropIn!=-1&&B.nodeDropIn!=D){continue}var L=A("li[treedataindex="+D+"] div:first",B.tree);var M=L.offset();var E={top:M.top,bottom:M.top+L.height(),left:B.tree.offset().left,right:B.tree.offset().left+B.tree.width()};if(Q>E.left&&Q<E.right&&S>E.top&&S<E.bottom){var N=M.top;if(O){N+=L.height()}B.nodeDroptip.css({left:E.left,top:N,width:E.right-E.left}).show();B.nodeDropIn=D;B.nodeDropDir=O?"bottom":"top";if(S>E.top+7&&S<E.bottom-7){this.proxy.find(".l-drop-icon:first").removeClass("l-drop-no l-drop-yes").addClass("l-drop-add");B.nodeDroptip.hide();B.nodeDropInParent=true}else{this.proxy.find(".l-drop-icon:first").removeClass("l-drop-no l-drop-add").addClass("l-drop-yes");B.nodeDroptip.show();B.nodeDropInParent=false}break}else{if(B.nodeDropIn!=-1){B.nodeDropIn=-1;B.nodeDropInParent=false;B.nodeDroptip.hide();this.proxy.find(".l-drop-icon:first").removeClass("l-drop-yes  l-drop-add").addClass("l-drop-no")}}}},onStopDrag:function(H,E){var F=this.draggingNodes;B.nodedragging=false;if(B.nodeDropIn!=-1){for(var D=0;D<F.length;D++){var I=F[D].children;if(I){F=A.grep(F,function(L,J){var K=A.inArray(L,I)==-1;return K})}}for(var D in F){var G=F[D];if(B.nodeDropInParent){B.remove(G);B.append(B.nodeDropIn,[G])}else{B.remove(G);B.append(B.getParent(B.nodeDropIn),[G],B.nodeDropIn,B.nodeDropDir=="bottom")}}B.nodeDropIn=-1}B.nodeDroptip.hide();this.set("cursor","default")}})}},_setParentCheckboxStatus:function(F){var B=this,D=this.options;var E=A(".l-checkbox-unchecked",F.parent()).length==0;var C=A(".l-checkbox-checked",F.parent()).length==0;if(E){F.parent().prev().find(".l-checkbox").removeClass("l-checkbox-unchecked l-checkbox-incomplete").addClass("l-checkbox-checked")}else{if(C){F.parent().prev().find("> .l-checkbox").removeClass("l-checkbox-checked l-checkbox-incomplete").addClass("l-checkbox-unchecked")}else{F.parent().prev().find("> .l-checkbox").removeClass("l-checkbox-unchecked l-checkbox-checked").addClass("l-checkbox-incomplete")}}if(F.parent().parent("li").length>0){B._setParentCheckboxStatus(F.parent().parent("li"))}}})})(jQuery);(function(B){var A=B.ligerui;A.windowCount=0;B.ligerWindow=function(C){return A.run.call(null,"ligerWindow",arguments,{isStatic:true})};B.ligerWindow.show=function(C){return B.ligerWindow(C)};B.ligerDefaults.Window={showClose:true,showMax:true,showToggle:true,showMin:true,title:"window",load:false,onLoaded:null,modal:false};B.ligerMethos.Window={};A.controls.Window=function(C){A.controls.Window.base.constructor.call(this,null,C)};A.controls.Window.ligerExtend(A.core.Win,{__getType:function(){return"Window"},__idPrev:function(){return"Window"},_extendMethods:function(){return B.ligerMethos.Window},_render:function(){var C=this,F=this.options;C.window=B('<div class="l-window"><div class="l-window-header"><div class="l-window-header-buttons"><div class="l-window-toggle"></div><div class="l-window-max"></div><div class="l-window-close"></div><div class="l-clear"></div></div><div class="l-window-header-inner"></div></div><div class="l-window-content"></div></div>');C.element=C.window[0];C.window.content=B(".l-window-content",C.window);C.window.header=B(".l-window-header",C.window);C.window.buttons=B(".l-window-header-buttons:first",C.window);if(F.url){if(F.load){C.window.content.load(F.url,function(){C.trigger("loaded")});C.window.content.addClass("l-window-content-scroll")}else{var D=B("<iframe frameborder='0' src='"+F.url+"'></iframe>");var H="ligeruiwindow"+A.windowCount++;if(F.name){H=F.name}D.attr("name",H).attr("id",H);F.framename=H;D.appendTo(C.window.content);C.iframe=D}}else{if(F.content){var I=B("<div>"+F.content+"</div>");I.appendTo(C.window.content)}else{if(F.target){C.window.content.append(F.target);F.target.show()}}}this.mask();C.active();B("body").append(C.window);C.set({width:F.width,height:F.height});var E=0;var G=0;if(F.left!=null){E=F.left}else{F.left=E=0.5*(B(window).width()-C.window.width())}if(F.top!=null){G=F.top}else{F.top=G=0.5*(B(window).height()-C.window.height())+B(window).scrollTop()-10}if(E<0){F.left=E=0}if(G<0){F.top=G=0}C.set(F);F.framename&&B(">iframe",C.window.content).attr("name",F.framename);if(!F.showToggle){B(".l-window-toggle",C.window).remove()}if(!F.showMax){B(".l-window-max",C.window).remove()}if(!F.showClose){B(".l-window-close",C.window).remove()}C._saveStatus();if(B.fn.ligerDrag){C.draggable=C.window.drag=C.window.ligerDrag({handler:".l-window-header-inner",onStartDrag:function(){C.active()},onStopDrag:function(){C._saveStatus()},animate:false})}if(B.fn.ligerResizable){C.resizeable=C.window.resizable=C.window.ligerResizable({onStartResize:function(){C.active();B(".l-window-max",C.window).removeClass("l-window-regain")},onStopResize:function(M,J){var L=0;var K=0;if(!isNaN(parseInt(C.window.css("top")))){L=parseInt(C.window.css("top"))}if(!isNaN(parseInt(C.window.css("left")))){K=parseInt(C.window.css("left"))}if(M.diffTop){C.window.css({top:L+M.diffTop})}if(M.diffLeft){C.window.css({left:K+M.diffLeft})}if(M.newWidth){C.window.width(M.newWidth)}if(M.newHeight){C.window.content.height(M.newHeight-28)}C._saveStatus();return false}});C.window.append("<div class='l-btn-nw-drop'></div>")}B(".l-window-toggle",C.window).click(function(){if(B(this).hasClass("l-window-toggle-close")){C.collapsed=false;B(this).removeClass("l-window-toggle-close")}else{C.collapsed=true;B(this).addClass("l-window-toggle-close")}C.window.content.slideToggle()}).hover(function(){if(C.window.drag){C.window.drag.set("disabled",true)}},function(){if(C.window.drag){C.window.drag.set("disabled",false)}});B(".l-window-close",C.window).click(function(){if(C.trigger("close")==false){return false}C.window.hide();A.win.removeTask(C)}).hover(function(){if(C.window.drag){C.window.drag.set("disabled",true)}},function(){if(C.window.drag){C.window.drag.set("disabled",false)}});B(".l-window-max",C.window).click(function(){if(B(this).hasClass("l-window-regain")){if(C.trigger("regain")==false){return false}C.window.width(C._width).css({left:C._left,top:C._top});C.window.content.height(C._height-28);B(this).removeClass("l-window-regain")}else{if(C.trigger("max")==false){return false}C.window.width(B(window).width()-2).css({left:0,top:0});C.window.content.height(B(window).height()-28).show();B(this).addClass("l-window-regain")}})},_saveStatus:function(){var C=this;C._width=C.window.width();C._height=C.window.height();var E=0;var D=0;if(!isNaN(parseInt(C.window.css("top")))){E=parseInt(C.window.css("top"))}if(!isNaN(parseInt(C.window.css("left")))){D=parseInt(C.window.css("left"))}C._top=E;C._left=D},min:function(){this.window.hide();this.minimize=true;this.actived=false},_setShowMin:function(E){var C=this,D=this.options;if(E){if(!C.winmin){C.winmin=B('<div class="l-window-min"></div>').prependTo(C.window.buttons).click(function(){C.min()});A.win.addTask(C)}}else{if(C.winmin){C.winmin.remove();C.winmin=null}}},_setLeft:function(C){if(C!=null){this.window.css({left:C})}},_setTop:function(C){if(C!=null){this.window.css({top:C})}},_setWidth:function(C){if(C>0){this.window.width(C)}},_setHeight:function(C){if(C>28){this.window.content.height(C-28)}},_setTitle:function(C){if(C){B(".l-window-header-inner",this.window.header).html(C)}},_setUrl:function(D){var C=this,E=this.options;E.url=D;if(E.load){C.window.content.html("").load(E.url,function(){if(C.trigger("loaded")==false){return false}})}else{if(C.jiframe){C.jiframe.attr("src",E.url)}}},hide:function(){var C=this,D=this.options;this.unmask();this.window.hide()},show:function(){var C=this,D=this.options;this.mask();this.window.show()},remove:function(){var C=this,D=this.options;this.unmask();this.window.remove()},active:function(){var C=this,F=this.options;if(C.minimize){var H=C._width,D=C._height,E=C._left,G=C._top;if(C.maximum){H=B(window).width();D=B(window).height();E=G=0;if(A.win.taskbar){D-=A.win.taskbar.outerHeight();if(A.win.top){G+=A.win.taskbar.outerHeight()}}}C.set({width:H,height:D,left:E,top:G})}C.actived=true;C.minimize=false;A.win.setFront(C);C.show();A.win.setFront(this)},setUrl:function(C){return _setUrl(C)}})})(jQuery);